[{"authorTime":"2016-06-15 04:21:30","codes":[{"authorDate":"2016-03-16 23:24:18","commitOrder":4,"curCode":"    public void testSendRecordsRetries() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        \r\n        expectSendRecordOnce(false);\n        \r\n        expectSendRecordSyncFailure(new org.apache.kafka.common.errors.TimeoutException(\"retriable sync failure\"));\n\n        \r\n        expectSendRecordOnce(true);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        \r\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(true, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertEquals(Arrays.asList(record2, record3), Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        \r\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","date":"2016-03-16 23:24:18","endLine":310,"groupId":"1412","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testSendRecordsRetries","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/3d/d07a699fe9c271b105cda51cac5f96270a50ad.src","preCode":"    public void testSendRecordsRetries() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        \r\n        expectSendRecordOnce(false);\n        \r\n        expectSendRecordSyncFailure(new org.apache.kafka.common.errors.TimeoutException(\"retriable sync failure\"));\n\n        \r\n        expectSendRecordOnce(true);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        \r\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(true, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertEquals(Arrays.asList(record2, record3), Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        \r\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","realPath":"connect/runtime/src/test/java/org/apache/kafka/connect/runtime/WorkerSourceTaskTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":279,"status":"NB"},{"authorDate":"2016-06-15 04:21:30","commitOrder":4,"curCode":"    public void testSendRecordsTaskCommitRecordFail() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        \r\n        expectSendRecordOnce(false);\n        expectSendRecordTaskCommitRecordFail(false, false);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","date":"2016-06-15 04:21:30","endLine":431,"groupId":"22197","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testSendRecordsTaskCommitRecordFail","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/07/61245142337cdb39a905624e3c9d0b71474b09.src","preCode":"    public void testSendRecordsTaskCommitRecordFail() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        \r\n        expectSendRecordOnce(false);\n        expectSendRecordTaskCommitRecordFail(false, false);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","realPath":"connect/runtime/src/test/java/org/apache/kafka/connect/runtime/WorkerSourceTaskTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":410,"status":"B"}],"commitId":"9ff54cb5dd99fab83533ddfdf0ed89508e5525fb","commitMessage":"@@@MINOR: Catch Throwable in commitSourceTask()\n\nAuthor: Liquan Pei <liquanpei@gmail.com>\n\nReviewers: Jason Gustafson <jason@confluent.io>.  Ewen Cheslack-Postava <ewen@confluent.io>\n\nCloses #1402 from Ishiihara/source-task-commit-record\n","date":"2016-06-15 04:21:30","modifiedFileCount":"2","status":"M","submitter":"Liquan Pei"},{"authorTime":"2020-05-27 13:07:34","codes":[{"authorDate":"2020-05-27 13:07:34","commitOrder":5,"curCode":"    public void testSendRecordsRetries() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        expectTopicCreation(TOPIC);\n\n        \r\n        expectSendRecordOnce(false);\n        \r\n        expectSendRecordSyncFailure(new org.apache.kafka.common.errors.TimeoutException(\"retriable sync failure\"));\n\n        \r\n        expectSendRecordOnce(true);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        \r\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(true, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertEquals(Arrays.asList(record2, record3), Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        \r\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","date":"2020-05-27 13:07:34","endLine":620,"groupId":"104916","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testSendRecordsRetries","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/ff/61ea3dc7cffddb9205ee83b64deb1f420c3154.src","preCode":"    public void testSendRecordsRetries() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        \r\n        expectSendRecordOnce(false);\n        \r\n        expectSendRecordSyncFailure(new org.apache.kafka.common.errors.TimeoutException(\"retriable sync failure\"));\n\n        \r\n        expectSendRecordOnce(true);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        \r\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(true, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertEquals(Arrays.asList(record2, record3), Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        \r\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","realPath":"connect/runtime/src/test/java/org/apache/kafka/connect/runtime/WorkerSourceTaskTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":587,"status":"M"},{"authorDate":"2020-05-27 13:07:34","commitOrder":5,"curCode":"    public void testSendRecordsTaskCommitRecordFail() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        expectTopicCreation(TOPIC);\n\n        \r\n        expectSendRecordOnce(false);\n        expectSendRecordTaskCommitRecordFail(false, false);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","date":"2020-05-27 13:07:34","endLine":663,"groupId":"104916","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testSendRecordsTaskCommitRecordFail","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/ff/61ea3dc7cffddb9205ee83b64deb1f420c3154.src","preCode":"    public void testSendRecordsTaskCommitRecordFail() throws Exception {\n        createWorkerTask();\n\n        \r\n        SourceRecord record1 = new SourceRecord(PARTITION, OFFSET, \"topic\", 1, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record2 = new SourceRecord(PARTITION, OFFSET, \"topic\", 2, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n        SourceRecord record3 = new SourceRecord(PARTITION, OFFSET, \"topic\", 3, KEY_SCHEMA, KEY, RECORD_SCHEMA, RECORD);\n\n        \r\n        expectSendRecordOnce(false);\n        expectSendRecordTaskCommitRecordFail(false, false);\n        expectSendRecordOnce(false);\n\n        PowerMock.replayAll();\n\n        Whitebox.setInternalState(workerTask, \"toSend\", Arrays.asList(record1, record2, record3));\n        Whitebox.invokeMethod(workerTask, \"sendRecords\");\n        assertEquals(false, Whitebox.getInternalState(workerTask, \"lastSendFailed\"));\n        assertNull(Whitebox.getInternalState(workerTask, \"toSend\"));\n\n        PowerMock.verifyAll();\n    }\n","realPath":"connect/runtime/src/test/java/org/apache/kafka/connect/runtime/WorkerSourceTaskTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":640,"status":"M"}],"commitId":"371f14c3c12d2e341ac96bd52393b43a10acfa84","commitMessage":"@@@KAFKA-5295: Allow source connectors to specify topic-specific settings for new topics (KIP-158) (#8722)\n\nKafka Connect workers have been able to create Connect's internal topics using the new admin client for some time now (see KAFKA-4667 for details). However.  tasks of source connectors are still relying upon the broker to auto-create topics with default config settings if they don't exist.  or expect these topics to exist before the connector is deployed.  if their configuration needs to be specialized. \n\nWith the implementation of KIP-158 here.  if `topic.creation.enable=true`.  Kafka Connect will supply the source tasks of connectors that are configured to create topics with an admin client that will allow them to create new topics on-the-fly before writing the first source records to a new topic. Additionally.  each source connector has the opportunity to customize the topic-specific settings of these new topics by defining groups of topic configurations. \n\nThis feature is tested here via unit tests (old tests that have been adjusted and new ones) as well as integration tests.\n\nReviewers: Randall Hauch <rhauch@gmail.com>","date":"2020-05-27 13:07:34","modifiedFileCount":"23","status":"M","submitter":"Konstantine Karantasis"}]
