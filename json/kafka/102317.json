[{"authorTime":"2021-02-05 11:02:56","codes":[{"authorDate":"2020-04-22 00:25:45","commitOrder":9,"curCode":"    public void shouldThrowIfTopicIsUnknownOnSendWithPartitioner() {\n        final RecordCollector collector = new RecordCollectorImpl(\n            logContext,\n            taskId,\n            new StreamsProducer(\n                config,\n                \"threadId\",\n                new MockClientSupplier() {\n                    @Override\n                    public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                        return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                            @Override\n                            public List<PartitionInfo> partitionsFor(final String topic) {\n                                return Collections.emptyList();\n                            }\n                        };\n                    }\n                },\n                null,\n                null,\n                logContext\n            ),\n            productionExceptionHandler,\n            streamsMetrics\n        );\n        collector.initialize();\n\n        final StreamsException thrown = assertThrows(\n            StreamsException.class,\n            () -> collector.send(topic, \"3\", \"0\", null, null, stringSerializer, stringSerializer, streamPartitioner)\n        );\n        assertThat(\n            thrown.getMessage(),\n            equalTo(\"Could not get partition information for topic topic for task 0_0.\" +\n                \" This can happen if the topic does not exist.\")\n        );\n    }\n","date":"2020-04-22 00:25:45","endLine":753,"groupId":"19915","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"shouldThrowIfTopicIsUnknownOnSendWithPartitioner","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/31/2ba88a917eaac219a36519260395b781f4e8c0.src","preCode":"    public void shouldThrowIfTopicIsUnknownOnSendWithPartitioner() {\n        final RecordCollector collector = new RecordCollectorImpl(\n            logContext,\n            taskId,\n            new StreamsProducer(\n                config,\n                \"threadId\",\n                new MockClientSupplier() {\n                    @Override\n                    public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                        return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                            @Override\n                            public List<PartitionInfo> partitionsFor(final String topic) {\n                                return Collections.emptyList();\n                            }\n                        };\n                    }\n                },\n                null,\n                null,\n                logContext\n            ),\n            productionExceptionHandler,\n            streamsMetrics\n        );\n        collector.initialize();\n\n        final StreamsException thrown = assertThrows(\n            StreamsException.class,\n            () -> collector.send(topic, \"3\", \"0\", null, null, stringSerializer, stringSerializer, streamPartitioner)\n        );\n        assertThat(\n            thrown.getMessage(),\n            equalTo(\"Could not get partition information for topic topic for task 0_0.\" +\n                \" This can happen if the topic does not exist.\")\n        );\n    }\n","realPath":"streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":717,"status":"NB"},{"authorDate":"2021-02-05 11:02:56","commitOrder":9,"curCode":"    private StreamsProducer getExceptionalStreamProducerOnPartitionsFor(final RuntimeException exception) {\n        return new StreamsProducer(\n            config,\n            \"threadId\",\n            new MockClientSupplier() {\n                @Override\n                public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                    return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                        @Override\n                        public synchronized List<PartitionInfo> partitionsFor(final String topic) {\n                            throw exception;\n                        }\n                    };\n                }\n            },\n            null,\n            null,\n            logContext\n        );\n    }\n","date":"2021-02-05 11:02:56","endLine":918,"groupId":"19915","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"getExceptionalStreamProducerOnPartitionsFor","params":"(finalRuntimeExceptionexception)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/ee/803992550c072484a1f68b294f167d182137c3.src","preCode":"    private StreamsProducer getExceptionalStreamProducerOnPartitionsFor(final RuntimeException exception) {\n        return new StreamsProducer(\n            config,\n            \"threadId\",\n            new MockClientSupplier() {\n                @Override\n                public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                    return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                        @Override\n                        public synchronized List<PartitionInfo> partitionsFor(final String topic) {\n                            throw exception;\n                        }\n                    };\n                }\n            },\n            null,\n            null,\n            logContext\n        );\n    }\n","realPath":"streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":899,"status":"B"}],"commitId":"470e6f2b9ac45fc32bdeb77d0bf4c72d26c6f3fd","commitMessage":"@@@KAFKA-9274: Add timeout handling for `StreamPartitioner` (#9997)\n\n Part of KIP-572: When a custom `StreamPartitioner` is used.  we need to get the number of partitions of output topics from the producer. This `partitionFor(topic)` call may through a `TimeoutException` that we now handle gracefully.\n\nReviewers: John Roesler <john@confluent.io>.  A. Sophie Blee-Goldman <sophie@confluent.io>","date":"2021-02-05 11:02:56","modifiedFileCount":"8","status":"M","submitter":"Matthias J. Sax"},{"authorTime":"2021-04-29 04:22:15","codes":[{"authorDate":"2021-04-29 04:22:15","commitOrder":10,"curCode":"    public void shouldThrowIfTopicIsUnknownOnSendWithPartitioner() {\n        final RecordCollector collector = new RecordCollectorImpl(\n            logContext,\n            taskId,\n            new StreamsProducer(\n                config,\n                processId + \"-StreamThread-1\",\n                new MockClientSupplier() {\n                    @Override\n                    public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                        return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                            @Override\n                            public List<PartitionInfo> partitionsFor(final String topic) {\n                                return Collections.emptyList();\n                            }\n                        };\n                    }\n                },\n                null,\n                null,\n                logContext\n            ),\n            productionExceptionHandler,\n            streamsMetrics\n        );\n        collector.initialize();\n\n        final StreamsException thrown = assertThrows(\n            StreamsException.class,\n            () -> collector.send(topic, \"3\", \"0\", null, null, stringSerializer, stringSerializer, streamPartitioner)\n        );\n        assertThat(\n            thrown.getMessage(),\n            equalTo(\"Could not get partition information for topic topic for task 0_0.\" +\n                \" This can happen if the topic does not exist.\")\n        );\n    }\n","date":"2021-04-29 04:22:15","endLine":842,"groupId":"19915","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"shouldThrowIfTopicIsUnknownOnSendWithPartitioner","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/5a/83c6839d3d59075fd101c9444abd0dea01649c.src","preCode":"    public void shouldThrowIfTopicIsUnknownOnSendWithPartitioner() {\n        final RecordCollector collector = new RecordCollectorImpl(\n            logContext,\n            taskId,\n            new StreamsProducer(\n                config,\n                \"threadId\",\n                new MockClientSupplier() {\n                    @Override\n                    public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                        return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                            @Override\n                            public List<PartitionInfo> partitionsFor(final String topic) {\n                                return Collections.emptyList();\n                            }\n                        };\n                    }\n                },\n                null,\n                null,\n                logContext\n            ),\n            productionExceptionHandler,\n            streamsMetrics\n        );\n        collector.initialize();\n\n        final StreamsException thrown = assertThrows(\n            StreamsException.class,\n            () -> collector.send(topic, \"3\", \"0\", null, null, stringSerializer, stringSerializer, streamPartitioner)\n        );\n        assertThat(\n            thrown.getMessage(),\n            equalTo(\"Could not get partition information for topic topic for task 0_0.\" +\n                \" This can happen if the topic does not exist.\")\n        );\n    }\n","realPath":"streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":806,"status":"M"},{"authorDate":"2021-04-29 04:22:15","commitOrder":10,"curCode":"    private StreamsProducer getExceptionalStreamProducerOnPartitionsFor(final RuntimeException exception) {\n        return new StreamsProducer(\n            config,\n            processId + \"-StreamThread-1\",\n            new MockClientSupplier() {\n                @Override\n                public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                    return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                        @Override\n                        public synchronized List<PartitionInfo> partitionsFor(final String topic) {\n                            throw exception;\n                        }\n                    };\n                }\n            },\n            null,\n            null,\n            logContext\n        );\n    }\n","date":"2021-04-29 04:22:15","endLine":921,"groupId":"19915","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"getExceptionalStreamProducerOnPartitionsFor","params":"(finalRuntimeExceptionexception)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/5a/83c6839d3d59075fd101c9444abd0dea01649c.src","preCode":"    private StreamsProducer getExceptionalStreamProducerOnPartitionsFor(final RuntimeException exception) {\n        return new StreamsProducer(\n            config,\n            \"threadId\",\n            new MockClientSupplier() {\n                @Override\n                public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                    return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                        @Override\n                        public synchronized List<PartitionInfo> partitionsFor(final String topic) {\n                            throw exception;\n                        }\n                    };\n                }\n            },\n            null,\n            null,\n            logContext\n        );\n    }\n","realPath":"streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":902,"status":"M"}],"commitId":"3805f3706f8f3ebba81b80915c9259590525fb05","commitMessage":"@@@KAFKA-12574: KIP-732.  Deprecate eos-alpha and replace eos-beta with eos-v2 (#10573)\n\nDeprecates the following \n\n1. StreamsConfig.EXACTLY_ONCE\n2. StreamsConfig.EXACTLY_ONCE_BETA\n3. Producer#sendOffsetsToTransaction(Map offsets.  String consumerGroupId)\n\nAnd introduces a new StreamsConfig.EXACTLY_ONCE_V2 config. Additionally.  this PR replaces usages of the term \"eos-beta\" throughout the code with the term \"eos-v2\"\n\nReviewers: Matthias J. Sax <mjsax@confluent.io>","date":"2021-04-29 04:22:15","modifiedFileCount":"32","status":"M","submitter":"A. Sophie Blee-Goldman"},{"authorTime":"2021-08-31 06:39:25","codes":[{"authorDate":"2021-08-31 06:39:25","commitOrder":11,"curCode":"    public void shouldThrowIfTopicIsUnknownOnSendWithPartitioner() {\n        final RecordCollector collector = new RecordCollectorImpl(\n            logContext,\n            taskId,\n            new StreamsProducer(\n                config,\n                processId + \"-StreamThread-1\",\n                new MockClientSupplier() {\n                    @Override\n                    public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                        return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                            @Override\n                            public List<PartitionInfo> partitionsFor(final String topic) {\n                                return Collections.emptyList();\n                            }\n                        };\n                    }\n                },\n                null,\n                null,\n                logContext,\n                Time.SYSTEM\n            ),\n            productionExceptionHandler,\n            streamsMetrics\n        );\n        collector.initialize();\n\n        final StreamsException thrown = assertThrows(\n            StreamsException.class,\n            () -> collector.send(topic, \"3\", \"0\", null, null, stringSerializer, stringSerializer, streamPartitioner)\n        );\n        assertThat(\n            thrown.getMessage(),\n            equalTo(\"Could not get partition information for topic topic for task 0_0.\" +\n                \" This can happen if the topic does not exist.\")\n        );\n    }\n","date":"2021-08-31 06:39:25","endLine":846,"groupId":"102317","id":5,"instanceNumber":1,"isCurCommit":1,"methodName":"shouldThrowIfTopicIsUnknownOnSendWithPartitioner","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/48/364f27db583906a2fe2bdaa385ddbaffc54f3b.src","preCode":"    public void shouldThrowIfTopicIsUnknownOnSendWithPartitioner() {\n        final RecordCollector collector = new RecordCollectorImpl(\n            logContext,\n            taskId,\n            new StreamsProducer(\n                config,\n                processId + \"-StreamThread-1\",\n                new MockClientSupplier() {\n                    @Override\n                    public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                        return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                            @Override\n                            public List<PartitionInfo> partitionsFor(final String topic) {\n                                return Collections.emptyList();\n                            }\n                        };\n                    }\n                },\n                null,\n                null,\n                logContext\n            ),\n            productionExceptionHandler,\n            streamsMetrics\n        );\n        collector.initialize();\n\n        final StreamsException thrown = assertThrows(\n            StreamsException.class,\n            () -> collector.send(topic, \"3\", \"0\", null, null, stringSerializer, stringSerializer, streamPartitioner)\n        );\n        assertThat(\n            thrown.getMessage(),\n            equalTo(\"Could not get partition information for topic topic for task 0_0.\" +\n                \" This can happen if the topic does not exist.\")\n        );\n    }\n","realPath":"streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":809,"status":"M"},{"authorDate":"2021-08-31 06:39:25","commitOrder":11,"curCode":"    private StreamsProducer getExceptionalStreamProducerOnPartitionsFor(final RuntimeException exception) {\n        return new StreamsProducer(\n            config,\n            processId + \"-StreamThread-1\",\n            new MockClientSupplier() {\n                @Override\n                public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                    return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                        @Override\n                        public synchronized List<PartitionInfo> partitionsFor(final String topic) {\n                            throw exception;\n                        }\n                    };\n                }\n            },\n            null,\n            null,\n            logContext,\n            Time.SYSTEM\n        );\n    }\n","date":"2021-08-31 06:39:25","endLine":928,"groupId":"102317","id":6,"instanceNumber":2,"isCurCommit":1,"methodName":"getExceptionalStreamProducerOnPartitionsFor","params":"(finalRuntimeExceptionexception)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-kafka-10-0.7/blobInfo/CC_OUT/blobs/48/364f27db583906a2fe2bdaa385ddbaffc54f3b.src","preCode":"    private StreamsProducer getExceptionalStreamProducerOnPartitionsFor(final RuntimeException exception) {\n        return new StreamsProducer(\n            config,\n            processId + \"-StreamThread-1\",\n            new MockClientSupplier() {\n                @Override\n                public Producer<byte[], byte[]> getProducer(final Map<String, Object> config) {\n                    return new MockProducer<byte[], byte[]>(cluster, true, new DefaultPartitioner(), byteArraySerializer, byteArraySerializer) {\n                        @Override\n                        public synchronized List<PartitionInfo> partitionsFor(final String topic) {\n                            throw exception;\n                        }\n                    };\n                }\n            },\n            null,\n            null,\n            logContext\n        );\n    }\n","realPath":"streams/src/test/java/org/apache/kafka/streams/processor/internals/RecordCollectorTest.java","repoName":"kafka","snippetEndLine":0,"snippetStartLine":0,"startLine":908,"status":"M"}],"commitId":"01ab888dbd08ccd4b0de9333d21581ce24fe2c3b","commitMessage":"@@@KAFKA-13229: add total blocked time metric to streams (KIP-761) (#11149)\n\n* Add the following producer metrics:\nflush-time-total: cumulative sum of time elapsed during in flush.\ntxn-init-time-total: cumulative sum of time elapsed during in initTransactions.\ntxn-begin-time-total: cumulative sum of time elapsed during in beginTransaction.\ntxn-send-offsets-time-total: cumulative sum of time elapsed during in sendOffsetsToTransaction.\ntxn-commit-time-total: cumulative sum of time elapsed during in commitTransaction.\ntxn-abort-time-total: cumulative sum of time elapsed during in abortTransaction.\n\n* Add the following consumer metrics:\ncommited-time-total: cumulative sum of time elapsed during in committed.\ncommit-sync-time-total: cumulative sum of time elapsed during in commitSync.\n\n* Add a total-blocked-time metric to streams that is the sum of:\nconsumer?s io-waittime-total\nconsumer?s iotime-total\nconsumer?s committed-time-total\nconsumer?s commit-sync-time-total\nrestore consumer?s io-waittime-total\nrestore consumer?s iotime-total\nadmin client?s io-waittime-total\nadmin client?s iotime-total\nproducer?s bufferpool-wait-time-total\nproducer's flush-time-total\nproducer's txn-init-time-total\nproducer's txn-begin-time-total\nproducer's txn-send-offsets-time-total\nproducer's txn-commit-time-total\nproducer's txn-abort-time-total\n\nReviewers: Bruno Cadonna <cadonna@confluent.io>.  Guozhang Wang <wangguoz@gmail.com>","date":"2021-08-31 06:39:25","modifiedFileCount":"23","status":"M","submitter":"Rohan"}]
