[{"authorTime":"2017-04-21 08:54:36","codes":[{"authorDate":"2017-05-10 18:08:11","commitOrder":3,"curCode":"\tpublic void testCassandraTupleAtLeastOnceSink() throws Exception {\n\t\tCassandraTupleSink<Tuple3<String, Integer, Integer>> sink = new CassandraTupleSink<>(injectTableName(INSERT_DATA_QUERY), builder);\n\n\t\tsink.open(new Configuration());\n\n\t\tfor (Tuple3<String, Integer, Integer> value : collection) {\n\t\t\tsink.send(value);\n\t\t}\n\n\t\tsink.close();\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","date":"2017-05-13 02:20:53","endLine":374,"groupId":"45651","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testCassandraTupleAtLeastOnceSink","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/06/f3c352da85079d22c2e527aaa4410d60c5de44.src","preCode":"\tpublic void testCassandraTupleAtLeastOnceSink() throws Exception {\n\t\tCassandraTupleSink<Tuple3<String, Integer, Integer>> sink = new CassandraTupleSink<>(injectTableName(INSERT_DATA_QUERY), builder);\n\n\t\tsink.open(new Configuration());\n\n\t\tfor (Tuple3<String, Integer, Integer> value : collection) {\n\t\t\tsink.send(value);\n\t\t}\n\n\t\tsink.close();\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","realPath":"flink-connectors/flink-connector-cassandra/src/test/java/org/apache/flink/streaming/connectors/cassandra/CassandraConnectorITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":361,"status":"NB"},{"authorDate":"2017-04-21 08:54:36","commitOrder":3,"curCode":"\tpublic void testCassandraRowAtLeastOnceSink() throws Exception {\n\t\tCassandraRowSink sink = new CassandraRowSink(FIELD_TYPES.length, injectTableName(INSERT_DATA_QUERY), builder);\n\n\t\tsink.open(new Configuration());\n\n\t\tfor (Row value : rowCollection) {\n\t\t\tsink.send(value);\n\t\t}\n\n\t\tsink.close();\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","date":"2017-11-01 21:53:09","endLine":410,"groupId":"45650","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testCassandraRowAtLeastOnceSink","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/f1/b598fbb661136aaf9a35926fa44d7ece84904c.src","preCode":"\tpublic void testCassandraRowAtLeastOnceSink() throws Exception {\n\t\tCassandraRowSink sink = new CassandraRowSink(FIELD_TYPES.length, injectTableName(INSERT_DATA_QUERY), builder);\n\n\t\tsink.open(new Configuration());\n\n\t\tfor (Row value : rowCollection) {\n\t\t\tsink.send(value);\n\t\t}\n\n\t\tsink.close();\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","realPath":"flink-connectors/flink-connector-cassandra/src/test/java/org/apache/flink/streaming/connectors/cassandra/CassandraConnectorITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":397,"status":"B"}],"commitId":"1809cad6d05522d6185a69ca14ddc275d5ebbbf1","commitMessage":"@@@[FLINK-6225] [cassandra] Add a CassandraAppendTableSink.\n\nThis closes #3748.\n","date":"2017-11-01 21:53:09","modifiedFileCount":"3","status":"M","submitter":"Jing Fan"},{"authorTime":"2018-10-03 21:44:28","codes":[{"authorDate":"2018-10-03 21:44:28","commitOrder":4,"curCode":"\tpublic void testCassandraTupleAtLeastOnceSink() throws Exception {\n\t\tCassandraTupleSink<Tuple3<String, Integer, Integer>> sink = new CassandraTupleSink<>(injectTableName(INSERT_DATA_QUERY), builder);\n\t\ttry {\n\t\t\tsink.open(new Configuration());\n\t\t\tfor (Tuple3<String, Integer, Integer> value : collection) {\n\t\t\t\tsink.send(value);\n\t\t\t}\n\t\t} finally {\n\t\t\tsink.close();\n\t\t}\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","date":"2018-10-09 16:16:37","endLine":396,"groupId":"10871","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testCassandraTupleAtLeastOnceSink","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/a3/b7093dd256eaf5f7f6aa725a315656fa9e11d3.src","preCode":"\tpublic void testCassandraTupleAtLeastOnceSink() throws Exception {\n\t\tCassandraTupleSink<Tuple3<String, Integer, Integer>> sink = new CassandraTupleSink<>(injectTableName(INSERT_DATA_QUERY), builder);\n\n\t\tsink.open(new Configuration());\n\n\t\tfor (Tuple3<String, Integer, Integer> value : collection) {\n\t\t\tsink.send(value);\n\t\t}\n\n\t\tsink.close();\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","realPath":"flink-connectors/flink-connector-cassandra/src/test/java/org/apache/flink/streaming/connectors/cassandra/CassandraConnectorITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":383,"status":"M"},{"authorDate":"2018-10-03 21:44:28","commitOrder":4,"curCode":"\tpublic void testCassandraRowAtLeastOnceSink() throws Exception {\n\t\tCassandraRowSink sink = new CassandraRowSink(FIELD_TYPES.length, injectTableName(INSERT_DATA_QUERY), builder);\n\t\ttry {\n\t\t\tsink.open(new Configuration());\n\t\t\tfor (Row value : rowCollection) {\n\t\t\t\tsink.send(value);\n\t\t\t}\n\t\t} finally {\n\t\t\tsink.close();\n\t\t}\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","date":"2018-10-09 16:16:37","endLine":412,"groupId":"10871","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testCassandraRowAtLeastOnceSink","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/a3/b7093dd256eaf5f7f6aa725a315656fa9e11d3.src","preCode":"\tpublic void testCassandraRowAtLeastOnceSink() throws Exception {\n\t\tCassandraRowSink sink = new CassandraRowSink(FIELD_TYPES.length, injectTableName(INSERT_DATA_QUERY), builder);\n\n\t\tsink.open(new Configuration());\n\n\t\tfor (Row value : rowCollection) {\n\t\t\tsink.send(value);\n\t\t}\n\n\t\tsink.close();\n\n\t\tResultSet rs = session.execute(injectTableName(SELECT_DATA_QUERY));\n\t\tAssert.assertEquals(20, rs.all().size());\n\t}\n","realPath":"flink-connectors/flink-connector-cassandra/src/test/java/org/apache/flink/streaming/connectors/cassandra/CassandraConnectorITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":399,"status":"M"}],"commitId":"7d62a160c797e852705c0c0129b3fbbc4c1af9c7","commitMessage":"@@@[hotfix][cassandra][tests] Close sources/sinks in finally block\n","date":"2018-10-09 16:16:37","modifiedFileCount":"1","status":"M","submitter":"Benoit Meriaux"}]
