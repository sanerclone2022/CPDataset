[{"authorTime":"2021-03-11 14:14:07","codes":[{"authorDate":"2021-03-11 14:14:07","commitOrder":1,"curCode":"    public void testApplicationDefinedHasPrecedence() throws Exception {\n        final StateBackend appBackend = new MockStateBackend();\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, config(\"rocksdb\"), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","date":"2021-03-15 16:07:03","endLine":96,"groupId":"23843","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testApplicationDefinedHasPrecedence","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/e3/aa061769045b0e5d5e1c41e65242f54cf28664.src","preCode":"    public void testApplicationDefinedHasPrecedence() throws Exception {\n        final StateBackend appBackend = new MockStateBackend();\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, config(\"rocksdb\"), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","realPath":"flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendLoadingTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":82,"status":"B"},{"authorDate":"2021-03-11 14:14:07","commitOrder":1,"curCode":"    public void testApplicationDefinedChangelogStateBackend() throws Exception {\n        final StateBackend appBackend = new ChangelogStateBackend(new MockStateBackend());\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, config(\"rocksdb\"), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","date":"2021-03-15 16:07:03","endLine":113,"groupId":"23843","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testApplicationDefinedChangelogStateBackend","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/e3/aa061769045b0e5d5e1c41e65242f54cf28664.src","preCode":"    public void testApplicationDefinedChangelogStateBackend() throws Exception {\n        final StateBackend appBackend = new ChangelogStateBackend(new MockStateBackend());\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, config(\"rocksdb\"), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","realPath":"flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendLoadingTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":99,"status":"B"}],"commitId":"d72fa2ea588fc0f52ebd33d583187eb27972a483","commitMessage":"@@@[FLINK-21354] Introduce ChangelogStateBackend to delegate state access\n\nThis change is to wrap the existing prod state backend (Rocksdb.  Fs.  Mem) to delegate\nstate access for these state backends. In the future.  we can forward state changes to\nStateChangeLog when states are updated. In this PR.  we only support keyed-state access.\n\nThe changes include:\n1. Introduce `DelegatingStateBackend` interface for state backend delegation\n   (in the flink-runtime module)\n2. Introduce `ChangelogStateBackend` and related delegating states for\n   state delegation (in flink-state-backends module)\n3. Implement `ChangelogStateBackend`'s Loader in `StateBackendLoader`.\n   (in the flink-runtime module)\n","date":"2021-03-15 16:07:03","modifiedFileCount":"12","status":"B","submitter":"Yuan Mei"},{"authorTime":"2021-06-22 10:57:45","codes":[{"authorDate":"2021-06-22 10:57:45","commitOrder":2,"curCode":"    public void testApplicationDefinedHasPrecedence() throws Exception {\n        final StateBackend appBackend = new MockStateBackend();\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, TernaryBoolean.UNDEFINED, config(\"rocksdb\", true), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","date":"2021-06-22 10:57:45","endLine":107,"groupId":"1046","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testApplicationDefinedHasPrecedence","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/00/e8b78acddc73ef86c378bd99bec0f2258fb1a5.src","preCode":"    public void testApplicationDefinedHasPrecedence() throws Exception {\n        final StateBackend appBackend = new MockStateBackend();\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, config(\"rocksdb\"), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","realPath":"flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendLoadingTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":93,"status":"M"},{"authorDate":"2021-06-22 10:57:45","commitOrder":2,"curCode":"    public void testApplicationDefinedChangelogStateBackend() throws Exception {\n        final StateBackend appBackend = new MockStateBackend();\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, TernaryBoolean.TRUE, config(\"rocksdb\", false), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","date":"2021-06-22 10:57:45","endLine":124,"groupId":"1046","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testApplicationDefinedChangelogStateBackend","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/00/e8b78acddc73ef86c378bd99bec0f2258fb1a5.src","preCode":"    public void testApplicationDefinedChangelogStateBackend() throws Exception {\n        final StateBackend appBackend = new ChangelogStateBackend(new MockStateBackend());\n        \r\n        final StateBackend backend =\n                StateBackendLoader.fromApplicationOrConfigOrDefault(\n                        appBackend, config(\"rocksdb\"), cl, null);\n        final CheckpointStorage storage =\n                CheckpointStorageLoader.load(null, null, backend, config(), cl, null);\n\n        assertDelegateStateBackend(\n                backend, MockStateBackend.class, storage, MockStateBackend.class);\n        assertTrue(\n                ((MockStateBackend) (((ChangelogStateBackend) backend).getDelegatedStateBackend()))\n                        .isConfigUpdated());\n    }\n","realPath":"flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendLoadingTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":110,"status":"M"}],"commitId":"641c31e92fd8ff3702d2ac3510a63b0653802a2e","commitMessage":"@@@[FLINK-22678][state][changelog] Configurations and user APIs for ChangelogStateBackend\n\nThis fix #16153.","date":"2021-06-22 10:57:45","modifiedFileCount":"19","status":"M","submitter":"Zakelly"}]
