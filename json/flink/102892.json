[{"authorTime":"2021-06-26 15:42:11","codes":[{"authorDate":"2021-06-26 15:42:11","commitOrder":1,"curCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n\n        CheckpointBarrierTracker checkpointBarrierTracker =\n                (CheckpointBarrierTracker) inputGate.getCheckpointBarrierHandler();\n        checkpointBarrierTracker.setEnableCheckpointAfterTasksFinished(true);\n\n        for (int i = 0; i <= 2; ++i) {\n            assertEquals(sequence[i], inputGate.pollNext().get());\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n    }\n","date":"2021-07-03 00:00:46","endLine":614,"groupId":"581","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testDeduplicateChannelsWithBothBarrierAndEndOfPartition","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/3c/fe11f3d617e0f5c7a4e309d28369a9909daaa8.src","preCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n\n        CheckpointBarrierTracker checkpointBarrierTracker =\n                (CheckpointBarrierTracker) inputGate.getCheckpointBarrierHandler();\n        checkpointBarrierTracker.setEnableCheckpointAfterTasksFinished(true);\n\n        for (int i = 0; i <= 2; ++i) {\n            assertEquals(sequence[i], inputGate.pollNext().get());\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n    }\n","realPath":"flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierTrackerTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":588,"status":"B"},{"authorDate":"2021-06-26 15:42:11","commitOrder":1,"curCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1L);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n        inputGate.getCheckpointBarrierHandler().setEnableCheckpointAfterTasksFinished(true);\n\n        for (int i = 0; i <= 2; ++i) {\n            check(sequence[i], inputGate.pollNext().get(), PAGE_SIZE);\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n        assertThat(inputGate.getCheckpointBarrierHandler().isCheckpointPending(), equalTo(false));\n    }\n","date":"2021-07-03 00:00:46","endLine":1082,"groupId":"8225","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testDeduplicateChannelsWithBothBarrierAndEndOfPartition","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/72/f2ed2b6a99239d6ca2ebe7ab0b9e940ecb0228.src","preCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1L);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n        inputGate.getCheckpointBarrierHandler().setEnableCheckpointAfterTasksFinished(true);\n\n        for (int i = 0; i <= 2; ++i) {\n            check(sequence[i], inputGate.pollNext().get(), PAGE_SIZE);\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n        assertThat(inputGate.getCheckpointBarrierHandler().isCheckpointPending(), equalTo(false));\n    }\n","realPath":"flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/AlignedCheckpointsTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":1058,"status":"B"}],"commitId":"6f21603cc2386ba08cbf6f7e33634d96f8bc4815","commitMessage":"@@@[FLINK-21086][runtime][checkpoint] Make CheckpointBarrierHandler supports alignment with finished channels\n","date":"2021-07-03 00:00:46","modifiedFileCount":"23","status":"B","submitter":"Yun Gao"},{"authorTime":"2021-07-15 19:40:11","codes":[{"authorDate":"2021-07-15 19:40:11","commitOrder":2,"curCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n\n        for (int i = 0; i <= 2; ++i) {\n            assertEquals(sequence[i], inputGate.pollNext().get());\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n    }\n","date":"2021-07-28 18:47:48","endLine":638,"groupId":"102892","id":3,"instanceNumber":1,"isCurCommit":1,"methodName":"testDeduplicateChannelsWithBothBarrierAndEndOfPartition","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/35/bc92f8e55b85e984ef2e6c43306a996fb08df6.src","preCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n\n        CheckpointBarrierTracker checkpointBarrierTracker =\n                (CheckpointBarrierTracker) inputGate.getCheckpointBarrierHandler();\n        checkpointBarrierTracker.setEnableCheckpointAfterTasksFinished(true);\n\n        for (int i = 0; i <= 2; ++i) {\n            assertEquals(sequence[i], inputGate.pollNext().get());\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n    }\n","realPath":"flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierTrackerTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":616,"status":"M"},{"authorDate":"2021-07-15 19:40:11","commitOrder":2,"curCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1L);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n\n        for (int i = 0; i <= 2; ++i) {\n            check(sequence[i], inputGate.pollNext().get(), PAGE_SIZE);\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n        assertThat(inputGate.getCheckpointBarrierHandler().isCheckpointPending(), equalTo(false));\n    }\n","date":"2021-07-28 18:47:48","endLine":1097,"groupId":"102892","id":4,"instanceNumber":2,"isCurCommit":1,"methodName":"testDeduplicateChannelsWithBothBarrierAndEndOfPartition","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/1b/6af2d63b76ba60086647712a6919691fac4b0f.src","preCode":"    public void testDeduplicateChannelsWithBothBarrierAndEndOfPartition() throws Exception {\n        BufferOrEvent[] sequence = {\n             createBarrier(2, 0),\n             createBarrier(2, 1),\n             createEndOfPartition(1),\n             createBarrier(2, 2)\n        };\n\n        ValidatingCheckpointHandler validator = new ValidatingCheckpointHandler(-1L);\n        inputGate = createCheckpointedInputGate(3, sequence, validator);\n        inputGate.getCheckpointBarrierHandler().setEnableCheckpointAfterTasksFinished(true);\n\n        for (int i = 0; i <= 2; ++i) {\n            check(sequence[i], inputGate.pollNext().get(), PAGE_SIZE);\n        }\n\n        \r\n        assertEquals(0, validator.getTriggeredCheckpointCounter());\n        assertEquals(0, validator.getAbortedCheckpointCounter());\n\n        \r\n        assertEquals(sequence[3], inputGate.pollNext().get());\n        assertThat(validator.triggeredCheckpoints, contains(2L));\n        assertThat(inputGate.getCheckpointBarrierHandler().isCheckpointPending(), equalTo(false));\n    }\n","realPath":"flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/AlignedCheckpointsTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":1074,"status":"M"}],"commitId":"7c902745fff13e70908d32084d2888a69e13fc8b","commitMessage":"@@@[FLINK-23460] Use a global feature flag in the CheckpointBarrierHandler\n","date":"2021-07-28 18:47:48","modifiedFileCount":"21","status":"M","submitter":"Dawid Wysakowicz"}]
