[{"authorTime":"2019-05-30 03:20:18","codes":[{"authorDate":"2020-09-30 10:30:46","commitOrder":2,"curCode":"\tpublic void testCreateHiveCatalog() {\n\t\tfinal String catalogName = \"mycatalog\";\n\n\t\tfinal HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);\n\n\t\tfinal HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();\n\t\tcatalogDescriptor.hiveSitePath(CONF_DIR.getPath());\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (HiveCatalog) actualCatalog);\n\t}\n","date":"2020-09-30 10:30:46","endLine":75,"groupId":"19813","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testCreateHiveCatalog","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/38/7f4abf8eed6c174d0a92f6c0aaa0bfdde89e1d.src","preCode":"\tpublic void testCreateHiveCatalog() {\n\t\tfinal String catalogName = \"mycatalog\";\n\n\t\tfinal HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);\n\n\t\tfinal HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();\n\t\tcatalogDescriptor.hiveSitePath(CONF_DIR.getPath());\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (HiveCatalog) actualCatalog);\n\t}\n","realPath":"flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":61,"status":"B"},{"authorDate":"2019-05-30 03:20:18","commitOrder":2,"curCode":"\tpublic void test() throws Exception {\n\t\tfinal String catalogName = \"mycatalog\";\n\t\tfinal String databaseName = \"mydatabase\";\n\n\t\tfinal GenericInMemoryCatalog expectedCatalog = new GenericInMemoryCatalog(catalogName, databaseName);\n\n\t\tfinal CatalogDescriptor catalogDescriptor = new GenericInMemoryCatalogDescriptor(databaseName);\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (GenericInMemoryCatalog) actualCatalog);\n\t}\n","date":"2019-06-01 02:08:34","endLine":53,"groupId":"26535","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"test","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/eb/3d61512c375ca0e7605fa8a390ba72d153365c.src","preCode":"\tpublic void test() throws Exception {\n\t\tfinal String catalogName = \"mycatalog\";\n\t\tfinal String databaseName = \"mydatabase\";\n\n\t\tfinal GenericInMemoryCatalog expectedCatalog = new GenericInMemoryCatalog(catalogName, databaseName);\n\n\t\tfinal CatalogDescriptor catalogDescriptor = new GenericInMemoryCatalogDescriptor(databaseName);\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (GenericInMemoryCatalog) actualCatalog);\n\t}\n","realPath":"flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/catalog/GenericInMemoryCatalogFactoryTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":39,"status":"NB"}],"commitId":"b4ae1170b11cabcb6737c390508e8b8cdfc7c6bd","commitMessage":"@@@[FLINK-19292][hive] HiveCatalog should support specifying Hadoop conf dir with configuration (#13434)\n\n","date":"2020-09-30 10:30:46","modifiedFileCount":"6","status":"M","submitter":"SteNicholas"},{"authorTime":"2019-05-30 03:20:18","codes":[{"authorDate":"2020-10-29 16:12:29","commitOrder":3,"curCode":"\tpublic void testCreateHiveCatalog() {\n\t\tfinal String catalogName = \"mycatalog\";\n\n\t\tfinal HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);\n\n\t\tfinal HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();\n\t\tcatalogDescriptor.hiveSitePath(CONF_DIR.getPath());\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tassertEquals(\"dummy-hms\", ((HiveCatalog) actualCatalog).getHiveConf().getVar(HiveConf.ConfVars.METASTOREURIS));\n\t\tcheckEquals(expectedCatalog, (HiveCatalog) actualCatalog);\n\t}\n","date":"2020-10-29 16:12:29","endLine":82,"groupId":"19813","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testCreateHiveCatalog","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/94/ab76e6b129388dd6e2f3d14f4b31ec27b0fa98.src","preCode":"\tpublic void testCreateHiveCatalog() {\n\t\tfinal String catalogName = \"mycatalog\";\n\n\t\tfinal HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);\n\n\t\tfinal HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();\n\t\tcatalogDescriptor.hiveSitePath(CONF_DIR.getPath());\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (HiveCatalog) actualCatalog);\n\t}\n","realPath":"flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":67,"status":"M"},{"authorDate":"2019-05-30 03:20:18","commitOrder":3,"curCode":"\tpublic void test() throws Exception {\n\t\tfinal String catalogName = \"mycatalog\";\n\t\tfinal String databaseName = \"mydatabase\";\n\n\t\tfinal GenericInMemoryCatalog expectedCatalog = new GenericInMemoryCatalog(catalogName, databaseName);\n\n\t\tfinal CatalogDescriptor catalogDescriptor = new GenericInMemoryCatalogDescriptor(databaseName);\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (GenericInMemoryCatalog) actualCatalog);\n\t}\n","date":"2019-06-01 02:08:34","endLine":53,"groupId":"26535","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"test","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/eb/3d61512c375ca0e7605fa8a390ba72d153365c.src","preCode":"\tpublic void test() throws Exception {\n\t\tfinal String catalogName = \"mycatalog\";\n\t\tfinal String databaseName = \"mydatabase\";\n\n\t\tfinal GenericInMemoryCatalog expectedCatalog = new GenericInMemoryCatalog(catalogName, databaseName);\n\n\t\tfinal CatalogDescriptor catalogDescriptor = new GenericInMemoryCatalogDescriptor(databaseName);\n\n\t\tfinal Map<String, String> properties = catalogDescriptor.toProperties();\n\n\t\tfinal Catalog actualCatalog = TableFactoryService.find(CatalogFactory.class, properties)\n\t\t\t.createCatalog(catalogName, properties);\n\n\t\tcheckEquals(expectedCatalog, (GenericInMemoryCatalog) actualCatalog);\n\t}\n","realPath":"flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/catalog/GenericInMemoryCatalogFactoryTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":39,"status":"N"}],"commitId":"28e937a3d9a5ef507bd90d9512b5ea6ab4cee37d","commitMessage":"@@@[FLINK-19702][hive] Avoid using static variable HiveConf.hiveSiteURL\n\nThis closes #13685","date":"2020-10-29 16:12:29","modifiedFileCount":"2","status":"M","submitter":"Rui Li"},{"authorTime":"2021-03-18 16:03:20","codes":[{"authorDate":"2021-03-18 16:03:20","commitOrder":4,"curCode":"    public void testCreateHiveCatalog() {\n        final String catalogName = \"mycatalog\";\n\n        final HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);\n\n        final Map<String, String> options = new HashMap<>();\n        options.put(CommonCatalogOptions.CATALOG_TYPE.key(), HiveCatalogFactoryOptions.IDENTIFIER);\n        options.put(HiveCatalogFactoryOptions.HIVE_CONF_DIR.key(), CONF_DIR.getPath());\n\n        final Catalog actualCatalog =\n                FactoryUtil.createCatalog(\n                        catalogName, options, null, Thread.currentThread().getContextClassLoader());\n\n        assertEquals(\n                \"dummy-hms\",\n                ((HiveCatalog) actualCatalog)\n                        .getHiveConf()\n                        .getVar(HiveConf.ConfVars.METASTOREURIS));\n        checkEquals(expectedCatalog, (HiveCatalog) actualCatalog);\n    }\n","date":"2021-03-24 20:29:09","endLine":82,"groupId":"101037","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testCreateHiveCatalog","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/c6/ce2a337dd6b6419772c52d330848eb75230b26.src","preCode":"    public void testCreateHiveCatalog() {\n        final String catalogName = \"mycatalog\";\n\n        final HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);\n\n        final HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();\n        catalogDescriptor.hiveSitePath(CONF_DIR.getPath());\n\n        final Map<String, String> properties = catalogDescriptor.toProperties();\n\n        final Catalog actualCatalog =\n                TableFactoryService.find(CatalogFactory.class, properties)\n                        .createCatalog(catalogName, properties);\n\n        assertEquals(\n                \"dummy-hms\",\n                ((HiveCatalog) actualCatalog)\n                        .getHiveConf()\n                        .getVar(HiveConf.ConfVars.METASTOREURIS));\n        checkEquals(expectedCatalog, (HiveCatalog) actualCatalog);\n    }\n","realPath":"flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":63,"status":"M"},{"authorDate":"2021-03-18 16:03:20","commitOrder":4,"curCode":"    public void test() throws Exception {\n        final String catalogName = \"mycatalog\";\n        final String databaseName = \"mydatabase\";\n\n        final GenericInMemoryCatalog expectedCatalog =\n                new GenericInMemoryCatalog(catalogName, databaseName);\n\n        final Map<String, String> options = new HashMap<>();\n        options.put(\n                CommonCatalogOptions.CATALOG_TYPE.key(),\n                GenericInMemoryCatalogFactoryOptions.IDENTIFIER);\n        options.put(GenericInMemoryCatalogFactoryOptions.DEFAULT_DATABASE.key(), databaseName);\n\n        final Catalog actualCatalog =\n                FactoryUtil.createCatalog(\n                        catalogName, options, null, Thread.currentThread().getContextClassLoader());\n\n        checkEquals(expectedCatalog, (GenericInMemoryCatalog) actualCatalog);\n    }\n","date":"2021-03-24 20:29:09","endLine":53,"groupId":"101037","id":6,"instanceNumber":2,"isCurCommit":1,"methodName":"test","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/11/84936cd0964280e7b419c6d15e0870f311d52e.src","preCode":"    public void test() throws Exception {\n        final String catalogName = \"mycatalog\";\n        final String databaseName = \"mydatabase\";\n\n        final GenericInMemoryCatalog expectedCatalog =\n                new GenericInMemoryCatalog(catalogName, databaseName);\n\n        final CatalogDescriptor catalogDescriptor =\n                new GenericInMemoryCatalogDescriptor(databaseName);\n\n        final Map<String, String> properties = catalogDescriptor.toProperties();\n\n        final Catalog actualCatalog =\n                TableFactoryService.find(CatalogFactory.class, properties)\n                        .createCatalog(catalogName, properties);\n\n        checkEquals(expectedCatalog, (GenericInMemoryCatalog) actualCatalog);\n    }\n","realPath":"flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/catalog/GenericInMemoryCatalogFactoryTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":35,"status":"M"}],"commitId":"b0fa390da5081b7c6208a194159f5079fa1eb89f","commitMessage":"@@@[FLINK-21822][table] Migrate built-in and test catalog factories to new stack\n","date":"2021-03-24 20:29:09","modifiedFileCount":"19","status":"M","submitter":"Ingo B?rk"}]
