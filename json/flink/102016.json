[{"authorTime":"2019-12-25 20:37:35","codes":[{"authorDate":"2019-12-03 17:21:29","commitOrder":4,"curCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","date":"2020-02-15 14:07:13","endLine":124,"groupId":"31014","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"createHiveVectorFromConstant","params":"(LogicalTypetype@Objectvalue@intbatchSize)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/62/fd12b7d35a7b0015cfe0555ae875d6ff45245c.src","preCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","realPath":"flink-formats/flink-orc-nohive/src/main/java/org/apache/flink/orc/nohive/vector/AbstractOrcNoHiveVector.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":92,"status":"B"},{"authorDate":"2019-12-25 20:37:35","commitOrder":4,"curCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","date":"2019-12-27 02:29:09","endLine":124,"groupId":"31014","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"createHiveVectorFromConstant","params":"(LogicalTypetype@Objectvalue@intbatchSize)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/8c/abe7f6eca028851a00fcd29a98b4f4524445dd.src","preCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","realPath":"flink-formats/flink-orc/src/main/java/org/apache/flink/orc/vector/AbstractOrcColumnVector.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":92,"status":"NB"}],"commitId":"63e9e9d200ef4f17097ae236be09d308efe8b72a","commitMessage":"@@@[FLINK-14802][orc][hive] Multi vectorized read version support for hive orc read\n\nsupport vectorized read for hive 1.x.\n\ncloses #10730\n","date":"2020-02-15 14:07:13","modifiedFileCount":"11","status":"M","submitter":"JingsongLi"},{"authorTime":"2020-08-12 15:28:38","codes":[{"authorDate":"2019-12-03 17:21:29","commitOrder":5,"curCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","date":"2020-02-15 14:07:13","endLine":124,"groupId":"102016","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"createHiveVectorFromConstant","params":"(LogicalTypetype@Objectvalue@intbatchSize)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/62/fd12b7d35a7b0015cfe0555ae875d6ff45245c.src","preCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","realPath":"flink-formats/flink-orc-nohive/src/main/java/org/apache/flink/orc/nohive/vector/AbstractOrcNoHiveVector.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":92,"status":"N"},{"authorDate":"2020-08-12 15:28:38","commitOrder":5,"curCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn TimestampUtil.createVectorFromConstant(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","date":"2020-08-12 15:28:38","endLine":122,"groupId":"102016","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"createHiveVectorFromConstant","params":"(LogicalTypetype@Objectvalue@intbatchSize)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/1b/9b8cc086b5267fef000064459bf326f9ff5433.src","preCode":"\tprivate static ColumnVector createHiveVectorFromConstant(\n\t\t\tLogicalType type, Object value, int batchSize) {\n\t\tswitch (type.getTypeRoot()) {\n\t\t\tcase CHAR:\n\t\t\tcase VARCHAR:\n\t\t\tcase BINARY:\n\t\t\tcase VARBINARY:\n\t\t\t\treturn createBytesVector(batchSize, value);\n\t\t\tcase BOOLEAN:\n\t\t\t\treturn createLongVector(batchSize, (Boolean) value ? 1 : 0);\n\t\t\tcase TINYINT:\n\t\t\tcase SMALLINT:\n\t\t\tcase INTEGER:\n\t\t\tcase BIGINT:\n\t\t\t\treturn createLongVector(batchSize, value);\n\t\t\tcase DECIMAL:\n\t\t\t\tDecimalType decimalType = (DecimalType) type;\n\t\t\t\treturn createDecimalVector(\n\t\t\t\t\t\tbatchSize, decimalType.getPrecision(), decimalType.getScale(), value);\n\t\t\tcase FLOAT:\n\t\t\tcase DOUBLE:\n\t\t\t\treturn createDoubleVector(batchSize, value);\n\t\t\tcase DATE:\n\t\t\t\tif (value instanceof LocalDate) {\n\t\t\t\t\tvalue = Date.valueOf((LocalDate) value);\n\t\t\t\t}\n\t\t\t\treturn createLongVector(batchSize, dateToInternal((Date) value));\n\t\t\tcase TIMESTAMP_WITHOUT_TIME_ZONE:\n\t\t\t\treturn createTimestampVector(batchSize, value);\n\t\t\tdefault:\n\t\t\t\tthrow new UnsupportedOperationException(\"Unsupported type: \" + type);\n\t\t}\n\t}\n","realPath":"flink-formats/flink-orc/src/main/java/org/apache/flink/orc/vector/AbstractOrcColumnVector.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"M"}],"commitId":"808ec56bf9487f09178429c9045e51b48d1dc9c5","commitMessage":"@@@[FLINK-18682][orc][hive] Vector orc reader cannot read Hive 2.0.0 table\n\nThis closes #12985","date":"2020-08-12 15:28:38","modifiedFileCount":"4","status":"M","submitter":"Rui Li"}]
