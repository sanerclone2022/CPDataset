[{"authorTime":"2016-06-11 08:14:07","codes":[{"authorDate":"2016-06-11 08:14:07","commitOrder":1,"curCode":"\tpublic void testCompositeKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(3);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","date":"2016-07-05 21:51:06","endLine":90,"groupId":"52515","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testCompositeKeyOnNestedPojo","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/c3/45b370f678b9d403463e92bd3bfd4733f21c03.src","preCode":"\tpublic void testCompositeKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(3);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","realPath":"flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/DataStreamPojoITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":50,"status":"B"},{"authorDate":"2016-06-11 08:14:07","commitOrder":1,"curCode":"\tpublic void testNestedKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(4);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(value.stats.count != 123) {\n\t\t\t\t\t\t\tthrow new RuntimeException(\"Wrong value for value.stats.count\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","date":"2016-07-05 21:51:06","endLine":139,"groupId":"1053","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testNestedKeyOnNestedPojo","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/c3/45b370f678b9d403463e92bd3bfd4733f21c03.src","preCode":"\tpublic void testNestedKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(4);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(value.stats.count != 123) {\n\t\t\t\t\t\t\tthrow new RuntimeException(\"Wrong value for value.stats.count\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","realPath":"flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/DataStreamPojoITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":96,"status":"B"}],"commitId":"b9f42e91c9415dd6063079df00c142334b74e636","commitMessage":"@@@[FLINK-3995] [build] flink-test-utils also contains the streaming test utilities.\n\nTest utilities include the StreamingMultipleProgramsTestBase and StreamingTestEnvironment.\n\nThis moves the ITCases for streaming into 'flink-tests' to achieve that.\n\nThis closes #2092\n","date":"2016-07-05 21:51:06","modifiedFileCount":"12","status":"B","submitter":"Stephan Ewen"},{"authorTime":"2016-07-28 21:08:24","codes":[{"authorDate":"2016-07-28 21:08:24","commitOrder":2,"curCode":"\tpublic void testCompositeKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(3);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tprivate static final long serialVersionUID = 788865239171396315L;\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","date":"2016-09-01 01:04:31","endLine":91,"groupId":"101458","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testCompositeKeyOnNestedPojo","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/cc/8b6991775782b9098c5ce8af2ceb5cf5414324.src","preCode":"\tpublic void testCompositeKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(3);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"abc\", \"wxyz\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","realPath":"flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/DataStreamPojoITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":50,"status":"M"},{"authorDate":"2016-07-28 21:08:24","commitOrder":2,"curCode":"\tpublic void testNestedKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(4);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tprivate static final long serialVersionUID = -3678267280397950258L;\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(value.stats.count != 123) {\n\t\t\t\t\t\t\tthrow new RuntimeException(\"Wrong value for value.stats.count\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","date":"2016-09-01 01:04:31","endLine":141,"groupId":"101458","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testNestedKeyOnNestedPojo","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/cc/8b6991775782b9098c5ce8af2ceb5cf5414324.src","preCode":"\tpublic void testNestedKeyOnNestedPojo() throws Exception {\n\t\tStreamExecutionEnvironment see = StreamExecutionEnvironment.getExecutionEnvironment();\n\t\tsee.getConfig().disableObjectReuse();\n\t\tsee.setParallelism(4);\n\n\t\tDataStream<Data> dataStream = see.fromCollection(elements);\n\n\t\tDataStream<Data> summedStream = dataStream\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.sum(\"sum\")\n\t\t\t\t.keyBy(\"aaa\", \"stats.count\")\n\t\t\t\t.flatMap(new FlatMapFunction<Data, Data>() {\n\t\t\t\t\tData[] first = new Data[3];\n\t\t\t\t\t@Override\n\t\t\t\t\tpublic void flatMap(Data value, Collector<Data> out) throws Exception {\n\t\t\t\t\t\tif(value.stats.count != 123) {\n\t\t\t\t\t\t\tthrow new RuntimeException(\"Wrong value for value.stats.count\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(first[value.aaa] == null) {\n\t\t\t\t\t\t\tfirst[value.aaa] = value;\n\t\t\t\t\t\t\tif(value.sum != 1) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be one\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(value.sum != 2) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"Expected the sum to be two\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].aaa != value.aaa) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"aaa key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].abc != value.abc) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"abc key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(first[value.aaa].wxyz != value.wxyz) {\n\t\t\t\t\t\t\t\tthrow new RuntimeException(\"wxyz key wrong\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tsummedStream.print();\n\n\t\tsee.execute();\n\t}\n","realPath":"flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/DataStreamPojoITCase.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":97,"status":"M"}],"commitId":"ec975aaba79449bd93020f296b05ea509ea57bdc","commitMessage":"@@@[FLINK-4380] Introduce KeyGroupAssigner and Max-Parallelism Parameter\n\nThis introduces a new KeySelector that assigns keys to key groups and\nalso adds the max parallelism parameter throughout all API levels.\n\nThis also adds tests for the newly introduced features.\n","date":"2016-09-01 01:04:31","modifiedFileCount":"41","status":"M","submitter":"Till Rohrmann"}]
