[{"authorTime":"2018-11-07 09:29:49","codes":[{"authorDate":"2018-11-07 09:29:49","commitOrder":2,"curCode":"    public void clearSystemProperties(X509Util x509Util) {\n        System.clearProperty(x509Util.getSslKeystoreLocationProperty());\n        System.clearProperty(x509Util.getSslKeystorePasswdProperty());\n        System.clearProperty(x509Util.getSslKeystoreTypeProperty());\n        System.clearProperty(x509Util.getSslTruststoreLocationProperty());\n        System.clearProperty(x509Util.getSslTruststorePasswdProperty());\n        System.clearProperty(x509Util.getSslTruststoreTypeProperty());\n        System.clearProperty(x509Util.getSslHostnameVerificationEnabledProperty());\n    }\n","date":"2018-11-07 09:29:49","endLine":351,"groupId":"3960","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"clearSystemProperties","params":"(X509Utilx509Util)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/5a/86bb4a7a877a3215f7e11f0cb4a848cd3c2dae.src","preCode":"    public void clearSystemProperties(X509Util x509Util) {\n        System.clearProperty(x509Util.getSslKeystoreLocationProperty());\n        System.clearProperty(x509Util.getSslKeystorePasswdProperty());\n        System.clearProperty(x509Util.getSslKeystoreTypeProperty());\n        System.clearProperty(x509Util.getSslTruststoreLocationProperty());\n        System.clearProperty(x509Util.getSslTruststorePasswdProperty());\n        System.clearProperty(x509Util.getSslTruststoreTypeProperty());\n        System.clearProperty(x509Util.getSslHostnameVerificationEnabledProperty());\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestContext.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":343,"status":"B"},{"authorDate":"2018-11-07 09:29:49","commitOrder":2,"curCode":"    public void cleanUp() {\n        x509TestContext.clearSystemProperties(x509Util);\n        System.clearProperty(x509Util.getSslOcspEnabledProperty());\n        System.clearProperty(x509Util.getSslCrlEnabledProperty());\n        System.clearProperty(x509Util.getCipherSuitesProperty());\n        System.clearProperty(x509Util.getSslProtocolProperty());\n        System.clearProperty(\"com.sun.net.ssl.checkRevocation\");\n        System.clearProperty(\"com.sun.security.enableCRLDP\");\n        Security.setProperty(\"ocsp.enable\", Boolean.FALSE.toString());\n        Security.setProperty(\"com.sun.security.enableCRLDP\", Boolean.FALSE.toString());\n        System.clearProperty(ServerCnxnFactory.ZOOKEEPER_SERVER_CNXN_FACTORY);\n        System.clearProperty(ZKClientConfig.ZOOKEEPER_CLIENT_CNXN_SOCKET);\n    }\n","date":"2018-11-07 09:29:49","endLine":92,"groupId":"1319","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"cleanUp","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/6b/343c32e78bd3f50c0041ccc3ef5831d8a713c0.src","preCode":"    public void cleanUp() {\n        x509TestContext.clearSystemProperties(x509Util);\n        System.clearProperty(x509Util.getSslOcspEnabledProperty());\n        System.clearProperty(x509Util.getSslCrlEnabledProperty());\n        System.clearProperty(x509Util.getCipherSuitesProperty());\n        System.clearProperty(x509Util.getSslProtocolProperty());\n        System.clearProperty(\"com.sun.net.ssl.checkRevocation\");\n        System.clearProperty(\"com.sun.security.enableCRLDP\");\n        Security.setProperty(\"ocsp.enable\", Boolean.FALSE.toString());\n        Security.setProperty(\"com.sun.security.enableCRLDP\", Boolean.FALSE.toString());\n        System.clearProperty(ServerCnxnFactory.ZOOKEEPER_SERVER_CNXN_FACTORY);\n        System.clearProperty(ZKClientConfig.ZOOKEEPER_CLIENT_CNXN_SOCKET);\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509UtilTest.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":80,"status":"MB"}],"commitId":"03286f29d29f4c1d3496ce87d1441df91422220e","commitMessage":"@@@ZOOKEEPER-3173: Quorum TLS - support PEM trust/key stores\n\nAdd support for loading key and trust stores from PEM files.\n\nUnfortunately.  this PR includes 2 JIRAs.  because it was quite difficult\nto untangle the two features as they were developed at the same time\noriginally:\n\n- ZOOKEEPER-3173: Quorum TLS - support PEM trust/key stores\n- ZOOKEEPER-3175: Quorum TLS - test improvements\n\n## Added support for PEM formatted key stores and trust stores\n- key store and trust store files can now be in PEM format as well as JKS.\n- Added config properties to tell ZK what type of trust/key store to load:\n- `zookeeper.ssl.keyStore.type` and `zookeeper.ssl.trustStore.type` for ClientX509Util\n- `zookeeper.ssl.quorum.keyStore.type` and `zookeeper.ssl.quorum.trustStore.type` for QuorumX509Util\n- store type properties could have the values \"JKS\".  \"PEM\".  or not set\n- leaving the type properties unset will cause auto-detection of the store type based on the file extension (\".jks\" or \".pem\")\n\n## Added test utilities for easily creating X509 certs and using them in unit tests\n- added new class `X509TestContext` and its friend.  `X509TestHelpers`\n- rewrote some existing unit tests to use these classes.  and added new tests that use them\n- some existing tests (i.e. `QuorumSSLTest`) should probably be ported to use this as well.  haven't got around to it yet\n\nAuthor: Ilya Maykov <ilyam@fb.com>\n\nReviewers: andor@apache.org\n\nCloses #678 from ivmaykov/ZOOKEEPER-3173\n","date":"2018-11-07 09:29:49","modifiedFileCount":"4","status":"M","submitter":"Ilya Maykov"},{"authorTime":"2018-12-15 14:34:54","codes":[{"authorDate":"2018-11-07 09:29:49","commitOrder":3,"curCode":"    public void clearSystemProperties(X509Util x509Util) {\n        System.clearProperty(x509Util.getSslKeystoreLocationProperty());\n        System.clearProperty(x509Util.getSslKeystorePasswdProperty());\n        System.clearProperty(x509Util.getSslKeystoreTypeProperty());\n        System.clearProperty(x509Util.getSslTruststoreLocationProperty());\n        System.clearProperty(x509Util.getSslTruststorePasswdProperty());\n        System.clearProperty(x509Util.getSslTruststoreTypeProperty());\n        System.clearProperty(x509Util.getSslHostnameVerificationEnabledProperty());\n    }\n","date":"2018-11-07 09:29:49","endLine":351,"groupId":"10156","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"clearSystemProperties","params":"(X509Utilx509Util)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/5a/86bb4a7a877a3215f7e11f0cb4a848cd3c2dae.src","preCode":"    public void clearSystemProperties(X509Util x509Util) {\n        System.clearProperty(x509Util.getSslKeystoreLocationProperty());\n        System.clearProperty(x509Util.getSslKeystorePasswdProperty());\n        System.clearProperty(x509Util.getSslKeystoreTypeProperty());\n        System.clearProperty(x509Util.getSslTruststoreLocationProperty());\n        System.clearProperty(x509Util.getSslTruststorePasswdProperty());\n        System.clearProperty(x509Util.getSslTruststoreTypeProperty());\n        System.clearProperty(x509Util.getSslHostnameVerificationEnabledProperty());\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestContext.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":343,"status":"N"},{"authorDate":"2018-12-15 14:34:54","commitOrder":3,"curCode":"    public void cleanUp() {\n        x509TestContext.clearSystemProperties(x509Util);\n        System.clearProperty(x509Util.getSslOcspEnabledProperty());\n        System.clearProperty(x509Util.getSslCrlEnabledProperty());\n        System.clearProperty(x509Util.getCipherSuitesProperty());\n        System.clearProperty(x509Util.getSslProtocolProperty());\n        System.clearProperty(x509Util.getSslHandshakeDetectionTimeoutMillisProperty());\n        System.clearProperty(\"com.sun.net.ssl.checkRevocation\");\n        System.clearProperty(\"com.sun.security.enableCRLDP\");\n        Security.setProperty(\"ocsp.enable\", Boolean.FALSE.toString());\n        Security.setProperty(\"com.sun.security.enableCRLDP\", Boolean.FALSE.toString());\n        System.clearProperty(ServerCnxnFactory.ZOOKEEPER_SERVER_CNXN_FACTORY);\n        System.clearProperty(ZKClientConfig.ZOOKEEPER_CLIENT_CNXN_SOCKET);\n        x509Util.close();\n    }\n","date":"2018-12-15 14:34:54","endLine":96,"groupId":"10156","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"cleanUp","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/10/58010febbf821a072bb809840fd7ef20ba2d6a.src","preCode":"    public void cleanUp() {\n        x509TestContext.clearSystemProperties(x509Util);\n        System.clearProperty(x509Util.getSslOcspEnabledProperty());\n        System.clearProperty(x509Util.getSslCrlEnabledProperty());\n        System.clearProperty(x509Util.getCipherSuitesProperty());\n        System.clearProperty(x509Util.getSslProtocolProperty());\n        System.clearProperty(\"com.sun.net.ssl.checkRevocation\");\n        System.clearProperty(\"com.sun.security.enableCRLDP\");\n        Security.setProperty(\"ocsp.enable\", Boolean.FALSE.toString());\n        Security.setProperty(\"com.sun.security.enableCRLDP\", Boolean.FALSE.toString());\n        System.clearProperty(ServerCnxnFactory.ZOOKEEPER_SERVER_CNXN_FACTORY);\n        System.clearProperty(ZKClientConfig.ZOOKEEPER_CLIENT_CNXN_SOCKET);\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509UtilTest.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":82,"status":"M"}],"commitId":"e043c322f12d56da0fc88131628edf0731c0f8e4","commitMessage":"@@@ZOOKEEPER-3174: Quorum TLS - support reloading trust/key store\n\nAllow reloading SSL trust stores and key stores from disk when the files on disk change.\n\n## Added support for reloading key/trust stores when the file on disk changes\n- new property `sslQuorumReloadCertFiles` which controls the behavior for reloading the key and trust store files for `QuorumX509Util`. Reloading of key and trust store for `ClientX509Util` is not in this PR but could be added easily\n- this allows a ZK server to keep running on a machine that uses short-lived certs that refresh frequently without having to restart the ZK process.\n\nAuthor: Ilya Maykov <ilyam@fb.com>\n\nReviewers: andor@apache.org\n\nCloses #680 from ivmaykov/ZOOKEEPER-3174\n","date":"2018-12-15 14:34:54","modifiedFileCount":"18","status":"M","submitter":"Ilya Maykov"}]
