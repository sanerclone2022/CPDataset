[{"authorTime":"2019-07-15 20:46:48","codes":[{"authorDate":"2019-07-15 20:46:48","commitOrder":1,"curCode":"    public File getTrustStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n            case JKS:\n                return getTrustStoreJksFile();\n            case PEM:\n                return getTrustStorePemFile();\n            case PKCS12:\n                return getTrustStorePkcs12File();\n            default:\n                throw new IllegalArgumentException(\"Invalid trust store type: \" + storeFileType + \", must be one of: \" +\n                        Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","date":"2019-07-15 20:46:48","endLine":183,"groupId":"3953","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"getTrustStoreFile","params":"(KeyStoreFileTypestoreFileType)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/3a/899f44c79fb1a9e63319a9e81bf5cc2b844b1c.src","preCode":"    public File getTrustStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n            case JKS:\n                return getTrustStoreJksFile();\n            case PEM:\n                return getTrustStorePemFile();\n            case PKCS12:\n                return getTrustStorePkcs12File();\n            default:\n                throw new IllegalArgumentException(\"Invalid trust store type: \" + storeFileType + \", must be one of: \" +\n                        Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestContext.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":171,"status":"B"},{"authorDate":"2019-07-15 20:46:48","commitOrder":1,"curCode":"    public File getKeyStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n            case JKS:\n                return getKeyStoreJksFile();\n            case PEM:\n                return getKeyStorePemFile();\n            case PKCS12:\n                return getKeyStorePkcs12File();\n            default:\n                throw new IllegalArgumentException(\"Invalid key store type: \" + storeFileType + \", must be one of: \" +\n                        Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","date":"2019-07-15 20:46:48","endLine":277,"groupId":"3953","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"getKeyStoreFile","params":"(KeyStoreFileTypestoreFileType)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/3a/899f44c79fb1a9e63319a9e81bf5cc2b844b1c.src","preCode":"    public File getKeyStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n            case JKS:\n                return getKeyStoreJksFile();\n            case PEM:\n                return getKeyStorePemFile();\n            case PKCS12:\n                return getKeyStorePkcs12File();\n            default:\n                throw new IllegalArgumentException(\"Invalid key store type: \" + storeFileType + \", must be one of: \" +\n                        Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestContext.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":265,"status":"B"}],"commitId":"1c83846615701e88749690f06993a6e77452b83c","commitMessage":"@@@ZOOKEEPER-3443: Add support of PKCS12 trust/key stores\n\nThis commit adds support of PKCS12 trust store and key store type.\nThe existing mechanism for trust/key store types that support JKS and\nPEM were extended with PKCS12.\n\nThe implementations of JKSFileLoader and PKCS12FileLoader were almost\nidentical so most of it were abstracted away in\nStandardTypeFileKeyStoreLoader.\n\nAuthor: Ivan Yurchenko <ivanyu@aiven.io>\n\nReviewers: eolivelli@apache.org.  andor@apache.org\n\nCloses #1003 from ivanyu/ZOOKEEPER-3443\n","date":"2019-07-15 20:46:48","modifiedFileCount":"8","status":"B","submitter":"Ivan Yurchenko"},{"authorTime":"2020-10-06 17:29:46","codes":[{"authorDate":"2020-10-06 17:29:46","commitOrder":2,"curCode":"    public File getTrustStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n        case JKS:\n            return getTrustStoreJksFile();\n        case PEM:\n            return getTrustStorePemFile();\n        case PKCS12:\n            return getTrustStorePkcs12File();\n        case BCFKS:\n            return getTrustStoreBcfksFile();\n            default:\n            throw new IllegalArgumentException(\"Invalid trust store type: \"\n                                                       + storeFileType\n                                                       + \", must be one of: \"\n                                                       + Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","date":"2020-10-06 17:29:46","endLine":173,"groupId":"10346","id":3,"instanceNumber":1,"isCurCommit":1,"methodName":"getTrustStoreFile","params":"(KeyStoreFileTypestoreFileType)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/32/380268c17169eebf41a2cf51cc38268b800d27.src","preCode":"    public File getTrustStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n        case JKS:\n            return getTrustStoreJksFile();\n        case PEM:\n            return getTrustStorePemFile();\n        case PKCS12:\n            return getTrustStorePkcs12File();\n        default:\n            throw new IllegalArgumentException(\"Invalid trust store type: \"\n                                                       + storeFileType\n                                                       + \", must be one of: \"\n                                                       + Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestContext.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":157,"status":"M"},{"authorDate":"2020-10-06 17:29:46","commitOrder":2,"curCode":"    public File getKeyStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n        case JKS:\n            return getKeyStoreJksFile();\n        case PEM:\n            return getKeyStorePemFile();\n        case PKCS12:\n            return getKeyStorePkcs12File();\n        case BCFKS:\n            return getKeyStoreBcfksFile();\n        default:\n            throw new IllegalArgumentException(\"Invalid key store type: \"\n                                                       + storeFileType\n                                                       + \", must be one of: \"\n                                                       + Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","date":"2020-10-06 17:29:46","endLine":281,"groupId":"10346","id":4,"instanceNumber":2,"isCurCommit":1,"methodName":"getKeyStoreFile","params":"(KeyStoreFileTypestoreFileType)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-zookeeper-10-0.7/blobInfo/CC_OUT/blobs/32/380268c17169eebf41a2cf51cc38268b800d27.src","preCode":"    public File getKeyStoreFile(KeyStoreFileType storeFileType) throws IOException {\n        switch (storeFileType) {\n        case JKS:\n            return getKeyStoreJksFile();\n        case PEM:\n            return getKeyStorePemFile();\n        case PKCS12:\n            return getKeyStorePkcs12File();\n        default:\n            throw new IllegalArgumentException(\"Invalid key store type: \"\n                                                       + storeFileType\n                                                       + \", must be one of: \"\n                                                       + Arrays.toString(KeyStoreFileType.values()));\n        }\n    }\n","realPath":"zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestContext.java","repoName":"zookeeper","snippetEndLine":0,"snippetStartLine":0,"startLine":265,"status":"M"}],"commitId":"ec1503bb00945471baa248f392eed51064bb48ab","commitMessage":"@@@ZOOKEEPER-3950: Add support for BCFKS key/trust store format\n\nThe BCFKS key store format is widely used in the industry.  as it provides an open source alternative if someone has to use FIPS compliant key stores due to some regulatory constraints.\n\nCurrently in the ZooKeeper java client.  only PEM.  JKS and PEM12 is supported. I extend the list of supported key store formats with BCFKS.\n\nI also tested this patch on a real FIPS compliant cluster.  having the appropriate java security configs.  security providers and also running a RedHat-based Linux distro (Centos 7.8) with FIPS mode enabled.\n\nI tested both the client and the quorum SSL too. If someone wants to test this patch.  and the keystore/truststore file names are not ending with \".bckfs\".  then (beside the usual SSL configs) make sure to also set the following parameters in the zoo.cfg:\n```\nssl.keyStore.type=bcfks\nssl.trustStore.type=bcfks\nssl.quorum.keyStore.type=bcfks\nssl.quorum.trustStore.type=bcfks\n```\n\nand also provide the following parameters for the command line java client:\n```\n -Dzookeeper.ssl.keyStore.type=bcfks -Dzookeeper.ssl.trustStore.type=bcfks\n```\n\nThis patch doesn't contain any modification for the c-client (that can be handled with a separate Jira.  but I don't plan to work on that part right now).\n\nAuthor: Mate Szalay-Beko <symat@apache.org>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>.  Norbert Kalmar <nkalmar@apache.org>.  Andor Molnar <andor@apache.org>\n\nCloses #1480 from symat/zookeeper-3950\n","date":"2020-10-06 17:29:46","modifiedFileCount":"9","status":"M","submitter":"Mate Szalay-Beko"}]
