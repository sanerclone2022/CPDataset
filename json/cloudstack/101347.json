[{"authorTime":"2020-10-26 21:24:14","codes":[{"authorDate":"2020-10-26 21:24:14","commitOrder":1,"curCode":"    private NetworkVO getDefaultNetwork(DataCenter zone, Account owner, boolean selectAny) throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n\n        List<NetworkOfferingVO> requiredOfferings = _networkOfferingDao.listByAvailability(Availability.Required, false);\n        if (requiredOfferings.size() < 1) {\n            throw new InvalidParameterValueException(\"Unable to find network offering with availability=\" + Availability.Required\n                    + \" to automatically create the network as a part of vm creation\");\n        }\n\n        if (requiredOfferings.get(0).getState() == NetworkOffering.State.Enabled) {\n            \r\n            List<? extends Network> virtualNetworks = _networkModel.listNetworksForAccount(owner.getId(), zone.getId(), Network.GuestType.Isolated);\n            if (virtualNetworks == null) {\n                throw new InvalidParameterValueException(\"No (virtual) networks are found for account \" + owner);\n            }\n            if (virtualNetworks.isEmpty()) {\n                defaultNetwork = createDefaultNetworkForAccount(zone, owner, requiredOfferings);\n            } else if (virtualNetworks.size() > 1 && !selectAny) {\n                throw new InvalidParameterValueException(\"More than 1 default Isolated networks are found for account \" + owner + \"; please specify networkIds\");\n            } else {\n                defaultNetwork = _networkDao.findById(virtualNetworks.get(0).getId());\n            }\n        } else {\n            throw new InvalidParameterValueException(\"Required network offering id=\" + requiredOfferings.get(0).getId() + \" is not in \" + NetworkOffering.State.Enabled);\n        }\n\n        return defaultNetwork;\n    }\n","date":"2020-10-26 21:24:14","endLine":3419,"groupId":"13019","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"getDefaultNetwork","params":"(DataCenterzone@Accountowner@booleanselectAny)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/a9/31159ea21125aa8851b37d78b52e71ba6eff61.src","preCode":"    private NetworkVO getDefaultNetwork(DataCenter zone, Account owner, boolean selectAny) throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n\n        List<NetworkOfferingVO> requiredOfferings = _networkOfferingDao.listByAvailability(Availability.Required, false);\n        if (requiredOfferings.size() < 1) {\n            throw new InvalidParameterValueException(\"Unable to find network offering with availability=\" + Availability.Required\n                    + \" to automatically create the network as a part of vm creation\");\n        }\n\n        if (requiredOfferings.get(0).getState() == NetworkOffering.State.Enabled) {\n            \r\n            List<? extends Network> virtualNetworks = _networkModel.listNetworksForAccount(owner.getId(), zone.getId(), Network.GuestType.Isolated);\n            if (virtualNetworks == null) {\n                throw new InvalidParameterValueException(\"No (virtual) networks are found for account \" + owner);\n            }\n            if (virtualNetworks.isEmpty()) {\n                defaultNetwork = createDefaultNetworkForAccount(zone, owner, requiredOfferings);\n            } else if (virtualNetworks.size() > 1 && !selectAny) {\n                throw new InvalidParameterValueException(\"More than 1 default Isolated networks are found for account \" + owner + \"; please specify networkIds\");\n            } else {\n                defaultNetwork = _networkDao.findById(virtualNetworks.get(0).getId());\n            }\n        } else {\n            throw new InvalidParameterValueException(\"Required network offering id=\" + requiredOfferings.get(0).getId() + \" is not in \" + NetworkOffering.State.Enabled);\n        }\n\n        return defaultNetwork;\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":3384,"status":"B"},{"authorDate":"2020-10-26 21:24:14","commitOrder":1,"curCode":"    private NetworkVO createDefaultNetworkForAccount(DataCenter zone, Account owner, List<NetworkOfferingVO> requiredOfferings)\n            throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n        long physicalNetworkId = _networkModel.findPhysicalNetworkId(zone.getId(), requiredOfferings.get(0).getTags(), requiredOfferings.get(0).getTrafficType());\n        \r\n        PhysicalNetwork physicalNetwork = _physicalNetworkDao.findById(physicalNetworkId);\n        if (physicalNetwork == null) {\n            throw new InvalidParameterValueException(\"Unable to find physical network with id: \" + physicalNetworkId + \" and tag: \"\n                    + requiredOfferings.get(0).getTags());\n        }\n        s_logger.debug(\"Creating network for account \" + owner + \" from the network offering id=\" + requiredOfferings.get(0).getId() + \" as a part of deployVM process\");\n        Network newNetwork = _networkMgr.createGuestNetwork(requiredOfferings.get(0).getId(), owner.getAccountName() + \"-network\", owner.getAccountName() + \"-network\",\n                null, null, null, false, null, owner, null, physicalNetwork, zone.getId(), ACLType.Account, null, null, null, null, true, null, null,\n                null);\n        if (newNetwork != null) {\n            defaultNetwork = _networkDao.findById(newNetwork.getId());\n        }\n        return defaultNetwork;\n    }\n","date":"2020-10-26 21:24:14","endLine":3439,"groupId":"4158","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"createDefaultNetworkForAccount","params":"(DataCenterzone@Accountowner@List<NetworkOfferingVO>requiredOfferings)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/a9/31159ea21125aa8851b37d78b52e71ba6eff61.src","preCode":"    private NetworkVO createDefaultNetworkForAccount(DataCenter zone, Account owner, List<NetworkOfferingVO> requiredOfferings)\n            throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n        long physicalNetworkId = _networkModel.findPhysicalNetworkId(zone.getId(), requiredOfferings.get(0).getTags(), requiredOfferings.get(0).getTrafficType());\n        \r\n        PhysicalNetwork physicalNetwork = _physicalNetworkDao.findById(physicalNetworkId);\n        if (physicalNetwork == null) {\n            throw new InvalidParameterValueException(\"Unable to find physical network with id: \" + physicalNetworkId + \" and tag: \"\n                    + requiredOfferings.get(0).getTags());\n        }\n        s_logger.debug(\"Creating network for account \" + owner + \" from the network offering id=\" + requiredOfferings.get(0).getId() + \" as a part of deployVM process\");\n        Network newNetwork = _networkMgr.createGuestNetwork(requiredOfferings.get(0).getId(), owner.getAccountName() + \"-network\", owner.getAccountName() + \"-network\",\n                null, null, null, false, null, owner, null, physicalNetwork, zone.getId(), ACLType.Account, null, null, null, null, true, null, null,\n                null);\n        if (newNetwork != null) {\n            defaultNetwork = _networkDao.findById(newNetwork.getId());\n        }\n        return defaultNetwork;\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":3421,"status":"B"}],"commitId":"1a75872cd484dd387552bae58996a56679fdb51e","commitMessage":"@@@Merge pull request #4307 from shapeblue/ovfprops-and-vsphere-adv-together\n\n[VMware] vSphere advanced capabilities and Full OVF properties support","date":"2020-10-26 21:24:14","modifiedFileCount":"173","status":"B","submitter":"Boris Stoyanov - a.k.a Bobby"},{"authorTime":"2021-02-18 16:24:09","codes":[{"authorDate":"2020-10-26 21:24:14","commitOrder":2,"curCode":"    private NetworkVO getDefaultNetwork(DataCenter zone, Account owner, boolean selectAny) throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n\n        List<NetworkOfferingVO> requiredOfferings = _networkOfferingDao.listByAvailability(Availability.Required, false);\n        if (requiredOfferings.size() < 1) {\n            throw new InvalidParameterValueException(\"Unable to find network offering with availability=\" + Availability.Required\n                    + \" to automatically create the network as a part of vm creation\");\n        }\n\n        if (requiredOfferings.get(0).getState() == NetworkOffering.State.Enabled) {\n            \r\n            List<? extends Network> virtualNetworks = _networkModel.listNetworksForAccount(owner.getId(), zone.getId(), Network.GuestType.Isolated);\n            if (virtualNetworks == null) {\n                throw new InvalidParameterValueException(\"No (virtual) networks are found for account \" + owner);\n            }\n            if (virtualNetworks.isEmpty()) {\n                defaultNetwork = createDefaultNetworkForAccount(zone, owner, requiredOfferings);\n            } else if (virtualNetworks.size() > 1 && !selectAny) {\n                throw new InvalidParameterValueException(\"More than 1 default Isolated networks are found for account \" + owner + \"; please specify networkIds\");\n            } else {\n                defaultNetwork = _networkDao.findById(virtualNetworks.get(0).getId());\n            }\n        } else {\n            throw new InvalidParameterValueException(\"Required network offering id=\" + requiredOfferings.get(0).getId() + \" is not in \" + NetworkOffering.State.Enabled);\n        }\n\n        return defaultNetwork;\n    }\n","date":"2020-10-26 21:24:14","endLine":3419,"groupId":"101347","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"getDefaultNetwork","params":"(DataCenterzone@Accountowner@booleanselectAny)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/a9/31159ea21125aa8851b37d78b52e71ba6eff61.src","preCode":"    private NetworkVO getDefaultNetwork(DataCenter zone, Account owner, boolean selectAny) throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n\n        List<NetworkOfferingVO> requiredOfferings = _networkOfferingDao.listByAvailability(Availability.Required, false);\n        if (requiredOfferings.size() < 1) {\n            throw new InvalidParameterValueException(\"Unable to find network offering with availability=\" + Availability.Required\n                    + \" to automatically create the network as a part of vm creation\");\n        }\n\n        if (requiredOfferings.get(0).getState() == NetworkOffering.State.Enabled) {\n            \r\n            List<? extends Network> virtualNetworks = _networkModel.listNetworksForAccount(owner.getId(), zone.getId(), Network.GuestType.Isolated);\n            if (virtualNetworks == null) {\n                throw new InvalidParameterValueException(\"No (virtual) networks are found for account \" + owner);\n            }\n            if (virtualNetworks.isEmpty()) {\n                defaultNetwork = createDefaultNetworkForAccount(zone, owner, requiredOfferings);\n            } else if (virtualNetworks.size() > 1 && !selectAny) {\n                throw new InvalidParameterValueException(\"More than 1 default Isolated networks are found for account \" + owner + \"; please specify networkIds\");\n            } else {\n                defaultNetwork = _networkDao.findById(virtualNetworks.get(0).getId());\n            }\n        } else {\n            throw new InvalidParameterValueException(\"Required network offering id=\" + requiredOfferings.get(0).getId() + \" is not in \" + NetworkOffering.State.Enabled);\n        }\n\n        return defaultNetwork;\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":3384,"status":"N"},{"authorDate":"2021-02-18 16:24:09","commitOrder":2,"curCode":"    private NetworkVO createDefaultNetworkForAccount(DataCenter zone, Account owner, List<NetworkOfferingVO> requiredOfferings)\n            throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n        long physicalNetworkId = _networkModel.findPhysicalNetworkId(zone.getId(), requiredOfferings.get(0).getTags(), requiredOfferings.get(0).getTrafficType());\n        \r\n        PhysicalNetwork physicalNetwork = _physicalNetworkDao.findById(physicalNetworkId);\n        if (physicalNetwork == null) {\n            throw new InvalidParameterValueException(\"Unable to find physical network with id: \" + physicalNetworkId + \" and tag: \"\n                    + requiredOfferings.get(0).getTags());\n        }\n        s_logger.debug(\"Creating network for account \" + owner + \" from the network offering id=\" + requiredOfferings.get(0).getId() + \" as a part of deployVM process\");\n        Network newNetwork = _networkMgr.createGuestNetwork(requiredOfferings.get(0).getId(), owner.getAccountName() + \"-network\", owner.getAccountName() + \"-network\",\n                null, null, null, false, null, owner, null, physicalNetwork, zone.getId(), ACLType.Account, null, null, null, null, true, null, null,\n                null, null, null);\n        if (newNetwork != null) {\n            defaultNetwork = _networkDao.findById(newNetwork.getId());\n        }\n        return defaultNetwork;\n    }\n","date":"2021-02-18 16:24:09","endLine":3496,"groupId":"101347","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"createDefaultNetworkForAccount","params":"(DataCenterzone@Accountowner@List<NetworkOfferingVO>requiredOfferings)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/8a/363c296b70ac7c43224932594923f02202ac69.src","preCode":"    private NetworkVO createDefaultNetworkForAccount(DataCenter zone, Account owner, List<NetworkOfferingVO> requiredOfferings)\n            throws InsufficientCapacityException, ResourceAllocationException {\n        NetworkVO defaultNetwork = null;\n        long physicalNetworkId = _networkModel.findPhysicalNetworkId(zone.getId(), requiredOfferings.get(0).getTags(), requiredOfferings.get(0).getTrafficType());\n        \r\n        PhysicalNetwork physicalNetwork = _physicalNetworkDao.findById(physicalNetworkId);\n        if (physicalNetwork == null) {\n            throw new InvalidParameterValueException(\"Unable to find physical network with id: \" + physicalNetworkId + \" and tag: \"\n                    + requiredOfferings.get(0).getTags());\n        }\n        s_logger.debug(\"Creating network for account \" + owner + \" from the network offering id=\" + requiredOfferings.get(0).getId() + \" as a part of deployVM process\");\n        Network newNetwork = _networkMgr.createGuestNetwork(requiredOfferings.get(0).getId(), owner.getAccountName() + \"-network\", owner.getAccountName() + \"-network\",\n                null, null, null, false, null, owner, null, physicalNetwork, zone.getId(), ACLType.Account, null, null, null, null, true, null, null,\n                null);\n        if (newNetwork != null) {\n            defaultNetwork = _networkDao.findById(newNetwork.getId());\n        }\n        return defaultNetwork;\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":3478,"status":"M"}],"commitId":"aa01580381c931512d62edbc658865f776ce2efa","commitMessage":"@@@network: Specify IP for VR in shared networks (#4503)\n\nThis PR enables admins to specify IP for a VR in a shared network.","date":"2021-02-18 16:24:09","modifiedFileCount":"16","status":"M","submitter":"Pearl Dsilva"}]
