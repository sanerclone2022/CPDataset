[{"authorTime":"2019-08-09 18:44:46","codes":[{"authorDate":"2019-08-09 18:44:46","commitOrder":1,"curCode":"    protected List<VAppPropertySpec> copyVAppConfigPropertySectionFromOVF(VmConfigInfo vAppConfig, List<OVFPropertyTO> ovfProperties) {\n        List<VAppPropertyInfo> productFromOvf = vAppConfig.getProperty();\n        List<VAppPropertySpec> specs = new ArrayList<>();\n        Map<String, Pair<String, Boolean>> ovfMap = getOVFMap(ovfProperties);\n        for (VAppPropertyInfo info : productFromOvf) {\n            VAppPropertySpec spec = new VAppPropertySpec();\n            if (ovfMap.containsKey(info.getId())) {\n                Pair<String, Boolean> pair = ovfMap.get(info.getId());\n                String value = pair.first();\n                boolean isPassword = pair.second();\n                info.setValue(isPassword ? DBEncryptionUtil.decrypt(value) : value);\n            }\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","date":"2019-08-09 18:44:46","endLine":2394,"groupId":"20283","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"copyVAppConfigPropertySectionFromOVF","params":"(VmConfigInfovAppConfig@List<OVFPropertyTO>ovfProperties)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/02/f758ba844bbc855a85c7c0254587772f0da0aa.src","preCode":"    protected List<VAppPropertySpec> copyVAppConfigPropertySectionFromOVF(VmConfigInfo vAppConfig, List<OVFPropertyTO> ovfProperties) {\n        List<VAppPropertyInfo> productFromOvf = vAppConfig.getProperty();\n        List<VAppPropertySpec> specs = new ArrayList<>();\n        Map<String, Pair<String, Boolean>> ovfMap = getOVFMap(ovfProperties);\n        for (VAppPropertyInfo info : productFromOvf) {\n            VAppPropertySpec spec = new VAppPropertySpec();\n            if (ovfMap.containsKey(info.getId())) {\n                Pair<String, Boolean> pair = ovfMap.get(info.getId());\n                String value = pair.first();\n                boolean isPassword = pair.second();\n                info.setValue(isPassword ? DBEncryptionUtil.decrypt(value) : value);\n            }\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","realPath":"plugins/hypervisors/vmware/src/main/java/com/cloud/hypervisor/vmware/resource/VmwareResource.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2377,"status":"B"},{"authorDate":"2019-08-09 18:44:46","commitOrder":1,"curCode":"    protected List<VAppProductSpec> copyVAppConfigProductSectionFromOVF(VmConfigInfo vAppConfig) {\n        List<VAppProductInfo> productFromOvf = vAppConfig.getProduct();\n        List<VAppProductSpec> specs = new ArrayList<>();\n        for (VAppProductInfo info : productFromOvf) {\n            VAppProductSpec spec = new VAppProductSpec();\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","date":"2019-08-09 18:44:46","endLine":2409,"groupId":"13514","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"copyVAppConfigProductSectionFromOVF","params":"(VmConfigInfovAppConfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/02/f758ba844bbc855a85c7c0254587772f0da0aa.src","preCode":"    protected List<VAppProductSpec> copyVAppConfigProductSectionFromOVF(VmConfigInfo vAppConfig) {\n        List<VAppProductInfo> productFromOvf = vAppConfig.getProduct();\n        List<VAppProductSpec> specs = new ArrayList<>();\n        for (VAppProductInfo info : productFromOvf) {\n            VAppProductSpec spec = new VAppProductSpec();\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","realPath":"plugins/hypervisors/vmware/src/main/java/com/cloud/hypervisor/vmware/resource/VmwareResource.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2399,"status":"B"}],"commitId":"3c2af55d81dbfaf17a3bf0b6247ecd830df12996","commitMessage":"@@@vmware: allow configuring appliances on the VM instance wizard when OVF properties are available (#3271)\n\nProblem: In Vmware.  appliances that have options that are required to be answered before deployments are configurable through vSphere vCenter user interface but it is not possible from the CloudStack user interface.\n\nRoot cause: CloudStack does not handle vApp configuration options during deployments if the appliance contains configurable options. These configurations are mandatory for VM deployment from the appliance on Vmware vSphere vCenter. As shown in the image below.  Vmware detects there are mandatory configurations that the administrator must set before deploy the VM from the appliance (in red on the image below):\n\nSolution:\nOn template registration.  after it is downloaded to secondary storage.  the OVF file is examined and OVF properties are extracted from the file when available.\nOVF properties extracted from templates after being downloaded to secondary storage are stored on the new table 'template_ovf_properties'.\nA new optional section is added to the VM deployment wizard in the UI:\nIf the selected template does not contain OVF properties.  then the optional section is not displayed on the wizard.\nIf the selected template contains OVF properties.  then the optional new section is displayed. Each OVF property is displayed and the user must complete every property before proceeding to the next section.\nIf any configuration property is empty.  then a dialog is displayed indicating that there are empty properties which must be set before proceeding\nimage\nThe specific OVF properties set on deployment are stored on the 'user_vm_details' table with the prefix: 'ovfproperties-'.\nThe VM is configured with the vApp configuration section containing the values that the user provided on the wizard.","date":"2019-08-09 18:44:46","modifiedFileCount":"26","status":"B","submitter":"Nicolas Vazquez"},{"authorTime":"2019-08-09 18:44:46","codes":[{"authorDate":"2020-10-26 21:24:14","commitOrder":2,"curCode":"    protected List<VAppPropertySpec> copyVAppConfigPropertySectionFromOVF(VmConfigInfo vAppConfig, Map<String, String> ovfProperties) {\n        List<VAppPropertyInfo> productFromOvf = vAppConfig.getProperty();\n        List<VAppPropertySpec> specs = new ArrayList<>();\n        for (VAppPropertyInfo info : productFromOvf) {\n            VAppPropertySpec spec = new VAppPropertySpec();\n            if (ovfProperties.containsKey(info.getId())) {\n                String value = ovfProperties.get(info.getId());\n                info.setValue(value);\n            }\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","date":"2020-10-26 21:24:14","endLine":2705,"groupId":"13515","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"copyVAppConfigPropertySectionFromOVF","params":"(VmConfigInfovAppConfig@Map<String@String>ovfProperties)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/a3/da897b250b5d6c1af9671c04f85ff59e0d0c65.src","preCode":"    protected List<VAppPropertySpec> copyVAppConfigPropertySectionFromOVF(VmConfigInfo vAppConfig, List<OVFPropertyTO> ovfProperties) {\n        List<VAppPropertyInfo> productFromOvf = vAppConfig.getProperty();\n        List<VAppPropertySpec> specs = new ArrayList<>();\n        Map<String, Pair<String, Boolean>> ovfMap = getOVFMap(ovfProperties);\n        for (VAppPropertyInfo info : productFromOvf) {\n            VAppPropertySpec spec = new VAppPropertySpec();\n            if (ovfMap.containsKey(info.getId())) {\n                Pair<String, Boolean> pair = ovfMap.get(info.getId());\n                String value = pair.first();\n                boolean isPassword = pair.second();\n                info.setValue(isPassword ? DBEncryptionUtil.decrypt(value) : value);\n            }\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","realPath":"plugins/hypervisors/vmware/src/main/java/com/cloud/hypervisor/vmware/resource/VmwareResource.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2691,"status":"M"},{"authorDate":"2019-08-09 18:44:46","commitOrder":2,"curCode":"    protected List<VAppProductSpec> copyVAppConfigProductSectionFromOVF(VmConfigInfo vAppConfig) {\n        List<VAppProductInfo> productFromOvf = vAppConfig.getProduct();\n        List<VAppProductSpec> specs = new ArrayList<>();\n        for (VAppProductInfo info : productFromOvf) {\n            VAppProductSpec spec = new VAppProductSpec();\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","date":"2019-08-09 18:44:46","endLine":2409,"groupId":"13514","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"copyVAppConfigProductSectionFromOVF","params":"(VmConfigInfovAppConfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/02/f758ba844bbc855a85c7c0254587772f0da0aa.src","preCode":"    protected List<VAppProductSpec> copyVAppConfigProductSectionFromOVF(VmConfigInfo vAppConfig) {\n        List<VAppProductInfo> productFromOvf = vAppConfig.getProduct();\n        List<VAppProductSpec> specs = new ArrayList<>();\n        for (VAppProductInfo info : productFromOvf) {\n            VAppProductSpec spec = new VAppProductSpec();\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","realPath":"plugins/hypervisors/vmware/src/main/java/com/cloud/hypervisor/vmware/resource/VmwareResource.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2399,"status":"N"}],"commitId":"1a75872cd484dd387552bae58996a56679fdb51e","commitMessage":"@@@Merge pull request #4307 from shapeblue/ovfprops-and-vsphere-adv-together\n\n[VMware] vSphere advanced capabilities and Full OVF properties support","date":"2020-10-26 21:24:14","modifiedFileCount":"173","status":"M","submitter":"Boris Stoyanov - a.k.a Bobby"},{"authorTime":"2021-04-13 02:40:17","codes":[{"authorDate":"2021-04-13 02:40:17","commitOrder":3,"curCode":"    protected List<VAppPropertySpec> copyVAppConfigPropertySectionFromOVF(VmConfigInfo vAppConfig, Map<String, String> ovfProperties,\n                                                                          boolean useEdit) {\n        List<VAppPropertyInfo> productFromOvf = vAppConfig.getProperty();\n        List<VAppPropertySpec> specs = new ArrayList<>();\n        for (VAppPropertyInfo info : productFromOvf) {\n            VAppPropertySpec spec = new VAppPropertySpec();\n            if (ovfProperties.containsKey(info.getId())) {\n                String value = ovfProperties.get(info.getId());\n                info.setValue(value);\n                s_logger.info(\"Setting OVF property ID = \" + info.getId() + \" VALUE = \" + value);\n            }\n            spec.setInfo(info);\n            spec.setOperation(useEdit ? ArrayUpdateOperation.EDIT : ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","date":"2021-04-13 02:40:17","endLine":2733,"groupId":"102981","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"copyVAppConfigPropertySectionFromOVF","params":"(VmConfigInfovAppConfig@Map<String@String>ovfProperties@booleanuseEdit)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/af/c2acc253d78d8fa8053ddee243e68d10a65303.src","preCode":"    protected List<VAppPropertySpec> copyVAppConfigPropertySectionFromOVF(VmConfigInfo vAppConfig, Map<String, String> ovfProperties) {\n        List<VAppPropertyInfo> productFromOvf = vAppConfig.getProperty();\n        List<VAppPropertySpec> specs = new ArrayList<>();\n        for (VAppPropertyInfo info : productFromOvf) {\n            VAppPropertySpec spec = new VAppPropertySpec();\n            if (ovfProperties.containsKey(info.getId())) {\n                String value = ovfProperties.get(info.getId());\n                info.setValue(value);\n            }\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","realPath":"plugins/hypervisors/vmware/src/main/java/com/cloud/hypervisor/vmware/resource/VmwareResource.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2717,"status":"M"},{"authorDate":"2021-04-13 02:40:17","commitOrder":3,"curCode":"    protected List<VAppProductSpec> copyVAppConfigProductSectionFromOVF(VmConfigInfo vAppConfig, boolean useEdit) {\n        List<VAppProductInfo> productFromOvf = vAppConfig.getProduct();\n        List<VAppProductSpec> specs = new ArrayList<>();\n        for (VAppProductInfo info : productFromOvf) {\n            VAppProductSpec spec = new VAppProductSpec();\n            spec.setInfo(info);\n            s_logger.info(\"Procuct info KEY \" + info.getKey());\n            spec.setOperation(useEdit ? ArrayUpdateOperation.EDIT : ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","date":"2021-04-13 02:40:17","endLine":2749,"groupId":"102981","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"copyVAppConfigProductSectionFromOVF","params":"(VmConfigInfovAppConfig@booleanuseEdit)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/af/c2acc253d78d8fa8053ddee243e68d10a65303.src","preCode":"    protected List<VAppProductSpec> copyVAppConfigProductSectionFromOVF(VmConfigInfo vAppConfig) {\n        List<VAppProductInfo> productFromOvf = vAppConfig.getProduct();\n        List<VAppProductSpec> specs = new ArrayList<>();\n        for (VAppProductInfo info : productFromOvf) {\n            VAppProductSpec spec = new VAppProductSpec();\n            spec.setInfo(info);\n            spec.setOperation(ArrayUpdateOperation.ADD);\n            specs.add(spec);\n        }\n        return specs;\n    }\n","realPath":"plugins/hypervisors/vmware/src/main/java/com/cloud/hypervisor/vmware/resource/VmwareResource.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2738,"status":"M"}],"commitId":"8fd9150a89717688ce8f52f0fbd3dc2452d797ca","commitMessage":"@@@Merge remote-tracking branch 'origin/4.15'\n","date":"2021-04-13 02:40:17","modifiedFileCount":"1","status":"M","submitter":"Rohit Yadav"}]
