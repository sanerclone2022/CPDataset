[{"authorTime":"2018-01-20 05:49:27","codes":[{"authorDate":"2018-01-20 05:49:27","commitOrder":1,"curCode":"    public List<HostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<HostVO> hostSearch = createSearchBuilder();\n        HostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<HostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","date":"2018-01-20 05:49:27","endLine":719,"groupId":"4412","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"listByHostTag","params":"(Host.Typetype@LongclusterId@LongpodId@longdcId@StringhostTag)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/c1/403d0860918b7b1b968dce77757d1b8304d887.src","preCode":"    public List<HostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<HostVO> hostSearch = createSearchBuilder();\n        HostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<HostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","realPath":"engine/schema/src/main/java/com/cloud/host/dao/HostDaoImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":689,"status":"B"},{"authorDate":"2018-01-20 05:49:27","commitOrder":1,"curCode":"    public List<EngineHostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<EngineHostVO> hostSearch = createSearchBuilder();\n        EngineHostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<EngineHostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","date":"2018-01-20 05:49:27","endLine":341,"groupId":"4412","id":2,"instanceNumber":2,"isCurCommit":1,"methodName":"listByHostTag","params":"(Host.Typetype@LongclusterId@LongpodId@longdcId@StringhostTag)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/81/9bd32146edffe8c3546d7a6ea570e91fb96763.src","preCode":"    public List<EngineHostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<EngineHostVO> hostSearch = createSearchBuilder();\n        EngineHostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<EngineHostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","realPath":"engine/orchestration/src/main/java/org/apache/cloudstack/engine/datacenter/entity/api/db/dao/EngineHostDaoImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":311,"status":"B"}],"commitId":"893a88d225276e45f12f9490e6af2c94a81c2965","commitMessage":"@@@CLOUDSTACK-10105: Use maven standard project structure in all projects (#2283)\n\nRemove maven standard module (which only a few were using) and get ride of maven customization for the projects structure.\n\n- moved all directories to src/main/java.  src/main/resources.  src/main/scripts.  src/test/java.  src/test/resources\n- grep scan to search for src/com and src/org left over\n- grep for <project>/scripts to fix pom.xml configuration\n- remove custom <build> configuration in pom.xml\n\nSigned-off-by: Marc-Aur?le Brothier <m@brothier.org>","date":"2018-01-20 05:49:27","modifiedFileCount":"1","status":"B","submitter":"Marc-Aur?le Brothier"},{"authorTime":"2018-01-20 05:49:27","codes":[{"authorDate":"2021-08-16 23:08:40","commitOrder":2,"curCode":"    public List<HostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n        SearchBuilder<HostVO> hostSearch = createSearchBuilder();\n        HostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n\n        SearchCriteria<HostVO> sc = hostSearch.create();\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        List<HostVO> tmpHosts = listBy(sc);\n        List<HostVO> correctHostsByHostTags = new ArrayList();\n        List<Long> hostIdsByComputeOffTags = findHostByComputeOfferings(hostTag);\n\n        tmpHosts.forEach((host) -> { if(hostIdsByComputeOffTags.contains(host.getId())) correctHostsByHostTags.add(host);});\n\n        return correctHostsByHostTags;\n    }\n","date":"2021-08-16 23:08:40","endLine":775,"groupId":"10361","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"listByHostTag","params":"(Host.Typetype@LongclusterId@LongpodId@longdcId@StringhostTag)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/58/248adc4f4d63f3fefcbdd642cd9e510bb1c652.src","preCode":"    public List<HostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<HostVO> hostSearch = createSearchBuilder();\n        HostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<HostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","realPath":"engine/schema/src/main/java/com/cloud/host/dao/HostDaoImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":746,"status":"M"},{"authorDate":"2018-01-20 05:49:27","commitOrder":2,"curCode":"    public List<EngineHostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<EngineHostVO> hostSearch = createSearchBuilder();\n        EngineHostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<EngineHostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","date":"2018-01-20 05:49:27","endLine":341,"groupId":"10361","id":4,"instanceNumber":2,"isCurCommit":1,"methodName":"listByHostTag","params":"(Host.Typetype@LongclusterId@LongpodId@longdcId@StringhostTag)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/81/9bd32146edffe8c3546d7a6ea570e91fb96763.src","preCode":"    public List<EngineHostVO> listByHostTag(Host.Type type, Long clusterId, Long podId, long dcId, String hostTag) {\n\n        SearchBuilder<HostTagVO> hostTagSearch = _hostTagsDao.createSearchBuilder();\n        HostTagVO tagEntity = hostTagSearch.entity();\n        hostTagSearch.and(\"tag\", tagEntity.getTag(), SearchCriteria.Op.EQ);\n\n        SearchBuilder<EngineHostVO> hostSearch = createSearchBuilder();\n        EngineHostVO entity = hostSearch.entity();\n        hostSearch.and(\"type\", entity.getType(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"pod\", entity.getPodId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"dc\", entity.getDataCenterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"cluster\", entity.getClusterId(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"status\", entity.getStatus(), SearchCriteria.Op.EQ);\n        hostSearch.and(\"resourceState\", entity.getResourceState(), SearchCriteria.Op.EQ);\n        hostSearch.join(\"hostTagSearch\", hostTagSearch, entity.getId(), tagEntity.getHostId(), JoinBuilder.JoinType.INNER);\n\n        SearchCriteria<EngineHostVO> sc = hostSearch.create();\n        sc.setJoinParameters(\"hostTagSearch\", \"tag\", hostTag);\n        sc.setParameters(\"type\", type.toString());\n        if (podId != null) {\n            sc.setParameters(\"pod\", podId);\n        }\n        if (clusterId != null) {\n            sc.setParameters(\"cluster\", clusterId);\n        }\n        sc.setParameters(\"dc\", dcId);\n        sc.setParameters(\"status\", Status.Up.toString());\n        sc.setParameters(\"resourceState\", ResourceState.Enabled.toString());\n\n        return listBy(sc);\n    }\n","realPath":"engine/orchestration/src/main/java/org/apache/cloudstack/engine/datacenter/entity/api/db/dao/EngineHostDaoImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":311,"status":"N"}],"commitId":"664a46a525847feeef2500c292c8f9e2a47337de","commitMessage":"@@@PR multi tags in compute offering [#4398] (#4399)\n\n* [#4398] adapt code to handle multi tag string with commas\n\n* [#4398] remove trailing spaces\n\n* [#4398] add multi host tag support for ingest process\n\n* [#4398] add test for multi tag support in offerings\n\n* [#4398]  update multitag support for DeploymentPlanningManagerImpl\n\nencapsulate multi tag check from Ingest Feature.  DepolymentPlanningManager into\nHostDaoImpl to prevent code duplicates\n\n* [#4398] move logic to HostVO and add tests\n\n* rename test method\n\n* [#4398] Change string method to apaches StringUtils\n\n* [#4398] modify test for multi tag support\n\n* adapt sql for double tags\n\nCo-authored-by: Dirk Klahre <Dirk.Klahre@Itelligence.de>","date":"2021-08-16 23:08:40","modifiedFileCount":"5","status":"M","submitter":"DK101010"}]
