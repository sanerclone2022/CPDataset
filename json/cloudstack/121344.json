[{"authorTime":"2018-01-20 05:49:27","codes":[{"authorDate":"2018-04-12 15:48:59","commitOrder":2,"curCode":"    public boolean deleteVmGroup(long groupId) {\n        \r\n        List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByGroupId(groupId);\n        for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n            SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n            sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n            _groupVMMapDao.expunge(sc);\n        }\n\n        if (_vmGroupDao.remove(groupId)) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n","date":"2018-04-12 15:48:59","endLine":2825,"groupId":"3146","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"deleteVmGroup","params":"(longgroupId)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/df/81dd3ff2bd18293da506fdeef1099bdaccb2b8.src","preCode":"    public boolean deleteVmGroup(long groupId) {\n        \r\n        List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByGroupId(groupId);\n        for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n            SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n            sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n            _groupVMMapDao.expunge(sc);\n        }\n\n        if (_vmGroupDao.remove(groupId)) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2811,"status":"B"},{"authorDate":"2018-01-20 05:49:27","commitOrder":2,"curCode":"    public void removeInstanceFromInstanceGroup(long vmId) {\n        try {\n            List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByInstanceId(vmId);\n            for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n                SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n                sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n                _groupVMMapDao.expunge(sc);\n            }\n        } catch (Exception e) {\n            s_logger.warn(\"Error trying to remove vm from group: \", e);\n        }\n    }\n","date":"2018-01-20 05:49:27","endLine":2953,"groupId":"3146","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"removeInstanceFromInstanceGroup","params":"(longvmId)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/da/b741c3c274ded6ea2d8ba461cb81d920542cb3.src","preCode":"    public void removeInstanceFromInstanceGroup(long vmId) {\n        try {\n            List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByInstanceId(vmId);\n            for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n                SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n                sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n                _groupVMMapDao.expunge(sc);\n            }\n        } catch (Exception e) {\n            s_logger.warn(\"Error trying to remove vm from group: \", e);\n        }\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2942,"status":"NB"}],"commitId":"91d98211496a482e6882acd6528f9b8dbeefe3bf","commitMessage":"@@@[CLOUDSTACK-10230] User should not be able to use removed ?Guest OS type? (#2404)\n\n* [CLOUDSTACK-10230] User is able to change to ?Guest OS type? that has been removed\n\nUsers are able to change the OS type of VMs to ?Guest OS type? that has been removed. This becomes a security issue when we try to force users to use HVM VMs (Meltdown/Spectre thing). A removed ?guest os type? should not be usable by any users in the cloud.","date":"2018-04-12 15:48:59","modifiedFileCount":"2","status":"M","submitter":"Rafael Weing?rtner"},{"authorTime":"2018-01-20 05:49:27","codes":[{"authorDate":"2021-09-08 12:44:06","commitOrder":3,"curCode":"    public boolean deleteVmGroup(long groupId) {\n        InstanceGroupVO group = _vmGroupDao.findById(groupId);\n        annotationDao.removeByEntityType(AnnotationService.EntityType.INSTANCE_GROUP.name(), group.getUuid());\n        \r\n        List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByGroupId(groupId);\n        for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n            SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n            sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n            _groupVMMapDao.expunge(sc);\n        }\n\n        if (_vmGroupDao.remove(groupId)) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n","date":"2021-09-08 12:44:06","endLine":3176,"groupId":"121344","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"deleteVmGroup","params":"(longgroupId)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/d3/a67a08865c4349210d00d9ee90c4b1c763c7b1.src","preCode":"    public boolean deleteVmGroup(long groupId) {\n        \r\n        List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByGroupId(groupId);\n        for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n            SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n            sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n            _groupVMMapDao.expunge(sc);\n        }\n\n        if (_vmGroupDao.remove(groupId)) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":3160,"status":"M"},{"authorDate":"2018-01-20 05:49:27","commitOrder":3,"curCode":"    public void removeInstanceFromInstanceGroup(long vmId) {\n        try {\n            List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByInstanceId(vmId);\n            for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n                SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n                sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n                _groupVMMapDao.expunge(sc);\n            }\n        } catch (Exception e) {\n            s_logger.warn(\"Error trying to remove vm from group: \", e);\n        }\n    }\n","date":"2018-01-20 05:49:27","endLine":2953,"groupId":"121344","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"removeInstanceFromInstanceGroup","params":"(longvmId)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cloudstack-10-0.7/blobInfo/CC_OUT/blobs/da/b741c3c274ded6ea2d8ba461cb81d920542cb3.src","preCode":"    public void removeInstanceFromInstanceGroup(long vmId) {\n        try {\n            List<InstanceGroupVMMapVO> groupVmMaps = _groupVMMapDao.listByInstanceId(vmId);\n            for (InstanceGroupVMMapVO groupMap : groupVmMaps) {\n                SearchCriteria<InstanceGroupVMMapVO> sc = _groupVMMapDao.createSearchCriteria();\n                sc.addAnd(\"instanceId\", SearchCriteria.Op.EQ, groupMap.getInstanceId());\n                _groupVMMapDao.expunge(sc);\n            }\n        } catch (Exception e) {\n            s_logger.warn(\"Error trying to remove vm from group: \", e);\n        }\n    }\n","realPath":"server/src/main/java/com/cloud/vm/UserVmManagerImpl.java","repoName":"cloudstack","snippetEndLine":0,"snippetStartLine":0,"startLine":2942,"status":"N"}],"commitId":"413d10dd8106af9b3c369c1a393fbcca5e7217ce","commitMessage":"@@@server: Extend the Annotations framework (#5103)\n\n* Extend addAnnotation and listAnnotations APIs\n\n* Allow users to add.  list and remove comments\n\n* Add adminsonly UI and allow admins or owners to remove comments\n\n* New annotations tab\n\n* In progress: new comments section\n\n* Address review comments\n\n* Fix\n\n* Fix annotationfilter and comments section\n\n* Add keyword and delete action\n\n* Fix and rename annotations tab\n\n* Update annotation visibility API and update comments table accordingly\n\n* Allow users seeing all the comments for their owned resources\n\n* Extend comments for volumes and snapshots\n\n* Extend comments to multiple entities\n\n* Add uuid to ssh keypairs\n\n* SSH keypair UI refactor\n\n* Extend comments to the infrastructure entities\n\n* Add missing entities\n\n* Fix upgrade version for ssh keypairs\n\n* Fix typo on DB upgrade schema\n\n* Fix annotations table columns when there is no data\n\n* Extend the list view of items showing they if they have comments\n\n* Remove extra test\n\n* Add annotation permissions\n\n* Address review comments\n\n* Extend marvin tests for annotations\n\n* updating ui stuff\n\n* addition to toggle visibility\n\n* Fix pagination on comments section\n\n* Extend to kubernetes clusters\n\n* Fixes after last review\n\n* Change default value for adminsonly column\n\n* Remove the required field for the annotationfilter parameter\n\n* Small fixes on visibility and other fixes\n\n* Cleanup to reduce files changed\n\n* Rollback extra line\n\n* Address review comments\n\n* Fix cleanup error on smoke test\n\n* Fix sending incorrect parameter to checkPermissions method\n\n* Add check domain access for the calling account for domain networks\n\n* Fix only display annotations icon if there are comments the user can see\n\n* Simply change the Save button label to Submit\n\n* Change order of the Tools menu to provent users getting 404 error on clicking the text instead of expanding\n\n* Remove comments when removing entities\n\n* Address review comments on marvin tests\n\n* Allow users to list annotations for an entity ID\n\n* Allow users to see all comments for allowed entities\n\n* Fix search filters\n\n* Remove username from search filter\n\n* Add pagination to the annotations tab\n\n* Display username for user comments\n\n* Fix add permissions for domain and resource admins\n\n* Fix for domain admins\n\n* Trivial but important UI fix\n\n* Replace pagination for annotations tab\n\n* Add confirmation for delete comment\n\n* Lint warnings\n\n* Fix reduced list as domain admin\n\n* Fix display remove comment button for non admins\n\n* Improve display remove action button\n\n* Remove unused parameter on groupShow\n\n* Include a clock icon to the all comments filter except for root admin\n\n* Move cleanup SQL to the correct file after rebasing main\n\nCo-authored-by: davidjumani <dj.davidjumani1994@gmail.com>","date":"2021-09-08 12:44:06","modifiedFileCount":"109","status":"M","submitter":"Nicolas Vazquez"}]
