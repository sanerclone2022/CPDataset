[{"authorTime":"2018-04-27 09:31:34","codes":[{"authorDate":"2017-10-11 01:49:27","commitOrder":3,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                int resetBackTimeInMin = validateTimeString(resetTimeStr);\n                long resetTimeInMillis = TimeUnit.MILLISECONDS.convert(resetBackTimeInMin, TimeUnit.MINUTES);\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2017-10-11 01:49:27","endLine":454,"groupId":"12468","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/d7/f7d51d82a5c5608156d404c0c8d72af9ae2acb.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                int resetBackTimeInMin = validateTimeString(resetTimeStr);\n                long resetTimeInMillis = TimeUnit.MILLISECONDS.convert(resetBackTimeInMin, TimeUnit.MINUTES);\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdPersistentTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":439,"status":"NB"},{"authorDate":"2018-04-27 09:31:34","commitOrder":3,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                topics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                int resetBackTimeInMin = validateTimeString(resetTimeStr);\n                long resetTimeInMillis = TimeUnit.MILLISECONDS.convert(resetBackTimeInMin, TimeUnit.MINUTES);\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2018-04-27 09:31:34","endLine":494,"groupId":"12468","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/04/d96902faa92edb51969cfbd91150334e3dc9ee.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                topics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                int resetBackTimeInMin = validateTimeString(resetTimeStr);\n                long resetTimeInMillis = TimeUnit.MILLISECONDS.convert(resetBackTimeInMin, TimeUnit.MINUTES);\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":479,"status":"B"}],"commitId":"02eff26259b43d3fac646d80f8256f9308baba1d","commitMessage":"@@@In pulsar admin Java API.  unified persistent vs non-persistent into \"topics()\" (#1634)\n\n* In pulsar admin Java API.  unified persistent vs non-persistent into \"topics()\"\n\n* Fixed tests\n\n* Merged and fixed tests\n\n* Couple more tests fixes\n\n* Consolidated pulsar-admin persistent|non-persistent into 'topics' command\n","date":"2018-04-27 09:31:34","modifiedFileCount":"67","status":"M","submitter":"Matteo Merli"},{"authorTime":"2018-11-29 04:42:05","codes":[{"authorDate":"2018-11-29 04:42:05","commitOrder":4,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2018-11-29 04:42:05","endLine":508,"groupId":"7844","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/23/14ae6aceb1afd501789da01b301bae3871679e.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                int resetBackTimeInMin = validateTimeString(resetTimeStr);\n                long resetTimeInMillis = TimeUnit.MILLISECONDS.convert(resetBackTimeInMin, TimeUnit.MINUTES);\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdPersistentTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":493,"status":"M"},{"authorDate":"2018-11-29 04:42:05","commitOrder":4,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                topics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2018-11-29 04:42:05","endLine":507,"groupId":"7844","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/50/14f14ac054e815f72908d6b4325d56857db8e5.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                topics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                int resetBackTimeInMin = validateTimeString(resetTimeStr);\n                long resetTimeInMillis = TimeUnit.MILLISECONDS.convert(resetBackTimeInMin, TimeUnit.MINUTES);\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":492,"status":"M"}],"commitId":"a99f733224bf25aced7302f506b67b0fd5043c73","commitMessage":"@@@PIP-25: Token based authentication (#2888)\n\n* PIP-25: Token based authentication\n\n* Addressed comments\n\n* Use Authorization header\n\n* Update to support env: data: and file: as sources for keys and tokens\n\n* Fixed cli description\n\n* Updated broker.conf\n\n* Improved consistency in reading keys and CLI tools\n\n* Fixed check for http headers\n\n* Accept rel time with no specified unit\n\n* Fixed reading data: URL\n\n* Addressed comments\n\n* Added integration tests\n\n* Addressed comments\n\n* Added CLI command to validate token against key\n\n* Fixed integration tests\n\n* Removed env:\n\n* Fixed rel time parsing\n","date":"2018-11-29 04:42:05","modifiedFileCount":"9","status":"M","submitter":"Matteo Merli"},{"authorTime":"2020-10-22 00:57:57","codes":[{"authorDate":"2018-11-29 04:42:05","commitOrder":5,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2018-11-29 04:42:05","endLine":508,"groupId":"7844","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/23/14ae6aceb1afd501789da01b301bae3871679e.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdPersistentTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":493,"status":"N"},{"authorDate":"2020-10-22 00:57:57","commitOrder":5,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                if (excludeResetPosition) {\n                    topics.resetCursor(persistentTopic, subName, messageId, true);\n                } else {\n                    topics.resetCursor(persistentTopic, subName, messageId);\n                }\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2020-10-22 00:57:57","endLine":667,"groupId":"7844","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/cf/09519f8153aa0c5d170feb66d568143454bcf3.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                topics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":648,"status":"M"}],"commitId":"656bcb24713f33054d0997f4004c073f8098ed5f","commitMessage":"@@@Support exclude the message when reset cursor by message ID (#8306)\n\nFixes #8259\n\n Motivation\nCurrently.  when reset the cursor to a position.  the broker will set the mark delete position to the previous position of the reset position. For some usecase.  we don't want to consume the reset position again.  so it's better to provide a way to reset the cursor to a specific position and exclude this position. So that the consumers under the subscription can start consume messages from the next position of the reset position.\n\n\n Modifications\nAdd a new API to exclude the message when reset cursor by message ID\n\n\n Verifying this change\nSimpleProducerConsumerTest#testResetPosition","date":"2020-10-22 00:57:57","modifiedFileCount":"11","status":"M","submitter":"feynmanlin"},{"authorTime":"2021-01-29 03:06:36","codes":[{"authorDate":"2021-01-29 03:06:36","commitOrder":6,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                getPersistentTopics().resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                getPersistentTopics().resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2021-01-29 03:06:36","endLine":523,"groupId":"12443","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/f5/6029d23fde419e8aa546ee22ae531b98ac9d44.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                persistentTopics.resetCursor(persistentTopic, subName, messageId);\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                persistentTopics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdPersistentTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":508,"status":"M"},{"authorDate":"2021-01-29 03:06:36","commitOrder":6,"curCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                if (excludeResetPosition) {\n                    getTopics().resetCursor(persistentTopic, subName, messageId, true);\n                } else {\n                    getTopics().resetCursor(persistentTopic, subName, messageId);\n                }\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                getTopics().resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","date":"2021-01-29 03:06:36","endLine":745,"groupId":"12443","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/0c/610c2779cd4584c2874daaace658aee5f2b9db.src","preCode":"        void run() throws PulsarAdminException {\n            String persistentTopic = validatePersistentTopic(params);\n            if (isNotBlank(resetMessageIdStr)) {\n                MessageId messageId = validateMessageIdString(resetMessageIdStr);\n                if (excludeResetPosition) {\n                    topics.resetCursor(persistentTopic, subName, messageId, true);\n                } else {\n                    topics.resetCursor(persistentTopic, subName, messageId);\n                }\n            } else if (isNotBlank(resetTimeStr)) {\n                long resetTimeInMillis = TimeUnit.SECONDS\n                        .toMillis(RelativeTimeUtil.parseRelativeTimeInSeconds(resetTimeStr));\n                \r\n                long timestamp = System.currentTimeMillis() - resetTimeInMillis;\n                topics.resetCursor(persistentTopic, subName, timestamp);\n            } else {\n                throw new PulsarAdminException(\n                        \"Either Timestamp (--time) or Position (--position) has to be provided to reset cursor\");\n            }\n        }\n","realPath":"pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdTopics.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":726,"status":"M"}],"commitId":"232b32439687995dd3102d8c281cf50b7b91e0bf","commitMessage":"@@@Lazily init PulsarAdmin in PulsarAdminTool (#9312)\n\n\n Motivation\npulsar-admin (PulsarAdminTool) initialises eagerly the PulsarAdmin object and some of the the underlying REST API intefaces.\nThis initialisation process triggers lot of resource loading (like SSL/RESTAPI classes....) that slows down the JVM even for stuff that is not needed.\nAlso there are shutdown hooks that are useless by they are executed while existing from the command.\n\nRemoving initialisation of useless stuff helps in having a better bootstrap time.  especially in case that you are not performing API calls.  like when you are learning the tool and you make lots of syntax errors. \n\n\n Modifications\n- Initialise as lazily as possible PulsarAdmin \n- Make PulsarAdminTool#main \"testable\" by allowing it to not call System.exit\n- Use halt instead of exit in order to not trigger shutdown hooks\n\n\n Verifying this change\nThis change is a trivial rework / code cleanup.  but I have added tests for parts that have been touched and had not unit tests.\n","date":"2021-01-29 03:06:36","modifiedFileCount":"27","status":"M","submitter":"Enrico Olivelli"}]
