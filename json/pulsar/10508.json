[{"authorTime":"2018-08-07 01:29:26","codes":[{"authorDate":"2018-08-07 01:29:26","commitOrder":1,"curCode":"    public void testGetTableMetadataTableBlankSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            Assert.fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            Assert.assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            Assert.assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2018-08-07 01:29:26","endLine":230,"groupId":"446","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetTableMetadataTableBlankSchema","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/77/26763104c126787d29016bfe43f5a0f6c24d7b.src","preCode":"    public void testGetTableMetadataTableBlankSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            Assert.fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            Assert.assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            Assert.assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":208,"status":"B"},{"authorDate":"2018-08-07 01:29:26","commitOrder":1,"curCode":"    public void testGetTableMetadataTableInvalidSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            Assert.fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            Assert.assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            Assert.assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2018-08-07 01:29:26","endLine":255,"groupId":"446","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testGetTableMetadataTableInvalidSchema","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/77/26763104c126787d29016bfe43f5a0f6c24d7b.src","preCode":"    public void testGetTableMetadataTableInvalidSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            Assert.fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            Assert.assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            Assert.assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":233,"status":"B"}],"commitId":"461647a2b7943787883760a810f7cecda88128ec","commitMessage":"@@@PIP-19: Initial implementation of Pulsar SQL (#2265)\n\n* adding module for Pulsar SQL\n\n* renaming presto pulsar package\n\n* fixing pom and configs\n\n* fixing pom\n\n* using project version variable in pom\n\n* adding comments\n","date":"2018-08-07 01:29:26","modifiedFileCount":"0","status":"B","submitter":"Boyang Jerry Peng"},{"authorTime":"2019-07-09 00:16:05","codes":[{"authorDate":"2019-07-09 00:16:05","commitOrder":2,"curCode":"    public void testGetTableMetadataTableBlankSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2019-07-09 00:16:05","endLine":216,"groupId":"446","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetTableMetadataTableBlankSchema","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/a7/04be6484766c4211edb1e213755e007097e305.src","preCode":"    public void testGetTableMetadataTableBlankSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            Assert.fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            Assert.assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            Assert.assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":194,"status":"M"},{"authorDate":"2019-07-09 00:16:05","commitOrder":2,"curCode":"    public void testGetTableMetadataTableInvalidSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2019-07-09 00:16:05","endLine":241,"groupId":"446","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testGetTableMetadataTableInvalidSchema","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/a7/04be6484766c4211edb1e213755e007097e305.src","preCode":"    public void testGetTableMetadataTableInvalidSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            Assert.fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            Assert.assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            Assert.assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":219,"status":"M"}],"commitId":"c421ca6e5b0c99f7728c8651ad9a81005bfd176e","commitMessage":"@@@Cleanup tests in the presto module (#4683)\n\n* Add static import statements for Assert to simplify the test in the presto module\n\n* Use the preferred way of the schema's creation. The predicates and functions were converted to lambda\n","date":"2019-07-09 00:16:05","modifiedFileCount":"4","status":"M","submitter":"vzhikserg"},{"authorTime":"2019-07-22 22:59:43","codes":[{"authorDate":"2019-07-22 22:59:43","commitOrder":3,"curCode":"    public void testGetTableMetadataTableBlankSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2019-07-22 22:59:43","endLine":227,"groupId":"446","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetTableMetadataTableBlankSchema","params":"(Stringdelimiter)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/40/bf57c7164563292a330ccef9f66bcdac8bd287.src","preCode":"    public void testGetTableMetadataTableBlankSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":205,"status":"M"},{"authorDate":"2019-07-22 22:59:43","commitOrder":3,"curCode":"    public void testGetTableMetadataTableInvalidSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2019-07-22 22:59:43","endLine":252,"groupId":"446","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testGetTableMetadataTableInvalidSchema","params":"(Stringdelimiter)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/40/bf57c7164563292a330ccef9f66bcdac8bd287.src","preCode":"    public void testGetTableMetadataTableInvalidSchema() throws PulsarAdminException {\n\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":230,"status":"M"}],"commitId":"6ddd51ff45999bd7daa238073e9bcfd87d1df16a","commitMessage":"@@@Add options to rewrite namespace delimiter for pulsar sql. (#4749)\n\n\n Motivation\n\nFix #4732 \n\n\n Modifications\n\nAdd options to rewrite the namespace delimiter.  disable by default\n\nEnable rewrite namespace delimiter can work well with superset:\n<img width=\"1279\" alt=\"superset\" src=\"https://user-images.githubusercontent.com/12592133/61385412-f0f35700-a8e4-11e9-87b2-a31b62128b58.png\">\n\n\n\n Does this pull request potentially affect one of the following parts:\n\n*If `yes` was chosen.  please highlight the changes*\n\n  - Dependencies (does it add or upgrade a dependency): (no)\n  - The public API: (no)\n  - The schema: (no)\n  - The default values of configurations: (no)\n  - The wire protocol: (no)\n  - The rest endpoints: (no)\n  - The admin cli options: (no)\n  - Anything that affects deployment: (no)\n\n\n Documentation\n\n  - Does this pull request introduce a new feature? (no)\n","date":"2019-07-22 22:59:43","modifiedFileCount":"9","status":"M","submitter":"lipenghui"},{"authorTime":"2019-07-24 09:53:07","codes":[{"authorDate":"2019-07-24 09:53:07","commitOrder":4,"curCode":"    public void testGetTableMetadataTableBlankSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        badSchemaInfo.setType(SchemaType.AVRO);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2019-07-24 09:53:07","endLine":230,"groupId":"446","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetTableMetadataTableBlankSchema","params":"(Stringdelimiter)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/82/9aac9bca927514040111e52260a6215c11e6b7.src","preCode":"    public void testGetTableMetadataTableBlankSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":207,"status":"M"},{"authorDate":"2019-07-24 09:53:07","commitOrder":4,"curCode":"    public void testGetTableMetadataTableInvalidSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        badSchemaInfo.setType(SchemaType.AVRO);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2019-07-24 09:53:07","endLine":256,"groupId":"446","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testGetTableMetadataTableInvalidSchema","params":"(Stringdelimiter)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/82/9aac9bca927514040111e52260a6215c11e6b7.src","preCode":"    public void testGetTableMetadataTableInvalidSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":233,"status":"M"}],"commitId":"1ab35b01bcf931eb3b65a5660eca62a9ac4ceb1d","commitMessage":"@@@Pulsar SQL supports pulsar's primitive schema (#4728)\n\n\n Motivation\nContinue the PR of #4151","date":"2019-07-24 09:53:07","modifiedFileCount":"7","status":"M","submitter":"congbo"},{"authorTime":"2021-06-12 15:25:37","codes":[{"authorDate":"2021-06-12 15:25:37","commitOrder":5,"curCode":"    public void testGetTableMetadataTableBlankSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = SchemaInfoImpl.builder()\n                .schema(new byte[0])\n                .type(SchemaType.AVRO)\n                .build();\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2021-06-12 15:25:37","endLine":214,"groupId":"10508","id":9,"instanceNumber":1,"isCurCommit":1,"methodName":"testGetTableMetadataTableBlankSchema","params":"(Stringdelimiter)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/79/fb7893203c22e13f0ef3f71d8276d435e0b306.src","preCode":"    public void testGetTableMetadataTableBlankSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(new byte[0]);\n        badSchemaInfo.setType(SchemaType.AVRO);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":190,"status":"M"},{"authorDate":"2021-06-12 15:25:37","commitOrder":5,"curCode":"    public void testGetTableMetadataTableInvalidSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = SchemaInfoImpl.builder()\n                .schema(\"foo\".getBytes())\n                .type(SchemaType.AVRO)\n                .build();\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","date":"2021-06-12 15:25:37","endLine":241,"groupId":"10508","id":10,"instanceNumber":2,"isCurCommit":1,"methodName":"testGetTableMetadataTableInvalidSchema","params":"(Stringdelimiter)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-pulsar-10-0.7/blobInfo/CC_OUT/blobs/79/fb7893203c22e13f0ef3f71d8276d435e0b306.src","preCode":"    public void testGetTableMetadataTableInvalidSchema(String delimiter) throws PulsarAdminException {\n        updateRewriteNamespaceDelimiterIfNeeded(delimiter);\n        SchemaInfo badSchemaInfo = new SchemaInfo();\n        badSchemaInfo.setSchema(\"foo\".getBytes());\n        badSchemaInfo.setType(SchemaType.AVRO);\n        when(this.schemas.getSchemaInfo(eq(TOPIC_1.getSchemaName()))).thenReturn(badSchemaInfo);\n\n        PulsarTableHandle pulsarTableHandle = new PulsarTableHandle(\n                pulsarConnectorId.toString(),\n                TOPIC_1.getNamespace(),\n                TOPIC_1.getLocalName(),\n                TOPIC_1.getLocalName()\n        );\n\n        try {\n            ConnectorTableMetadata tableMetadata = this.pulsarMetadata.getTableMetadata(mock(ConnectorSession.class),\n                    pulsarTableHandle);\n            fail(\"Table without schema should have generated an exception\");\n        } catch (PrestoException e) {\n            assertEquals(e.getErrorCode(), NOT_SUPPORTED.toErrorCode());\n            assertEquals(e.getMessage(),\n                    \"Topic persistent://tenant-1/ns-1/topic-1 does not have a valid schema\");\n        }\n    }\n","realPath":"pulsar-sql/presto-pulsar/src/test/java/org/apache/pulsar/sql/presto/TestPulsarMetadata.java","repoName":"pulsar","snippetEndLine":0,"snippetStartLine":0,"startLine":217,"status":"M"}],"commitId":"d81b5f8b8e6cb17f307ec830accaf9dd95d7643b","commitMessage":"@@@Remove the unwanted dependencies in the pulsar function's instance jar and make SchemaInfo an interface (#10878)\n\n\n Motivation\n\nThe java-instance.jar generated by the pulsar-functions-runtime-all module should only contain interfaces that Pulsar Function's framework uses to interact with user code.  The module should on have the following dependencies\n    1. pulsar-io-core\n    2. pulsar-functions-api\n    3. pulsar-client-api\n    4. slf4j-api\n    5. log4j-slf4j-impl\n    6. log4j-api\n    7. log4j-core\n\n*Explain here the context.  and why you're making that change. What is the problem you're trying to solve.*\n\n\n Modifications\n\nChange dep pulsar-client-original to pulsar-client-api\n\nSlight changes in the top level pom for what is included in all sub-modules so that additional deps don't land into java-instance.jar\n\nThere is also a fix for an issue introduced by https://github.com/apache/pulsar/pull/9673. The thread context class loader was set incorrectly in ThreadRuntime.\n\n\n Future improvements\n\n1. We should also add a test in the future to make sure external libraries don't get add accidentally this module and java-instance.jar\n\n2. Rename the module \"pulsar-functions-runtime-all\" to something that describes its function better.  The current name can be confusing\n\n","date":"2021-06-12 15:25:37","modifiedFileCount":"49","status":"M","submitter":"Boyang Jerry Peng"}]
