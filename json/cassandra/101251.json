[{"authorTime":"2018-02-24 12:16:16","codes":[{"authorDate":"2018-02-24 12:16:16","commitOrder":1,"curCode":"    public void testAuditLogFilters() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n    }\n","date":"2018-05-11 20:44:16","endLine":117,"groupId":"32362","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testAuditLogFilters","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cassandra-10-0.7/blobInfo/CC_OUT/blobs/40/eadf87a245e6dbf60d10d9792ab1725c6ac8b7.src","preCode":"    public void testAuditLogFilters() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n    }\n","realPath":"test/unit/org/apache/cassandra/audit/AuditLoggerTest.java","repoName":"cassandra","snippetEndLine":0,"snippetStartLine":0,"startLine":80,"status":"B"},{"authorDate":"2018-02-24 12:16:16","commitOrder":1,"curCode":"    public void testAuditLogFiltersTransitions() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n    }\n","date":"2018-05-11 20:44:16","endLine":154,"groupId":"32362","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testAuditLogFiltersTransitions","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cassandra-10-0.7/blobInfo/CC_OUT/blobs/40/eadf87a245e6dbf60d10d9792ab1725c6ac8b7.src","preCode":"    public void testAuditLogFiltersTransitions() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n    }\n","realPath":"test/unit/org/apache/cassandra/audit/AuditLoggerTest.java","repoName":"cassandra","snippetEndLine":0,"snippetStartLine":0,"startLine":120,"status":"B"}],"commitId":"f56871b88be1e8965f166769c12cfa43313bac74","commitMessage":"@@@Audit logging for database activity\n\npatch by Vinay Chella; reviewed by jasobrown for CASSANDRA-12151\n","date":"2018-05-11 20:44:16","modifiedFileCount":"57","status":"B","submitter":"Vinay Chella"},{"authorTime":"2019-06-22 08:41:01","codes":[{"authorDate":"2019-06-22 08:41:01","commitOrder":2,"curCode":"    public void testAuditLogFilters() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n    }\n","date":"2019-06-22 10:04:02","endLine":129,"groupId":"32362","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testAuditLogFilters","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cassandra-10-0.7/blobInfo/CC_OUT/blobs/a4/4554729e655fc29b529ded1a9871ce0b66869f.src","preCode":"    public void testAuditLogFilters() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n    }\n","realPath":"test/unit/org/apache/cassandra/audit/AuditLoggerTest.java","repoName":"cassandra","snippetEndLine":0,"snippetStartLine":0,"startLine":92,"status":"M"},{"authorDate":"2019-06-22 08:41:01","commitOrder":2,"curCode":"    public void testAuditLogFiltersTransitions() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n    }\n","date":"2019-06-22 10:04:02","endLine":166,"groupId":"32362","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testAuditLogFiltersTransitions","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cassandra-10-0.7/blobInfo/CC_OUT/blobs/a4/4554729e655fc29b529ded1a9871ce0b66869f.src","preCode":"    public void testAuditLogFiltersTransitions() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n    }\n","realPath":"test/unit/org/apache/cassandra/audit/AuditLoggerTest.java","repoName":"cassandra","snippetEndLine":0,"snippetStartLine":0,"startLine":132,"status":"M"}],"commitId":"225fa868884bdda1c20e0fcef61628eb6d941fbe","commitMessage":"@@@Fix flaky unit test AuditLoggerTest\n\nPatch by Per Otterstr?m.  Sumanth Pasupuleti; Reviewed by Vinay Chella for CASSANDRA-15105\n\nCo-Authored-By: Per Otterstr?m <per.otterstrom@gmail.com>\nCo-Authored-By: Sumanth Pasupuleti <sumanth.pasupuleti.is@gmail.com>\n","date":"2019-06-22 10:04:02","modifiedFileCount":"2","status":"M","submitter":"Per Otterstr?m"},{"authorTime":"2019-03-08 22:56:21","codes":[{"authorDate":"2019-06-22 08:41:01","commitOrder":3,"curCode":"    public void testAuditLogFilters() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n    }\n","date":"2019-06-22 10:04:02","endLine":129,"groupId":"101251","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testAuditLogFilters","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cassandra-10-0.7/blobInfo/CC_OUT/blobs/a4/4554729e655fc29b529ded1a9871ce0b66869f.src","preCode":"    public void testAuditLogFilters() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertWithPrepare(cql, AuditLogEntryType.SELECT, 1);\n        assertEquals(1, rs.all().size());\n    }\n","realPath":"test/unit/org/apache/cassandra/audit/AuditLoggerTest.java","repoName":"cassandra","snippetEndLine":0,"snippetStartLine":0,"startLine":92,"status":"N"},{"authorDate":"2019-03-08 22:56:21","commitOrder":3,"curCode":"    public void testAuditLogFiltersTransitions() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n        assertEquals(1, QueryEvents.instance.listenerCount());\n        assertEquals(1, AuthEvents.instance.listenerCount());\n        disableAuditLogOptions();\n        assertEquals(0, QueryEvents.instance.listenerCount());\n        assertEquals(0, AuthEvents.instance.listenerCount());\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n    }\n","date":"2020-04-16 20:19:54","endLine":178,"groupId":"101251","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testAuditLogFiltersTransitions","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-cassandra-10-0.7/blobInfo/CC_OUT/blobs/e3/b93ecaaf2ccae06d3072c735f939bdfb233f07.src","preCode":"    public void testAuditLogFiltersTransitions() throws Throwable\n    {\n        createTable(\"CREATE TABLE %s (id int primary key, v1 text, v2 text)\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 1, \"Apache\", \"Cassandra\");\n        execute(\"INSERT INTO %s (id, v1, v2) VALUES (?, ?, ?)\", 2, \"trace\", \"test\");\n\n        AuditLogOptions options = new AuditLogOptions();\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        String cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        ResultSet rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        options = new AuditLogOptions();\n        options.included_keyspaces = KEYSPACE;\n        options.excluded_keyspaces += ',' + KEYSPACE;\n        enableAuditLogOptions(options);\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertNoAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n\n        disableAuditLogOptions();\n\n        cql = \"SELECT id, v1, v2 FROM \" + KEYSPACE + '.' + currentTable() + \" WHERE id = ?\";\n        rs = executeAndAssertDisableAuditLog(cql, 1);\n        assertEquals(1, rs.all().size());\n    }\n","realPath":"test/unit/org/apache/cassandra/audit/AuditLoggerTest.java","repoName":"cassandra","snippetEndLine":0,"snippetStartLine":0,"startLine":141,"status":"M"}],"commitId":"5242f7d4306f034f32e26834df06ff7fc85a3c16","commitMessage":"@@@Fix issues in audit / full query log interactions\n\nPatch by marcuse; reviewed by Aleksey Yeschenko and Per Otterstr?m for CASSANDRA-14772\n","date":"2020-04-16 20:19:54","modifiedFileCount":"41","status":"M","submitter":"Marcus Eriksson"}]
