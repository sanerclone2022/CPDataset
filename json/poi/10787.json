[{"authorTime":"2021-04-08 05:40:33","codes":[{"authorDate":"2021-04-08 05:40:33","commitOrder":1,"curCode":"    void testBug63845() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet();\n            Row row = sheet.createRow(0);\n\n            Cell cell = row.createCell(0, CellType.FORMULA);\n            cell.setCellFormula(\"SUM(B1:E1)\");\n\n            assertNull(((XSSFCell) cell).getCTCell().getV(),\n                \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n            try (Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(0);\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n                assertNotNull(((XSSFCell) cellBack).getCTCell().getF(),\n                    \"Formula should be set internally now\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"0.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n\n                cellBack.setCellValue(\"123\");\n                assertEquals(\"123\", cellBack.getStringCellValue(),\n                    \"String value should be set now\");\n                assertNull(((XSSFCell) cellBack).getCTCell().getF(), \"No formula should be set any more\");\n            }\n        }\n    }\n","date":"2021-04-08 05:40:33","endLine":3476,"groupId":"16276","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testBug63845","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-poi-10-0.7/blobInfo/CC_OUT/blobs/56/2fa9f2465a754633a75bff35c22f96aec4423d.src","preCode":"    void testBug63845() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet();\n            Row row = sheet.createRow(0);\n\n            Cell cell = row.createCell(0, CellType.FORMULA);\n            cell.setCellFormula(\"SUM(B1:E1)\");\n\n            assertNull(((XSSFCell) cell).getCTCell().getV(),\n                \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n            try (Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(0);\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n                assertNotNull(((XSSFCell) cellBack).getCTCell().getF(),\n                    \"Formula should be set internally now\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"0.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n\n                cellBack.setCellValue(\"123\");\n                assertEquals(\"123\", cellBack.getStringCellValue(),\n                    \"String value should be set now\");\n                assertNull(((XSSFCell) cellBack).getCTCell().getF(), \"No formula should be set any more\");\n            }\n        }\n    }\n","realPath":"poi-ooxml/src/test/java/org/apache/poi/xssf/usermodel/TestXSSFBugs.java","repoName":"poi","snippetEndLine":0,"snippetStartLine":0,"startLine":3447,"status":"B"},{"authorDate":"2021-04-08 05:40:33","commitOrder":1,"curCode":"    void testBug63845_2() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            row.createCell(0).setCellValue(2);\n            row.createCell(1).setCellValue(5);\n            row.createCell(2).setCellFormula(\"A1+B1\");\n\n            try (Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(2);\n\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"7.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n            }\n        }\n    }\n","date":"2021-04-08 05:40:33","endLine":3499,"groupId":"16277","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testBug63845_2","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-poi-10-0.7/blobInfo/CC_OUT/blobs/56/2fa9f2465a754633a75bff35c22f96aec4423d.src","preCode":"    void testBug63845_2() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            row.createCell(0).setCellValue(2);\n            row.createCell(1).setCellValue(5);\n            row.createCell(2).setCellFormula(\"A1+B1\");\n\n            try (Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(2);\n\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"7.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n            }\n        }\n    }\n","realPath":"poi-ooxml/src/test/java/org/apache/poi/xssf/usermodel/TestXSSFBugs.java","repoName":"poi","snippetEndLine":0,"snippetStartLine":0,"startLine":3479,"status":"B"}],"commitId":"b6aee1ef6d3e92a28ffd4b5c03e677b63b43747f","commitMessage":"@@@65206 - Migrate ant / maven to gradle build\ncompile / jar / test of mrJars\ndon't include ants build.xml anymore\nrename directories to match project and maven artifact names\nrefactor artifacts - so each project has one artifact\nreplace static references in hssf/dev tests with junit5 constructs.  which had problems in parallel tests\nincrease gradle heap to 4gb because of OOM - maybe less would also work\n\ngit-svn-id: https://svn.apache.org/repos/asf/poi/trunk@1888488 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2021-04-08 05:40:33","modifiedFileCount":"0","status":"B","submitter":"Andreas Beeker"},{"authorTime":"2021-05-14 08:37:50","codes":[{"authorDate":"2021-05-14 08:37:50","commitOrder":2,"curCode":"    void testBug63845() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet();\n            Row row = sheet.createRow(0);\n\n            Cell cell = row.createCell(0, CellType.FORMULA);\n            cell.setCellFormula(\"SUM(B1:E1)\");\n\n            assertNull(((XSSFCell) cell).getCTCell().getV(),\n                \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n            try (Workbook wbBack = writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(0);\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n                assertNotNull(((XSSFCell) cellBack).getCTCell().getF(),\n                    \"Formula should be set internally now\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"0.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n\n                cellBack.setCellValue(\"123\");\n                assertEquals(\"123\", cellBack.getStringCellValue(),\n                    \"String value should be set now\");\n                assertNull(((XSSFCell) cellBack).getCTCell().getF(), \"No formula should be set any more\");\n            }\n        }\n    }\n","date":"2021-05-14 08:37:50","endLine":3351,"groupId":"10787","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testBug63845","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-poi-10-0.7/blobInfo/CC_OUT/blobs/50/8362e82049245a9dd65a948a0aa6798d778b00.src","preCode":"    void testBug63845() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet();\n            Row row = sheet.createRow(0);\n\n            Cell cell = row.createCell(0, CellType.FORMULA);\n            cell.setCellFormula(\"SUM(B1:E1)\");\n\n            assertNull(((XSSFCell) cell).getCTCell().getV(),\n                \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n            try (Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(0);\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n                assertNotNull(((XSSFCell) cellBack).getCTCell().getF(),\n                    \"Formula should be set internally now\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"0.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n\n                cellBack.setCellValue(\"123\");\n                assertEquals(\"123\", cellBack.getStringCellValue(),\n                    \"String value should be set now\");\n                assertNull(((XSSFCell) cellBack).getCTCell().getF(), \"No formula should be set any more\");\n            }\n        }\n    }\n","realPath":"poi-ooxml/src/test/java/org/apache/poi/xssf/usermodel/TestXSSFBugs.java","repoName":"poi","snippetEndLine":0,"snippetStartLine":0,"startLine":3322,"status":"M"},{"authorDate":"2021-05-14 08:37:50","commitOrder":2,"curCode":"    void testBug63845_2() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            row.createCell(0).setCellValue(2);\n            row.createCell(1).setCellValue(5);\n            row.createCell(2).setCellFormula(\"A1+B1\");\n\n            try (Workbook wbBack = writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(2);\n\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"7.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n            }\n        }\n    }\n","date":"2021-05-14 08:37:50","endLine":3374,"groupId":"10787","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testBug63845_2","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-poi-10-0.7/blobInfo/CC_OUT/blobs/50/8362e82049245a9dd65a948a0aa6798d778b00.src","preCode":"    void testBug63845_2() throws IOException {\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            row.createCell(0).setCellValue(2);\n            row.createCell(1).setCellValue(5);\n            row.createCell(2).setCellFormula(\"A1+B1\");\n\n            try (Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb)) {\n                Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(2);\n\n                assertNull(((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should not be set for formulas unless the value was calculated\");\n\n                wbBack.getCreationHelper().createFormulaEvaluator().evaluateInCell(cellBack);\n\n                assertEquals(\"7.0\", ((XSSFCell) cellBack).getCTCell().getV(),\n                    \"Element 'v' should be set now as the formula was calculated manually\");\n            }\n        }\n    }\n","realPath":"poi-ooxml/src/test/java/org/apache/poi/xssf/usermodel/TestXSSFBugs.java","repoName":"poi","snippetEndLine":0,"snippetStartLine":0,"startLine":3354,"status":"M"}],"commitId":"0614835c55f44ab6f3e9b0850ca51e0e53a65a49","commitMessage":"@@@#65304 - Add commons-io as a dependency\n\ngit-svn-id: https://svn.apache.org/repos/asf/poi/trunk@1889871 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2021-05-14 08:37:50","modifiedFileCount":"277","status":"M","submitter":"Andreas Beeker"}]
