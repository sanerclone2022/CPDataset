[{"authorTime":"2013-10-26 05:54:19","codes":[{"authorDate":"2017-04-21 05:33:38","commitOrder":3,"curCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final URLClassLoader myLoader = (URLClassLoader) getClass().getClassLoader();\n    final URL[] urls = myLoader.getURLs();\n    URLClassLoader sepLoader = new URLClassLoader(urls, myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","date":"2017-04-21 10:27:51","endLine":237,"groupId":"9234","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"doTestUnloadableInStaticFieldIfClosed","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-guava-10-0.7/blobInfo/CC_OUT/blobs/c4/dfdd499c591b8b68c3613cad330eee3219e9bd.src","preCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final URLClassLoader myLoader = (URLClassLoader) getClass().getClassLoader();\n    final URL[] urls = myLoader.getURLs();\n    URLClassLoader sepLoader = new URLClassLoader(urls, myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","realPath":"android/guava-tests/test/com/google/common/base/FinalizableReferenceQueueClassLoaderUnloadingTest.java","repoName":"guava","snippetEndLine":0,"snippetStartLine":0,"startLine":202,"status":"B"},{"authorDate":"2013-10-26 05:54:19","commitOrder":3,"curCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final URLClassLoader myLoader = (URLClassLoader) getClass().getClassLoader();\n    final URL[] urls = myLoader.getURLs();\n    URLClassLoader sepLoader = new URLClassLoader(urls, myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","date":"2013-10-26 05:54:19","endLine":239,"groupId":"9234","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"doTestUnloadableInStaticFieldIfClosed","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-guava-10-0.7/blobInfo/CC_OUT/blobs/35/bac3796a4ed434a4d1b019d54986223838ccfd.src","preCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final URLClassLoader myLoader = (URLClassLoader) getClass().getClassLoader();\n    final URL[] urls = myLoader.getURLs();\n    URLClassLoader sepLoader = new URLClassLoader(urls, myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","realPath":"guava-tests/test/com/google/common/base/FinalizableReferenceQueueClassLoaderUnloadingTest.java","repoName":"guava","snippetEndLine":0,"snippetStartLine":0,"startLine":204,"status":"NB"}],"commitId":"9b94fb3965c6869b0ac47420958a4bbae0b2d54c","commitMessage":"@@@Begin exporting sources of Guava for Android.\n\npom.xml files to come.\n\n-------------\nCreated by MOE: https://github.com/google/moe\nMOE_MIGRATED_REVID=153757913\n","date":"2017-04-21 10:27:51","modifiedFileCount":"0","status":"M","submitter":"zhenghua"},{"authorTime":"2018-01-18 01:41:16","codes":[{"authorDate":"2018-01-18 01:41:16","commitOrder":4,"curCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final ClassLoader myLoader = getClass().getClassLoader();\n    URLClassLoader sepLoader = new URLClassLoader(getClassPathUrls(), myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","date":"2018-01-18 04:22:10","endLine":242,"groupId":"9234","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"doTestUnloadableInStaticFieldIfClosed","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-guava-10-0.7/blobInfo/CC_OUT/blobs/9a/674aa9ca669adb62c81abb2483bc8c417db287.src","preCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final URLClassLoader myLoader = (URLClassLoader) getClass().getClassLoader();\n    final URL[] urls = myLoader.getURLs();\n    URLClassLoader sepLoader = new URLClassLoader(urls, myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","realPath":"android/guava-tests/test/com/google/common/base/FinalizableReferenceQueueClassLoaderUnloadingTest.java","repoName":"guava","snippetEndLine":0,"snippetStartLine":0,"startLine":208,"status":"M"},{"authorDate":"2018-01-18 01:41:16","commitOrder":4,"curCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final ClassLoader myLoader = getClass().getClassLoader();\n    URLClassLoader sepLoader = new URLClassLoader(getClassPathUrls(), myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","date":"2018-01-18 04:22:10","endLine":242,"groupId":"9234","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"doTestUnloadableInStaticFieldIfClosed","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-guava-10-0.7/blobInfo/CC_OUT/blobs/9a/674aa9ca669adb62c81abb2483bc8c417db287.src","preCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final URLClassLoader myLoader = (URLClassLoader) getClass().getClassLoader();\n    final URL[] urls = myLoader.getURLs();\n    URLClassLoader sepLoader = new URLClassLoader(urls, myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","realPath":"guava-tests/test/com/google/common/base/FinalizableReferenceQueueClassLoaderUnloadingTest.java","repoName":"guava","snippetEndLine":0,"snippetStartLine":0,"startLine":208,"status":"M"}],"commitId":"8eb3ea467668f63a78f03527adf7053d6502434d","commitMessage":"@@@Fix tests that assume Class.getClassLoader() returns a URLClassLoader so that they can call getURLs() to instead parse the \"java.class.path\" system property.\n\nThis doesn't fully fix FinalizableReferenceQueueClassLoaderUnloadingTest: I still see a failure for testUnloadableInStaticFieldIfClosed. But at least the other 2 tests in the file pass.  and the failure is now a \"real\" failure (\"Predicate did not become true within 10 second timeout\") rather than a ClassCastException.\n\n(I've confirmed that the failing test computes exactly the same classpath under Java 9 as under Java 8.  so I'm not sure exactly what's up. I may ask emcmanus.)\n\n-------------\nCreated by MOE: https://github.com/google/moe\nMOE_MIGRATED_REVID=182227182\n","date":"2018-01-18 04:22:10","modifiedFileCount":"2","status":"M","submitter":"cpovirk"},{"authorTime":"2021-02-16 11:22:43","codes":[{"authorDate":"2021-02-16 11:22:43","commitOrder":5,"curCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final ClassLoader myLoader = getClass().getClassLoader();\n    URLClassLoader sepLoader = new URLClassLoader(getClassPathUrls(), myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.getDeclaredConstructor().newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","date":"2021-02-16 11:24:50","endLine":260,"groupId":"101165","id":5,"instanceNumber":1,"isCurCommit":1,"methodName":"doTestUnloadableInStaticFieldIfClosed","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-guava-10-0.7/blobInfo/CC_OUT/blobs/ae/35c16f64826490d829021cf63d3ee278d6825c.src","preCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final ClassLoader myLoader = getClass().getClassLoader();\n    URLClassLoader sepLoader = new URLClassLoader(getClassPathUrls(), myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","realPath":"android/guava-tests/test/com/google/common/base/FinalizableReferenceQueueClassLoaderUnloadingTest.java","repoName":"guava","snippetEndLine":0,"snippetStartLine":0,"startLine":226,"status":"M"},{"authorDate":"2021-02-16 11:22:43","commitOrder":5,"curCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final ClassLoader myLoader = getClass().getClassLoader();\n    URLClassLoader sepLoader = new URLClassLoader(getClassPathUrls(), myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.getDeclaredConstructor().newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","date":"2021-02-16 11:24:50","endLine":260,"groupId":"101165","id":6,"instanceNumber":2,"isCurCommit":1,"methodName":"doTestUnloadableInStaticFieldIfClosed","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-guava-10-0.7/blobInfo/CC_OUT/blobs/ae/35c16f64826490d829021cf63d3ee278d6825c.src","preCode":"  private WeakReference<ClassLoader> doTestUnloadableInStaticFieldIfClosed() throws Exception {\n    final ClassLoader myLoader = getClass().getClassLoader();\n    URLClassLoader sepLoader = new URLClassLoader(getClassPathUrls(), myLoader.getParent());\n\n    Class<?> frqC = FinalizableReferenceQueue.class;\n    Class<?> sepFrqC = sepLoader.loadClass(frqC.getName());\n    assertNotSame(frqC, sepFrqC);\n\n    Class<?> sepFrqSystemLoaderC =\n        sepLoader.loadClass(FinalizableReferenceQueue.SystemLoader.class.getName());\n    Field disabled = sepFrqSystemLoaderC.getDeclaredField(\"disabled\");\n    disabled.setAccessible(true);\n    disabled.set(null, true);\n\n    Class<?> frqUserC = FrqUser.class;\n    Class<?> sepFrqUserC = sepLoader.loadClass(frqUserC.getName());\n    assertNotSame(frqUserC, sepFrqUserC);\n    assertSame(sepLoader, sepFrqUserC.getClassLoader());\n\n    Callable<?> sepFrqUser = (Callable<?>) sepFrqUserC.newInstance();\n    WeakReference<?> finalizableWeakReference = (WeakReference<?>) sepFrqUser.call();\n\n    GcFinalization.awaitClear(finalizableWeakReference);\n\n    Field sepFrqUserFinalizedF = sepFrqUserC.getField(\"finalized\");\n    Semaphore finalizeCount = (Semaphore) sepFrqUserFinalizedF.get(null);\n    boolean finalized = finalizeCount.tryAcquire(5, TimeUnit.SECONDS);\n    assertTrue(finalized);\n\n    Field sepFrqUserFrqF = sepFrqUserC.getField(\"frq\");\n    Closeable frq = (Closeable) sepFrqUserFrqF.get(null);\n    frq.close();\n\n    return new WeakReference<ClassLoader>(sepLoader);\n  }\n","realPath":"guava-tests/test/com/google/common/base/FinalizableReferenceQueueClassLoaderUnloadingTest.java","repoName":"guava","snippetEndLine":0,"snippetStartLine":0,"startLine":226,"status":"M"}],"commitId":"2dda3f3c92b3affb4479516ba3f5f73ebc300c9c","commitMessage":"@@@Migrate off deprecated Class#newInstance().\n\nFixes #5407\n\nRELNOTES=n/a\nPiperOrigin-RevId: 357635267\n","date":"2021-02-16 11:24:50","modifiedFileCount":"6","status":"M","submitter":"suraj dhamecha"}]
