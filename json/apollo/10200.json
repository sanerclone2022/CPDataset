[{"authorTime":"2016-05-19 17:58:23","codes":[{"authorDate":"2016-05-19 17:58:23","commitOrder":1,"curCode":"  public void testGetProperty() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    someProperties.setProperty(someKey, someValue);\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someValue, config.getProperty(someKey, null));\n  }\n","date":"2016-05-19 17:58:23","endLine":52,"groupId":"973","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetProperty","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-apollo-10-0.7/blobInfo/CC_OUT/blobs/14/05bda7214f5e614ae0a5cda24a5d1d39e6b76e.src","preCode":"  public void testGetProperty() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    someProperties.setProperty(someKey, someValue);\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someValue, config.getProperty(someKey, null));\n  }\n","realPath":"apollo-client/src/test/java/com/ctrip/framework/apollo/internals/SimpleConfigTest.java","repoName":"apollo","snippetEndLine":0,"snippetStartLine":0,"startLine":41,"status":"B"},{"authorDate":"2016-05-19 17:58:23","commitOrder":1,"curCode":"  public void testOnRepositoryChange() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    String anotherKey = \"anotherKey\";\n    String anotherValue = \"anotherValue\";\n    someProperties.putAll(ImmutableMap.of(someKey, someValue, anotherKey, anotherValue));\n\n    Properties anotherProperties = new Properties();\n    String newKey = \"newKey\";\n    String newValue = \"newValue\";\n    String someValueNew = \"someValueNew\";\n    anotherProperties.putAll(ImmutableMap.of(someKey, someValueNew, newKey, newValue));\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    ConfigChangeListener someListener = mock(ConfigChangeListener.class);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n    config.addChangeListener(someListener);\n\n    config.onRepositoryChange(someNamespace, anotherProperties);\n\n    ArgumentCaptor<ConfigChangeEvent> captor = ArgumentCaptor.forClass(ConfigChangeEvent.class);\n\n    verify(someListener, times(1)).onChange(captor.capture());\n\n    ConfigChangeEvent changeEvent = captor.getValue();\n\n    assertEquals(someNamespace, changeEvent.getNamespace());\n    assertEquals(3, changeEvent.changedKeys().size());\n\n    ConfigChange someKeyChange = changeEvent.getChange(someKey);\n    assertEquals(someValue, someKeyChange.getOldValue());\n    assertEquals(someValueNew, someKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.MODIFIED, someKeyChange.getChangeType());\n\n    ConfigChange anotherKeyChange = changeEvent.getChange(anotherKey);\n    assertEquals(anotherValue, anotherKeyChange.getOldValue());\n    assertEquals(null, anotherKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.DELETED, anotherKeyChange.getChangeType());\n\n    ConfigChange newKeyChange = changeEvent.getChange(newKey);\n    assertEquals(null, newKeyChange.getOldValue());\n    assertEquals(newValue, newKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.ADDED, newKeyChange.getChangeType());\n  }\n","date":"2016-05-19 17:58:23","endLine":112,"groupId":"975","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testOnRepositoryChange","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-apollo-10-0.7/blobInfo/CC_OUT/blobs/14/05bda7214f5e614ae0a5cda24a5d1d39e6b76e.src","preCode":"  public void testOnRepositoryChange() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    String anotherKey = \"anotherKey\";\n    String anotherValue = \"anotherValue\";\n    someProperties.putAll(ImmutableMap.of(someKey, someValue, anotherKey, anotherValue));\n\n    Properties anotherProperties = new Properties();\n    String newKey = \"newKey\";\n    String newValue = \"newValue\";\n    String someValueNew = \"someValueNew\";\n    anotherProperties.putAll(ImmutableMap.of(someKey, someValueNew, newKey, newValue));\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    ConfigChangeListener someListener = mock(ConfigChangeListener.class);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n    config.addChangeListener(someListener);\n\n    config.onRepositoryChange(someNamespace, anotherProperties);\n\n    ArgumentCaptor<ConfigChangeEvent> captor = ArgumentCaptor.forClass(ConfigChangeEvent.class);\n\n    verify(someListener, times(1)).onChange(captor.capture());\n\n    ConfigChangeEvent changeEvent = captor.getValue();\n\n    assertEquals(someNamespace, changeEvent.getNamespace());\n    assertEquals(3, changeEvent.changedKeys().size());\n\n    ConfigChange someKeyChange = changeEvent.getChange(someKey);\n    assertEquals(someValue, someKeyChange.getOldValue());\n    assertEquals(someValueNew, someKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.MODIFIED, someKeyChange.getChangeType());\n\n    ConfigChange anotherKeyChange = changeEvent.getChange(anotherKey);\n    assertEquals(anotherValue, anotherKeyChange.getOldValue());\n    assertEquals(null, anotherKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.DELETED, anotherKeyChange.getChangeType());\n\n    ConfigChange newKeyChange = changeEvent.getChange(newKey);\n    assertEquals(null, newKeyChange.getOldValue());\n    assertEquals(newValue, newKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.ADDED, newKeyChange.getChangeType());\n  }\n","realPath":"apollo-client/src/test/java/com/ctrip/framework/apollo/internals/SimpleConfigTest.java","repoName":"apollo","snippetEndLine":0,"snippetStartLine":0,"startLine":66,"status":"B"}],"commitId":"0b3ace803cac96eb293336fd429738c5b92f845d","commitMessage":"@@@Merge pull request #209 from lepdou/rename\n\nRename","date":"2016-05-19 17:58:23","modifiedFileCount":"1","status":"B","submitter":"Jason Song"},{"authorTime":"2016-06-07 11:32:12","codes":[{"authorDate":"2016-05-19 17:58:23","commitOrder":2,"curCode":"  public void testGetProperty() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    someProperties.setProperty(someKey, someValue);\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someValue, config.getProperty(someKey, null));\n  }\n","date":"2016-05-19 17:58:23","endLine":52,"groupId":"973","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetProperty","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-apollo-10-0.7/blobInfo/CC_OUT/blobs/14/05bda7214f5e614ae0a5cda24a5d1d39e6b76e.src","preCode":"  public void testGetProperty() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    someProperties.setProperty(someKey, someValue);\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someValue, config.getProperty(someKey, null));\n  }\n","realPath":"apollo-client/src/test/java/com/ctrip/framework/apollo/internals/SimpleConfigTest.java","repoName":"apollo","snippetEndLine":0,"snippetStartLine":0,"startLine":41,"status":"N"},{"authorDate":"2016-06-07 11:32:12","commitOrder":2,"curCode":"  public void testOnRepositoryChange() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    String anotherKey = \"anotherKey\";\n    String anotherValue = \"anotherValue\";\n    someProperties.putAll(ImmutableMap.of(someKey, someValue, anotherKey, anotherValue));\n\n    Properties anotherProperties = new Properties();\n    String newKey = \"newKey\";\n    String newValue = \"newValue\";\n    String someValueNew = \"someValueNew\";\n    anotherProperties.putAll(ImmutableMap.of(someKey, someValueNew, newKey, newValue));\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    final SettableFuture<ConfigChangeEvent> configChangeFuture = SettableFuture.create();\n    ConfigChangeListener someListener = new ConfigChangeListener() {\n      @Override\n      public void onChange(ConfigChangeEvent changeEvent) {\n        configChangeFuture.set(changeEvent);\n      }\n    };\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n    config.addChangeListener(someListener);\n\n    config.onRepositoryChange(someNamespace, anotherProperties);\n\n    ConfigChangeEvent changeEvent = configChangeFuture.get(500, TimeUnit.MILLISECONDS);\n\n    assertEquals(someNamespace, changeEvent.getNamespace());\n    assertEquals(3, changeEvent.changedKeys().size());\n\n    ConfigChange someKeyChange = changeEvent.getChange(someKey);\n    assertEquals(someValue, someKeyChange.getOldValue());\n    assertEquals(someValueNew, someKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.MODIFIED, someKeyChange.getChangeType());\n\n    ConfigChange anotherKeyChange = changeEvent.getChange(anotherKey);\n    assertEquals(anotherValue, anotherKeyChange.getOldValue());\n    assertEquals(null, anotherKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.DELETED, anotherKeyChange.getChangeType());\n\n    ConfigChange newKeyChange = changeEvent.getChange(newKey);\n    assertEquals(null, newKeyChange.getOldValue());\n    assertEquals(newValue, newKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.ADDED, newKeyChange.getChangeType());\n  }\n","date":"2016-06-07 11:32:12","endLine":116,"groupId":"169","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testOnRepositoryChange","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-apollo-10-0.7/blobInfo/CC_OUT/blobs/e1/90877352da0946e5ee3834d4682640cae30fe6.src","preCode":"  public void testOnRepositoryChange() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    String anotherKey = \"anotherKey\";\n    String anotherValue = \"anotherValue\";\n    someProperties.putAll(ImmutableMap.of(someKey, someValue, anotherKey, anotherValue));\n\n    Properties anotherProperties = new Properties();\n    String newKey = \"newKey\";\n    String newValue = \"newValue\";\n    String someValueNew = \"someValueNew\";\n    anotherProperties.putAll(ImmutableMap.of(someKey, someValueNew, newKey, newValue));\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    ConfigChangeListener someListener = mock(ConfigChangeListener.class);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n    config.addChangeListener(someListener);\n\n    config.onRepositoryChange(someNamespace, anotherProperties);\n\n    ArgumentCaptor<ConfigChangeEvent> captor = ArgumentCaptor.forClass(ConfigChangeEvent.class);\n\n    verify(someListener, times(1)).onChange(captor.capture());\n\n    ConfigChangeEvent changeEvent = captor.getValue();\n\n    assertEquals(someNamespace, changeEvent.getNamespace());\n    assertEquals(3, changeEvent.changedKeys().size());\n\n    ConfigChange someKeyChange = changeEvent.getChange(someKey);\n    assertEquals(someValue, someKeyChange.getOldValue());\n    assertEquals(someValueNew, someKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.MODIFIED, someKeyChange.getChangeType());\n\n    ConfigChange anotherKeyChange = changeEvent.getChange(anotherKey);\n    assertEquals(anotherValue, anotherKeyChange.getOldValue());\n    assertEquals(null, anotherKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.DELETED, anotherKeyChange.getChangeType());\n\n    ConfigChange newKeyChange = changeEvent.getChange(newKey);\n    assertEquals(null, newKeyChange.getOldValue());\n    assertEquals(newValue, newKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.ADDED, newKeyChange.getChangeType());\n  }\n","realPath":"apollo-client/src/test/java/com/ctrip/framework/apollo/internals/SimpleConfigTest.java","repoName":"apollo","snippetEndLine":0,"snippetStartLine":0,"startLine":68,"status":"M"}],"commitId":"4f7ecce202fbf2750f408f02a438761c18a39b2c","commitMessage":"@@@Merge pull request #251 from nobodyiam/client-refactor-merge\n\nrefactor according to code review comments","date":"2016-06-07 11:32:12","modifiedFileCount":"37","status":"M","submitter":"lepdou"},{"authorTime":"2018-09-16 11:00:16","codes":[{"authorDate":"2018-09-16 11:00:16","commitOrder":3,"curCode":"  public void testGetProperty() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    someProperties.setProperty(someKey, someValue);\n\n    someSourceType = ConfigSourceType.LOCAL;\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n    when(configRepository.getSourceType()).thenReturn(someSourceType);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someValue, config.getProperty(someKey, null));\n    assertEquals(someSourceType, config.getSourceType());\n  }\n","date":"2018-09-16 11:00:16","endLine":56,"groupId":"10200","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testGetProperty","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-apollo-10-0.7/blobInfo/CC_OUT/blobs/de/6a1973eec33bcd503840c700ec40f064c337c9.src","preCode":"  public void testGetProperty() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    someProperties.setProperty(someKey, someValue);\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someValue, config.getProperty(someKey, null));\n  }\n","realPath":"apollo-client/src/test/java/com/ctrip/framework/apollo/internals/SimpleConfigTest.java","repoName":"apollo","snippetEndLine":0,"snippetStartLine":0,"startLine":41,"status":"M"},{"authorDate":"2018-09-16 11:00:16","commitOrder":3,"curCode":"  public void testOnRepositoryChange() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    String anotherKey = \"anotherKey\";\n    String anotherValue = \"anotherValue\";\n    someProperties.putAll(ImmutableMap.of(someKey, someValue, anotherKey, anotherValue));\n\n    Properties anotherProperties = new Properties();\n    String newKey = \"newKey\";\n    String newValue = \"newValue\";\n    String someValueNew = \"someValueNew\";\n    anotherProperties.putAll(ImmutableMap.of(someKey, someValueNew, newKey, newValue));\n\n    someSourceType = ConfigSourceType.LOCAL;\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n    when(configRepository.getSourceType()).thenReturn(someSourceType);\n\n    final SettableFuture<ConfigChangeEvent> configChangeFuture = SettableFuture.create();\n    ConfigChangeListener someListener = new ConfigChangeListener() {\n      @Override\n      public void onChange(ConfigChangeEvent changeEvent) {\n        configChangeFuture.set(changeEvent);\n      }\n    };\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n\n    assertEquals(someSourceType, config.getSourceType());\n\n    config.addChangeListener(someListener);\n\n    ConfigSourceType anotherSourceType = ConfigSourceType.REMOTE;\n    when(configRepository.getSourceType()).thenReturn(anotherSourceType);\n\n    config.onRepositoryChange(someNamespace, anotherProperties);\n\n    ConfigChangeEvent changeEvent = configChangeFuture.get(500, TimeUnit.MILLISECONDS);\n\n    assertEquals(someNamespace, changeEvent.getNamespace());\n    assertEquals(3, changeEvent.changedKeys().size());\n\n    ConfigChange someKeyChange = changeEvent.getChange(someKey);\n    assertEquals(someValue, someKeyChange.getOldValue());\n    assertEquals(someValueNew, someKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.MODIFIED, someKeyChange.getChangeType());\n\n    ConfigChange anotherKeyChange = changeEvent.getChange(anotherKey);\n    assertEquals(anotherValue, anotherKeyChange.getOldValue());\n    assertEquals(null, anotherKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.DELETED, anotherKeyChange.getChangeType());\n\n    ConfigChange newKeyChange = changeEvent.getChange(newKey);\n    assertEquals(null, newKeyChange.getOldValue());\n    assertEquals(newValue, newKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.ADDED, newKeyChange.getChangeType());\n\n    assertEquals(anotherSourceType, config.getSourceType());\n  }\n","date":"2018-09-16 11:00:16","endLine":131,"groupId":"10200","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testOnRepositoryChange","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-apollo-10-0.7/blobInfo/CC_OUT/blobs/de/6a1973eec33bcd503840c700ec40f064c337c9.src","preCode":"  public void testOnRepositoryChange() throws Exception {\n    Properties someProperties = new Properties();\n    String someKey = \"someKey\";\n    String someValue = \"someValue\";\n    String anotherKey = \"anotherKey\";\n    String anotherValue = \"anotherValue\";\n    someProperties.putAll(ImmutableMap.of(someKey, someValue, anotherKey, anotherValue));\n\n    Properties anotherProperties = new Properties();\n    String newKey = \"newKey\";\n    String newValue = \"newValue\";\n    String someValueNew = \"someValueNew\";\n    anotherProperties.putAll(ImmutableMap.of(someKey, someValueNew, newKey, newValue));\n\n    when(configRepository.getConfig()).thenReturn(someProperties);\n\n    final SettableFuture<ConfigChangeEvent> configChangeFuture = SettableFuture.create();\n    ConfigChangeListener someListener = new ConfigChangeListener() {\n      @Override\n      public void onChange(ConfigChangeEvent changeEvent) {\n        configChangeFuture.set(changeEvent);\n      }\n    };\n\n    SimpleConfig config = new SimpleConfig(someNamespace, configRepository);\n    config.addChangeListener(someListener);\n\n    config.onRepositoryChange(someNamespace, anotherProperties);\n\n    ConfigChangeEvent changeEvent = configChangeFuture.get(500, TimeUnit.MILLISECONDS);\n\n    assertEquals(someNamespace, changeEvent.getNamespace());\n    assertEquals(3, changeEvent.changedKeys().size());\n\n    ConfigChange someKeyChange = changeEvent.getChange(someKey);\n    assertEquals(someValue, someKeyChange.getOldValue());\n    assertEquals(someValueNew, someKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.MODIFIED, someKeyChange.getChangeType());\n\n    ConfigChange anotherKeyChange = changeEvent.getChange(anotherKey);\n    assertEquals(anotherValue, anotherKeyChange.getOldValue());\n    assertEquals(null, anotherKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.DELETED, anotherKeyChange.getChangeType());\n\n    ConfigChange newKeyChange = changeEvent.getChange(newKey);\n    assertEquals(null, newKeyChange.getOldValue());\n    assertEquals(newValue, newKeyChange.getNewValue());\n    assertEquals(PropertyChangeType.ADDED, newKeyChange.getChangeType());\n  }\n","realPath":"apollo-client/src/test/java/com/ctrip/framework/apollo/internals/SimpleConfigTest.java","repoName":"apollo","snippetEndLine":0,"snippetStartLine":0,"startLine":72,"status":"M"}],"commitId":"9e3aec542eeed1cec46c5930657582a8669c7492","commitMessage":"@@@Merge pull request #1470 from nobodyiam/config-source\n\nadd getSourceType api","date":"2018-09-16 11:00:16","modifiedFileCount":"15","status":"M","submitter":"Jason Song"}]
