[{"authorTime":"2018-07-04 07:26:40","codes":[{"authorDate":"2018-07-04 07:26:40","commitOrder":1,"curCode":"  public void verifySimultaneousPutHAEventWrapperWithRegion() throws Exception {\n    HAContainerWrapper haContainerWrapper = createHAContainerRegion();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","date":"2018-08-02 02:25:34","endLine":317,"groupId":"31785","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"verifySimultaneousPutHAEventWrapperWithRegion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-geode-10-0.7/blobInfo/CC_OUT/blobs/a1/b71a1b2ccc06a5f7a63bee92c465221bcc9bba.src","preCode":"  public void verifySimultaneousPutHAEventWrapperWithRegion() throws Exception {\n    HAContainerWrapper haContainerWrapper = createHAContainerRegion();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","realPath":"geode-core/src/integrationTest/java/org/apache/geode/internal/cache/ha/HARegionQueueIntegrationTest.java","repoName":"geode","snippetEndLine":0,"snippetStartLine":0,"startLine":301,"status":"B"},{"authorDate":"2018-07-04 07:26:40","commitOrder":1,"curCode":"  public void verifySimultaneousPutHAEventWrapperWithMap() throws Exception {\n    HAContainerWrapper haContainerWrapper = new HAContainerMap(new ConcurrentHashMap());\n    when(ccn.getHaContainer()).thenReturn(haContainerWrapper);\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","date":"2018-08-02 02:25:34","endLine":358,"groupId":"31785","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"verifySimultaneousPutHAEventWrapperWithMap","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-geode-10-0.7/blobInfo/CC_OUT/blobs/a1/b71a1b2ccc06a5f7a63bee92c465221bcc9bba.src","preCode":"  public void verifySimultaneousPutHAEventWrapperWithMap() throws Exception {\n    HAContainerWrapper haContainerWrapper = new HAContainerMap(new ConcurrentHashMap());\n    when(ccn.getHaContainer()).thenReturn(haContainerWrapper);\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","realPath":"geode-core/src/integrationTest/java/org/apache/geode/internal/cache/ha/HARegionQueueIntegrationTest.java","repoName":"geode","snippetEndLine":0,"snippetStartLine":0,"startLine":341,"status":"B"}],"commitId":"103b467ab6205f6c9d180d5ad28705ce47c7b5bb","commitMessage":"@@@GEODE-5420: Protect events in HAContainer from premature modification\n\n- Updated putInProgress boolean in HAWrapper to a counter to prevent prematurely setting ClientUpdateMessage to null when events are temporarily queued during a GII or message dispatcher initialization\n- decAndRemoveFromHAContainer only removes when putInProgress counter and ref count are 0\n- Refactored putEventInHARegion/putConditionallyInHAContainer to prevent overwriting an existing entry in the HAContainer.  Also reduces simplifies the code and reduces duplicated logic.\n- Wrote missing basic HARegionQueue unit/integration tests.  and an integration test to capture setting the ClientUpdateMessage property on HAEventWrapper to null prematurely\n- Added new event tracing messages at debug logging level to help track similar issues in the future\n\nCo-authored-by: Ryan McMahon <rmcmahon@pivotal.io>\nCo-authored-by: Lynn Hughes-Godfrey <lhughesgodfrey@pivotal.io>\n","date":"2018-08-02 02:25:34","modifiedFileCount":"8","status":"B","submitter":"Ryan McMahon"},{"authorTime":"2018-12-21 02:06:56","codes":[{"authorDate":"2018-07-04 07:26:40","commitOrder":2,"curCode":"  public void verifySimultaneousPutHAEventWrapperWithRegion() throws Exception {\n    HAContainerWrapper haContainerWrapper = createHAContainerRegion();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","date":"2018-08-02 02:25:34","endLine":317,"groupId":"31785","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"verifySimultaneousPutHAEventWrapperWithRegion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-geode-10-0.7/blobInfo/CC_OUT/blobs/a1/b71a1b2ccc06a5f7a63bee92c465221bcc9bba.src","preCode":"  public void verifySimultaneousPutHAEventWrapperWithRegion() throws Exception {\n    HAContainerWrapper haContainerWrapper = createHAContainerRegion();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","realPath":"geode-core/src/integrationTest/java/org/apache/geode/internal/cache/ha/HARegionQueueIntegrationTest.java","repoName":"geode","snippetEndLine":0,"snippetStartLine":0,"startLine":301,"status":"N"},{"authorDate":"2018-12-21 02:06:56","commitOrder":2,"curCode":"  public void verifySimultaneousPutHAEventWrapperWithMap() throws Exception {\n    HAContainerWrapper haContainerWrapper = (HAContainerWrapper) ccn.getHaContainer();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","date":"2018-12-21 02:06:56","endLine":333,"groupId":"31785","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"verifySimultaneousPutHAEventWrapperWithMap","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-geode-10-0.7/blobInfo/CC_OUT/blobs/f5/4962b4ec42598227bd9c1f8dde157ccdcfcbb9.src","preCode":"  public void verifySimultaneousPutHAEventWrapperWithMap() throws Exception {\n    HAContainerWrapper haContainerWrapper = new HAContainerMap(new ConcurrentHashMap());\n    when(ccn.getHaContainer()).thenReturn(haContainerWrapper);\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","realPath":"geode-core/src/integrationTest/java/org/apache/geode/internal/cache/ha/HARegionQueueIntegrationTest.java","repoName":"geode","snippetEndLine":0,"snippetStartLine":0,"startLine":317,"status":"M"}],"commitId":"c588614471c3c874bd205793fe104c3d2f607a02","commitMessage":"@@@Merge pull request #3013 from apache/feature/GEODE-6143-9\n\nGEODE-6143: remove PowerMock from HARegionQueueIntegrationTest","date":"2018-12-21 02:06:56","modifiedFileCount":"3","status":"M","submitter":"Xiaojian Zhou"},{"authorTime":"2020-04-25 00:20:21","codes":[{"authorDate":"2020-04-25 00:20:21","commitOrder":3,"curCode":"  public void verifySimultaneousPutHAEventWrapperWithRegion() throws Exception {\n    HAContainerWrapper haContainerWrapper = createHAContainerRegion();\n    int numQueues = 30;\n    int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimultaneously(haContainerWrapper, numQueues, numOperations);\n\n    assertThat(haContainerWrapper).hasSize(numOperations);\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertThat(wrapperInContainer.getReferenceCount()).isEqualTo(numQueues);\n    }\n  }\n","date":"2020-04-25 00:20:21","endLine":237,"groupId":"104045","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"verifySimultaneousPutHAEventWrapperWithRegion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-geode-10-0.7/blobInfo/CC_OUT/blobs/47/78608c6fdfe14806a0b76e91c62a288b71148e.src","preCode":"  public void verifySimultaneousPutHAEventWrapperWithRegion() throws Exception {\n    HAContainerWrapper haContainerWrapper = createHAContainerRegion();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","realPath":"geode-core/src/integrationTest/java/org/apache/geode/internal/cache/ha/HARegionQueueIntegrationTest.java","repoName":"geode","snippetEndLine":0,"snippetStartLine":0,"startLine":222,"status":"M"},{"authorDate":"2020-04-25 00:20:21","commitOrder":3,"curCode":"  public void verifySimultaneousPutHAEventWrapperWithMap() throws Exception {\n    HAContainerWrapper haContainerWrapper = (HAContainerWrapper) ccn.getHaContainer();\n    int numQueues = 30;\n    int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimultaneously(haContainerWrapper, numQueues, numOperations);\n\n    assertThat(haContainerWrapper).hasSize(numOperations);\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertThat(wrapperInContainer.getReferenceCount()).isEqualTo(numQueues);\n    }\n  }\n","date":"2020-04-25 00:20:21","endLine":276,"groupId":"104045","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"verifySimultaneousPutHAEventWrapperWithMap","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-geode-10-0.7/blobInfo/CC_OUT/blobs/47/78608c6fdfe14806a0b76e91c62a288b71148e.src","preCode":"  public void verifySimultaneousPutHAEventWrapperWithMap() throws Exception {\n    HAContainerWrapper haContainerWrapper = (HAContainerWrapper) ccn.getHaContainer();\n\n    final int numQueues = 30;\n    final int numOperations = 1000;\n\n    Set<HAEventWrapper> haEventWrappersToValidate =\n        createAndPutHARegionQueuesSimulataneously(haContainerWrapper, numQueues, numOperations);\n\n    assertEquals(numOperations, haContainerWrapper.size());\n\n    for (HAEventWrapper haEventWrapperToValidate : haEventWrappersToValidate) {\n      HAEventWrapper wrapperInContainer =\n          (HAEventWrapper) haContainerWrapper.getKey(haEventWrapperToValidate);\n      assertEquals(numQueues, wrapperInContainer.getReferenceCount());\n    }\n  }\n","realPath":"geode-core/src/integrationTest/java/org/apache/geode/internal/cache/ha/HARegionQueueIntegrationTest.java","repoName":"geode","snippetEndLine":0,"snippetStartLine":0,"startLine":261,"status":"M"}],"commitId":"0a1701e92dc09bcd6b79edd3b52f20ee9e9a867c","commitMessage":"@@@GEODE-7964: Upgrade Mockito to 3.3.3 (#4924)\n\n","date":"2020-04-25 00:20:21","modifiedFileCount":"34","status":"M","submitter":"Kirk Lund"}]
