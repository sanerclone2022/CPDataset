[{"authorTime":"2013-03-08 06:54:59","codes":[{"authorDate":"2013-03-08 06:54:59","commitOrder":1,"curCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            Closeables.closeQuietly(client);\n        }\n    }\n","date":"2013-03-08 06:54:59","endLine":136,"groupId":"1211","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testCuratorWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/d3/b1d2f0c0d871e2eb9650fcc5db9d2c842044aa.src","preCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            Closeables.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":115,"status":"B"},{"authorDate":"2013-03-08 06:54:59","commitOrder":1,"curCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            Closeables.closeQuietly(client);\n        }\n    }\n","date":"2013-03-08 06:54:59","endLine":161,"groupId":"1211","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testZKWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/d3/b1d2f0c0d871e2eb9650fcc5db9d2c842044aa.src","preCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            Closeables.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":140,"status":"B"}],"commitId":"8d32c4738afe4fb6fa5e6fd843b05821ddc2ce88","commitMessage":"@@@Beginning to move everything to Apache\n","date":"2013-03-08 06:54:59","modifiedFileCount":"10","status":"B","submitter":"Jordan Zimmerman"},{"authorTime":"2014-02-04 02:55:50","codes":[{"authorDate":"2014-02-04 02:55:50","commitOrder":2,"curCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","date":"2014-02-04 02:55:50","endLine":154,"groupId":"1211","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testCuratorWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/84/ef0252509b185d33b161785e393897ab8790fa.src","preCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            Closeables.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":133,"status":"M"},{"authorDate":"2014-02-04 02:55:50","commitOrder":2,"curCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","date":"2014-02-04 02:55:50","endLine":179,"groupId":"1211","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testZKWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/84/ef0252509b185d33b161785e393897ab8790fa.src","preCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            Closeables.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":158,"status":"M"}],"commitId":"863eaee2f11fe930601c3da3bce386263fb552c4","commitMessage":"@@@CURATOR-85 - Guava no longer has closeQuietly(). This change adds the implementation internally to Curator\n","date":"2014-02-04 02:55:50","modifiedFileCount":"61","status":"M","submitter":"randgalt"},{"authorTime":"2020-10-20 21:18:25","codes":[{"authorDate":"2020-10-20 21:18:25","commitOrder":3,"curCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","date":"2020-10-20 21:18:25","endLine":172,"groupId":"1211","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testCuratorWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/1d/16450a6c5d09c42c7cec216fa94cfc597fd8d5.src","preCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":151,"status":"M"},{"authorDate":"2020-10-20 21:18:25","commitOrder":3,"curCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","date":"2020-10-20 21:18:25","endLine":197,"groupId":"1211","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testZKWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/1d/16450a6c5d09c42c7cec216fa94cfc597fd8d5.src","preCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            Assert.assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":176,"status":"M"}],"commitId":"7a148288603ae5db0c232142f7dc07d43e01bea3","commitMessage":"@@@CURATOR-582: Migrate to jUnit 5.6 (#372)\n\n","date":"2020-10-20 21:18:25","modifiedFileCount":"125","status":"M","submitter":"Tam?s P?nzes"},{"authorTime":"2021-08-09 20:07:51","codes":[{"authorDate":"2021-08-09 20:07:51","commitOrder":4,"curCode":"  public void testCuratorWatcher() throws Exception\n  {\n    Timing timing = new Timing();\n    \r\n    CuratorWatcher watcher = mock(CuratorWatcher.class);\n    CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(),\n        timing.connection(), new RetryOneTime(1));\n    try {\n      client.start();\n      client.create().forPath(PATH);\n      \r\n      client.getData().usingWatcher(watcher).forPath(PATH);\n      client.getData().usingWatcher(watcher).forPath(PATH);\n      \r\n      client.setData().forPath(PATH, new byte[] {});\n      Mockito.verify(watcher, Mockito.timeout(TIMEOUT_MS).times(1)).process(any(WatchedEvent.class));\n    } finally {\n      CloseableUtils.closeQuietly(client);\n    }\n  }\n","date":"2021-08-09 20:07:51","endLine":161,"groupId":"10108","id":7,"instanceNumber":1,"isCurCommit":1,"methodName":"testCuratorWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/70/e99ca6465e1e0319375fb257f6938d52340dcc.src","preCode":"    public void testCuratorWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountCuratorWatcher watcher = new CountCuratorWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":142,"status":"M"},{"authorDate":"2021-08-09 20:07:51","commitOrder":4,"curCode":"  public void testZKWatcher() throws Exception\n  {\n    Timing timing = new Timing();\n    CountZKWatcher watcher = new CountZKWatcher();\n    CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(),\n        timing.connection(), new RetryOneTime(1));\n    try {\n      client.start();\n      client.create().forPath(PATH);\n      \r\n      client.getData().usingWatcher(watcher).forPath(PATH);\n      client.getData().usingWatcher(watcher).forPath(PATH);\n      \r\n      client.setData().forPath(PATH, new byte[] {});\n      Awaitility.await()\n          .untilAsserted(() -> assertEquals(1, watcher.count.get()));\n    } finally {\n      CloseableUtils.closeQuietly(client);\n    }\n  }\n","date":"2021-08-09 20:07:51","endLine":183,"groupId":"10108","id":8,"instanceNumber":2,"isCurCommit":1,"methodName":"testZKWatcher","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-curator-10-0.7/blobInfo/CC_OUT/blobs/70/e99ca6465e1e0319375fb257f6938d52340dcc.src","preCode":"    public void testZKWatcher() throws Exception\n    {\n        Timing timing = new Timing();\n        CountZKWatcher watcher = new CountZKWatcher();\n        CuratorFramework client = CuratorFrameworkFactory.newClient(server.getConnectString(), timing.session(), timing.connection(), new RetryOneTime(1));\n        try\n        {\n            client.start();\n            client.create().forPath(PATH);\n            \r\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            client.getData().usingWatcher(watcher).forPath(PATH);\n            \r\n            client.setData().forPath(PATH, new byte[]{});\n            timing.sleepABit();\n            assertEquals(1, watcher.count.get());\n        }\n        finally\n        {\n            CloseableUtils.closeQuietly(client);\n        }\n    }\n","realPath":"curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java","repoName":"curator","snippetEndLine":0,"snippetStartLine":0,"startLine":164,"status":"M"}],"commitId":"9aafdec9f2607cc6b652371a7687ed38889ddd2b","commitMessage":"@@@CURATOR-610: Refactor CountCuratorWatcher in TestWatcherIdentity.java ?\n\nFixes [CURATOR-610](https://issues.apache.org/jira/browse/CURATOR-610)\n\n\n Description\nRefactor test class [CountCuratorWatcher](https://github.com/apache/curator/blob/4a11aaef8b190dc220d35b7a91df294bfa06250e/curator-framework/src/test/java/org/apache/curator/framework/imps/TestWatcherIdentity.java#L42) by using mocking object created by Mockito.\n\n<hr>\n\n\n## Key changed/added classes in this PR\n- Create mocking object to replace test subclass `CountCuratorWatcher`.  decouple test from production code.\n- Make test logic more clear by using method stub instead of method overriding.\n- Extract AtomicInteger variable out of the test subclass. Use the extracted variable in assertation statement to check `process(WatchedEvent)` method invocation status.\n\n<hr>\n\nAuthor: wx930910 <wx19930910@gmail.com>\n\nReviewers: Enrico Olivelli <eolivelli@apache.org>\n\nCloses #397 from wx930910/CURATOR-610\n","date":"2021-08-09 20:07:51","modifiedFileCount":"1","status":"M","submitter":"wx930910"}]
