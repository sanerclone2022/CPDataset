[{"authorTime":"2017-10-05 19:03:31","codes":[{"authorDate":"2017-10-05 19:03:31","commitOrder":1,"curCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21() {\n    final HiveSqlDialect hive2_1Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(1)\n            .withNullCollation(NullCollation.LOW));\n\n    final HiveSqlDialect hive2_2_Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(2)\n            .withNullCollation(NullCollation.LOW));\n\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id DESC NULLS FIRST\";\n    sql(query).dialect(hive2_1Dialect).ok(expected);\n    sql(query).dialect(hive2_2_Dialect).ok(expected);\n  }\n","date":"2017-11-03 02:30:26","endLine":409,"groupId":"14683","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d8/9df0b269c97829439d6750bdf51d0e664aa5bd.src","preCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21() {\n    final HiveSqlDialect hive2_1Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(1)\n            .withNullCollation(NullCollation.LOW));\n\n    final HiveSqlDialect hive2_2_Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(2)\n            .withNullCollation(NullCollation.LOW));\n\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id DESC NULLS FIRST\";\n    sql(query).dialect(hive2_1Dialect).ok(expected);\n    sql(query).dialect(hive2_2_Dialect).ok(expected);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":389,"status":"B"},{"authorDate":"2017-10-05 19:03:31","commitOrder":1,"curCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20() {\n    final HiveSqlDialect hive2_1_0_Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(0)\n            .withNullCollation(NullCollation.LOW));\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id IS NULL DESC, product_id DESC\";\n    sql(query).dialect(hive2_1_0_Dialect).ok(expected);\n  }\n","date":"2017-11-03 02:30:26","endLine":423,"groupId":"14683","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d8/9df0b269c97829439d6750bdf51d0e664aa5bd.src","preCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20() {\n    final HiveSqlDialect hive2_1_0_Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(0)\n            .withNullCollation(NullCollation.LOW));\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id IS NULL DESC, product_id DESC\";\n    sql(query).dialect(hive2_1_0_Dialect).ok(expected);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":411,"status":"B"}],"commitId":"45425103c0be0604bb3c6c650f8f13ecb47de519","commitMessage":"@@@[CALCITE-1998] Hive ORDER BY null values (Abbas Gadhia)\n\nMake HiveSqlDialect aware of the version so that it may switch NULLS\nFIRST/NULLS LAST behavior based on version.  Use DatabaseMetadata\nmajor and minor version integer values instead of relying on strings\nto compare versions.\n\nAdd dialect for Google BigQuery.\n\nChange the default NullCollation for MySQL to reflect the correct collation.\n\nOptimize the code generated for NULLS FIRST/LAST based on the order of\nthe sort. If the default sort would return nulls in the same order as\nthe NULLS FIRST/LAST flag.  then we are dropping the emulation of the\nNULLS FIRST/LAST clause.  Change the emulateNulls method to support\nall types of NullCollations\n\nFix javadoc.  restore MySQL calls to ISNULL. (Julian Hyde)\n\nClose apache/calcite#545\n","date":"2017-11-03 02:30:26","modifiedFileCount":"10","status":"B","submitter":"Abbas Gadhia"},{"authorTime":"2019-10-21 19:58:11","codes":[{"authorDate":"2019-10-21 19:58:11","commitOrder":2,"curCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21() {\n    final HiveSqlDialect hive2_1Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(1)\n            .withNullCollation(NullCollation.LOW));\n\n    final HiveSqlDialect hive2_2_Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(2)\n            .withNullCollation(NullCollation.LOW));\n\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id DESC NULLS FIRST\";\n    sql(query).dialect(hive2_1Dialect).ok(expected);\n    sql(query).dialect(hive2_2_Dialect).ok(expected);\n  }\n","date":"2019-10-23 10:33:14","endLine":1218,"groupId":"14683","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/03/1cdb733bb839d94a8497549c9a61c7fefe34ef.src","preCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21() {\n    final HiveSqlDialect hive2_1Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(1)\n            .withNullCollation(NullCollation.LOW));\n\n    final HiveSqlDialect hive2_2_Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(2)\n            .withNullCollation(NullCollation.LOW));\n\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id DESC NULLS FIRST\";\n    sql(query).dialect(hive2_1Dialect).ok(expected);\n    sql(query).dialect(hive2_2_Dialect).ok(expected);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":1198,"status":"M"},{"authorDate":"2019-10-21 19:58:11","commitOrder":2,"curCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20() {\n    final HiveSqlDialect hive2_1_0_Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(0)\n            .withNullCollation(NullCollation.LOW));\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id IS NULL DESC, product_id DESC\";\n    sql(query).dialect(hive2_1_0_Dialect).ok(expected);\n  }\n","date":"2019-10-23 10:33:14","endLine":1232,"groupId":"14683","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/03/1cdb733bb839d94a8497549c9a61c7fefe34ef.src","preCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20() {\n    final HiveSqlDialect hive2_1_0_Dialect =\n        new HiveSqlDialect(SqlDialect.EMPTY_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(0)\n            .withNullCollation(NullCollation.LOW));\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id IS NULL DESC, product_id DESC\";\n    sql(query).dialect(hive2_1_0_Dialect).ok(expected);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":1220,"status":"M"}],"commitId":"ff43dcb95caa251e5fc8120980fc70c8fea8ac40","commitMessage":"@@@[CALCITE-3416] SQL Dialects DEFAULTs should be more extensible\n\n* In each SqlDialect sub-class.  add a new public static final member\nnamed DEFAULT_CONTEXT used to extend the dialect\n* Make SqlDialect.emptyContext private.  we should now always use\nSqlDialect.EMPTY_CONTEXT instead\n","date":"2019-10-23 10:33:14","modifiedFileCount":"32","status":"M","submitter":"yuzhao.cyz"},{"authorTime":"2020-04-02 10:39:10","codes":[{"authorDate":"2020-04-02 10:39:10","commitOrder":3,"curCode":"  @Test void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21() {\n    final HiveSqlDialect hive2_1Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(1)\n            .withNullCollation(NullCollation.LOW));\n\n    final HiveSqlDialect hive2_2_Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(2)\n            .withNullCollation(NullCollation.LOW));\n\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id DESC NULLS FIRST\";\n    sql(query).dialect(hive2_1Dialect).ok(expected);\n    sql(query).dialect(hive2_2_Dialect).ok(expected);\n  }\n","date":"2020-04-06 04:57:49","endLine":1688,"groupId":"101550","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/a7/568223fb7dbbd6fb8b19514d3893973975f662.src","preCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersionGreaterThanOrEq21() {\n    final HiveSqlDialect hive2_1Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(1)\n            .withNullCollation(NullCollation.LOW));\n\n    final HiveSqlDialect hive2_2_Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(2)\n            .withNullCollation(NullCollation.LOW));\n\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id DESC NULLS FIRST\";\n    sql(query).dialect(hive2_1Dialect).ok(expected);\n    sql(query).dialect(hive2_2_Dialect).ok(expected);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":1668,"status":"M"},{"authorDate":"2020-04-02 10:39:10","commitOrder":3,"curCode":"  @Test void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20() {\n    final HiveSqlDialect hive2_1_0_Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(0)\n            .withNullCollation(NullCollation.LOW));\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id IS NULL DESC, product_id DESC\";\n    sql(query).dialect(hive2_1_0_Dialect).ok(expected);\n  }\n","date":"2020-04-06 04:57:49","endLine":1723,"groupId":"101550","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/a7/568223fb7dbbd6fb8b19514d3893973975f662.src","preCode":"  @Test public void testHiveSelectQueryWithOrderByDescAndHighNullsWithVersion20() {\n    final HiveSqlDialect hive2_1_0_Dialect =\n        new HiveSqlDialect(HiveSqlDialect.DEFAULT_CONTEXT\n            .withDatabaseMajorVersion(2)\n            .withDatabaseMinorVersion(0)\n            .withNullCollation(NullCollation.LOW));\n    final String query = \"select \\\"product_id\\\" from \\\"product\\\"\\n\"\n        + \"order by \\\"product_id\\\" desc nulls first\";\n    final String expected = \"SELECT product_id\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"ORDER BY product_id IS NULL DESC, product_id DESC\";\n    sql(query).dialect(hive2_1_0_Dialect).ok(expected);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":1711,"status":"M"}],"commitId":"9492dd4146f63ddc028010d6c4e86f6a5cb29a8d","commitMessage":"@@@[CALCITE-3892] Make junit test classes and methods non-public where possible\n\nPrior to junit 5.  classes and methods had to be public. This is no\nlonger the case.\n\nSome classes need to remain public because they are referenced from\nelsewhere.  or if they use reflection somehow. The remaining 'public'\nkeyword will be informative to maintainers.\n","date":"2020-04-06 04:57:49","modifiedFileCount":"196","status":"M","submitter":"Julian Hyde"}]
