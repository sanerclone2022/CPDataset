[{"authorTime":"2014-11-14 09:39:29","codes":[{"authorDate":"2014-11-14 09:39:29","commitOrder":1,"curCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel),\n            ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(\n            noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE, ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2014-11-14 09:39:34","endLine":137,"groupId":"1110","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testDoubleConversion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/23/0a0bb6b906b0ce8c6e5d86d3b3fa8d3ca45f85.src","preCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel),\n            ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(\n            noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE, ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":83,"status":"B"},{"authorDate":"2014-11-14 09:39:29","commitOrder":1,"curCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"),\n            ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel),\n            ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(\n            noneRel,\n            cluster.traitSetOf(\n                EnumerableConvention.INSTANCE, ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2014-11-14 09:39:34","endLine":205,"groupId":"5083","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testTraitPropagation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/23/0a0bb6b906b0ce8c6e5d86d3b3fa8d3ca45f85.src","preCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"),\n            ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel),\n            ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(\n            noneRel,\n            cluster.traitSetOf(\n                EnumerableConvention.INSTANCE, ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":140,"status":"B"}],"commitId":"a611d645ad754844a39f3d98f5f814f13dbd9404","commitMessage":"@@@[CALCITE-296] Re-organize package structure;\n[CALCITE-419] Naming convention for planner rules\n\nThis change only renames files (and deletes some obsolete files). There are no content changes.\n","date":"2014-11-14 09:39:34","modifiedFileCount":"0","status":"B","submitter":"Julian Hyde"},{"authorTime":"2014-12-14 15:49:02","codes":[{"authorDate":"2014-12-14 15:49:02","commitOrder":2,"curCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2015-02-08 16:45:51","endLine":151,"groupId":"1110","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testDoubleConversion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/66/654dad036c47daad4496b8771ff818aee60290.src","preCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(\n            noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE, ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":98,"status":"M"},{"authorDate":"2014-12-14 15:49:02","commitOrder":2,"curCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2015-02-08 16:45:51","endLine":216,"groupId":"1110","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testTraitPropagation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/66/654dad036c47daad4496b8771ff818aee60290.src","preCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(\n            noneRel,\n            cluster.traitSetOf(\n                EnumerableConvention.INSTANCE, ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":154,"status":"M"}],"commitId":"2709896eb176c14605b1ddc4be57d916ebeb0fe8","commitMessage":"@@@[CALCITE-88] Add collation as a trait and a kind of RelNode metadata\n\n[CALCITE-526] Add EnumerableMergeJoin.  which exploits sorted inputs\n\n[CALCITE-71] Provide a way to declare that tables are sorted\n\n[CALCITE-576] Make RelCollation trait and AbstractRelNode.getCollationList consistent\n\n[CALCITE-581] Add LogicalSort relational expression.  and make Sort abstract\n\n[CALCITE-254] Propagate RelCollation on aliased columns in JoinRule\n\n[CALCITE-569] ArrayIndexOutOfBoundsException when deducing collation\n\nMore efficient algorithm to check for cycles in the tree of equivalence sets.\n\nFilterJoinRule now propagates traits.\n\nOrd.zip returns random-access list.\n\nReplace references to \"Bug#upgrade\" with \"Deprecated // to be removed before ...\"\n\nAdd composite traits (RelCompositeTrait); subsets only ever have a simple trait.  but other RelNodes can have multiple traits.  and appear in each subset that those traits. Each composite trait is canonized within its trait definition.  and each of the component traits.\n\nRename RelTraitSet.subsumes and RelTrait.subsumes to satisfies.\n","date":"2015-02-08 16:45:51","modifiedFileCount":"128","status":"M","submitter":"Julian Hyde"},{"authorTime":"2016-03-09 13:31:20","codes":[{"authorDate":"2016-03-09 13:31:20","commitOrder":3,"curCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2016-07-08 14:44:51","endLine":162,"groupId":"1110","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testDoubleConversion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/78/a0b7c539defdee3a0083b9b3c6dabf9a49bbc0.src","preCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":109,"status":"M"},{"authorDate":"2016-03-09 13:31:20","commitOrder":3,"curCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2016-07-08 14:44:51","endLine":259,"groupId":"1110","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testTraitPropagation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/78/a0b7c539defdee3a0083b9b3c6dabf9a49bbc0.src","preCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = VolcanoPlannerTest.newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":197,"status":"M"}],"commitId":"a3bc0d8ea3c1f320b96a4ab9641becee90a388bc","commitMessage":"@@@[CALCITE-1148] Fix RelTrait conversion (e.g. distribution.  collation) (Minji Kim)\n\nIn the current calcite.  trait conversion is not handled properly.  e.g.\ncollation/distribution traits are not converted (shown by the tests).\nThis patch fixes this issue.\n\nFor each RelCollationTrait.  introduce a new API.  canConvert() which\nshould return true if the conversion from a trait to the other is\npossible.\n\nFor each Convention.  introduce two new APIs.  canConvertConvention()\nreturns true if the convernsion is possible.  and useAbstractConverters()\nreturns true if the trait conversion should be handle via\nAbstractConverters.  By default.  both functions return false.\n\nIn RelSet.  when adding a new RelSubset.  if the convention returns false\nfor useAbstractConverters().  we do not add AbstractConverters.  Even if\nconvention.useAbstractConverters() return true.  we only add\nAbstractConverters if the AbstractConverters can convert (i.e. if\nRelCollationTrait.canConvert() returns true) and the conversion is\nneeded (i.e. if RelTrait.satisfies() returns false).\n\nAdded test cases.\n\nClose apache/calcite#210\n","date":"2016-07-08 14:44:51","modifiedFileCount":"14","status":"M","submitter":"Minji Kim"},{"authorTime":"2020-04-02 10:39:10","codes":[{"authorDate":"2020-04-02 10:39:10","commitOrder":4,"curCode":"  @Test void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2020-04-06 04:57:49","endLine":153,"groupId":"1110","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testDoubleConversion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/84/38ce4cdce7688ee17eee1d6a339a8c618695bb.src","preCode":"  @Test public void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":100,"status":"M"},{"authorDate":"2020-04-02 10:39:10","commitOrder":4,"curCode":"  @Test void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2020-04-06 04:57:49","endLine":250,"groupId":"1110","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testTraitPropagation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/84/38ce4cdce7688ee17eee1d6a339a8c618695bb.src","preCode":"  @Test public void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":188,"status":"M"}],"commitId":"9492dd4146f63ddc028010d6c4e86f6a5cb29a8d","commitMessage":"@@@[CALCITE-3892] Make junit test classes and methods non-public where possible\n\nPrior to junit 5.  classes and methods had to be public. This is no\nlonger the case.\n\nSome classes need to remain public because they are referenced from\nelsewhere.  or if they use reflection somehow. The remaining 'public'\nkeyword will be informative to maintainers.\n","date":"2020-04-06 04:57:49","modifiedFileCount":"196","status":"M","submitter":"Julian Hyde"},{"authorTime":"2020-07-09 05:31:40","codes":[{"authorDate":"2020-07-09 05:31:40","commitOrder":5,"curCode":"  @Test void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(PhysToIteratorConverterRule.INSTANCE);\n    planner.addRule(\n        AltTraitConverterRule.create(ALT_TRAIT, ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(PhysLeafRule.INSTANCE);\n    planner.addRule(IterSingleRule.INSTANCE);\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2020-07-29 02:27:24","endLine":152,"groupId":"101439","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"testDoubleConversion","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/17/4beff933eb7ad29e72202e3748c9e76eaa8204.src","preCode":"  @Test void testDoubleConversion() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":101,"status":"M"},{"authorDate":"2020-07-09 05:31:40","commitOrder":5,"curCode":"  @Test void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(PhysToIteratorConverterRule.INSTANCE);\n    planner.addRule(\n        AltTraitConverterRule.create(ALT_TRAIT, ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(PhysLeafRule.INSTANCE);\n    planner.addRule(IterSingleRule2.INSTANCE);\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","date":"2020-07-29 02:27:24","endLine":247,"groupId":"101439","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"testTraitPropagation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/17/4beff933eb7ad29e72202e3748c9e76eaa8204.src","preCode":"  @Test void testTraitPropagation() {\n    VolcanoPlanner planner = new VolcanoPlanner();\n\n    planner.addRelTraitDef(ConventionTraitDef.INSTANCE);\n    planner.addRelTraitDef(ALT_TRAIT_DEF);\n\n    planner.addRule(new PhysToIteratorConverterRule());\n    planner.addRule(\n        new AltTraitConverterRule(\n            ALT_TRAIT,\n            ALT_TRAIT2,\n            \"AltToAlt2ConverterRule\"));\n    planner.addRule(new PhysLeafRule());\n    planner.addRule(new IterSingleRule2());\n\n    RelOptCluster cluster = newCluster(planner);\n\n    NoneLeafRel noneLeafRel =\n        RelOptUtil.addTrait(\n            new NoneLeafRel(cluster, \"noneLeafRel\"), ALT_TRAIT);\n\n    NoneSingleRel noneRel =\n        RelOptUtil.addTrait(\n            new NoneSingleRel(cluster, noneLeafRel), ALT_TRAIT2);\n\n    RelNode convertedRel =\n        planner.changeTraits(noneRel,\n            cluster.traitSetOf(EnumerableConvention.INSTANCE)\n                .replace(ALT_TRAIT2));\n\n    planner.setRoot(convertedRel);\n    RelNode result = planner.chooseDelegate().findBestExp();\n\n    assertTrue(result instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        result.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        result.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    RelNode child = result.getInputs().get(0);\n    assertTrue(child instanceof IterSingleRel);\n    assertEquals(\n        EnumerableConvention.INSTANCE,\n        child.getTraitSet().getTrait(ConventionTraitDef.INSTANCE));\n    assertEquals(\n        ALT_TRAIT2,\n        child.getTraitSet().getTrait(ALT_TRAIT_DEF));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(\n        (child instanceof AltTraitConverter)\n            || (child instanceof PhysToIteratorConverter));\n\n    child = child.getInputs().get(0);\n    assertTrue(child instanceof PhysLeafRel);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/plan/volcano/VolcanoPlannerTraitTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":187,"status":"M"}],"commitId":"998cd83ebe2fcd7ff3ee565299fed6e199269715","commitMessage":"@@@[CALCITE-3923] Refactor how planner rules are parameterized\n\nCreate operands using a builder interface.  OperandBuilder.  and\ndeprecate methods RelOptRule.operand etc.\n\nThe change is backwards compatible.  in the sense that\nexisting rule constructors are deprecated but still work.\nFrom now on.  to create rules.  call RelOptRule.Config.toRule()\n(which calls the rule's (Config) constructor).\n\nSub-classes of ConverterRule are a little different.  They\ndon't need their own sub-class of Config.  You just need to\ncall Config.withRuleFactory to specify the constructor of the\nsub-class of ConverterRule.\n\nMove rule instances into holder classes such as CoreRules. \nMaterializedViewRules. Deprecate existing rule INSTANCE fields\n(to be removed in 1.25). Deprecate previous rule constructors\n(to be removed in 2.0).\n\nDescribe how to write rules in howto and tutorial.\n\nRemove rule instances marked 'deprecated.  to be removed before\n1.25'.\n\nClose apache/calcite#2024\n","date":"2020-07-29 02:27:24","modifiedFileCount":"191","status":"M","submitter":"Julian Hyde"}]
