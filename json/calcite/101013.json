[{"authorTime":"2016-12-05 00:41:32","codes":[{"authorDate":"2016-12-05 00:41:32","commitOrder":1,"curCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try {\n          tableModifyTestDbInitializer(connection.createStatement());\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","date":"2016-12-08 00:34:46","endLine":724,"groupId":"12635","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testTableModifyInsertWithSubQuery","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/2e/fea7bec50f215606c9933d65c574a961e8c435.src","preCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try {\n          tableModifyTestDbInitializer(connection.createStatement());\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":685,"status":"B"},{"authorDate":"2016-12-05 00:41:32","commitOrder":1,"curCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try {\n          tableModifyTestDbInitializer(connection.createStatement());\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","date":"2016-12-08 00:34:46","endLine":755,"groupId":"12635","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testTableModifyUpdate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/2e/fea7bec50f215606c9933d65c574a961e8c435.src","preCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try {\n          tableModifyTestDbInitializer(connection.createStatement());\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":726,"status":"B"}],"commitId":"02752fe78f817ed317b8873d2f4c7b79bfe8b9b5","commitMessage":"@@@[CALCITE-1527] Support DML in the JDBC adapter (Christian Tzolov)\n\nExtend CalcisteAssert to verify DML statements;\nResolve the RowType for SqlNode UPDATE consistently with the INSERT and DELETE;\nAdd field sourceExpressionList field to TableModify;\nImplement DML for JDBC Adapter (i.e. DmlRel-To-Sql);\nMake sure the ResultSetEnumerable keeps the statment/connection open.\n\nUse same code path for INSERT ... VALUES and INSERT ... SELECT;\nfix pretty-printing of INSERT ... VALUES (Julian Hyde).\n","date":"2016-12-08 00:34:46","modifiedFileCount":"28","status":"B","submitter":"Christian Tzolov"},{"authorTime":"2016-12-17 02:22:01","codes":[{"authorDate":"2016-12-17 02:22:01","commitOrder":2,"curCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","date":"2016-12-17 02:41:41","endLine":757,"groupId":"15368","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testTableModifyInsertWithSubQuery","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d2/4d596a2296ba29e45e0f3642f910cd174e09f0.src","preCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try {\n          tableModifyTestDbInitializer(connection.createStatement());\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":719,"status":"M"},{"authorDate":"2016-12-17 02:22:01","commitOrder":2,"curCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","date":"2016-12-17 02:41:41","endLine":787,"groupId":"8928","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testTableModifyUpdate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d2/4d596a2296ba29e45e0f3642f910cd174e09f0.src","preCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try {\n          tableModifyTestDbInitializer(connection.createStatement());\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":759,"status":"M"}],"commitId":"d6940a1a9384b55f1c94de9ea4d2aaab4dac5b83","commitMessage":"@@@Add lock to JdbcAdapterTest.  to ensure that tests that modify data run in series\n","date":"2016-12-17 02:41:41","modifiedFileCount":"1","status":"M","submitter":"Julian Hyde"},{"authorTime":"2017-01-23 17:38:12","codes":[{"authorDate":"2017-01-23 17:38:12","commitOrder":3,"curCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw new RuntimeException(e);\n        }\n      }\n    });\n  }\n","date":"2017-01-26 03:00:12","endLine":759,"groupId":"15368","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testTableModifyInsertWithSubQuery","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/61/dee87e6b5e453d1ddfd4ad72e3aba9d217a9c3.src","preCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":721,"status":"M"},{"authorDate":"2017-01-23 17:38:12","commitOrder":3,"curCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw new RuntimeException(e);\n        }\n      }\n    });\n  }\n","date":"2017-01-26 03:00:12","endLine":789,"groupId":"8928","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testTableModifyUpdate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/61/dee87e6b5e453d1ddfd4ad72e3aba9d217a9c3.src","preCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw Throwables.propagate(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":761,"status":"M"}],"commitId":"603648bc2466ab699fa6646ffc1ad717b8c11880","commitMessage":"@@@[CALCITE-1597] Obsolete Util.newInternal.  .pre.  .post.  .permAssert and Throwables.propagate\n\nReplace Util.newInternal with new AssertionError in some contexts. \nnew RuntimeException in others. Replace methods pre.  pos.  permAssert\nin Util with methods in Preconditions.\n\nRemove uses of Throwables.propagate and .propagateIfPossible because\nthey are deprecated as of Guava 20. Create method\nUtil.throwIfUnchecked because we can't use Guava's\nThrowables.throwIfUnchecked yet.\n","date":"2017-01-26 03:00:12","modifiedFileCount":"82","status":"M","submitter":"Julian Hyde"},{"authorTime":"2018-07-06 04:21:59","codes":[{"authorDate":"2018-07-06 04:21:59","commitOrder":4,"curCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n            + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n            + \" \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n        final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n            + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666)\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n      } catch (SQLException e) {\n        throw new RuntimeException(e);\n      }\n    });\n  }\n","date":"2018-07-09 01:16:26","endLine":794,"groupId":"8924","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testTableModifyInsertWithSubQuery","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/1b/f0f7f368951b9269512a397c72d13c26585526.src","preCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n              + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n              + \" \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n          final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n              + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n              + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n              + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n              + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n              + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \"WHERE \\\"store_id\\\" = 666)\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw new RuntimeException(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":759,"status":"M"},{"authorDate":"2018-07-06 04:21:59","commitOrder":4,"curCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \" SET \\\"account_id\\\"=888\\n\"\n            + \" WHERE \\\"store_id\\\"=666\\n\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n        final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" SET \\\"account_id\\\" = 888\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n        return null;\n      } catch (SQLException e) {\n        throw new RuntimeException(e);\n      }\n    });\n  }\n","date":"2018-07-09 01:16:26","endLine":822,"groupId":"8928","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testTableModifyUpdate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/1b/f0f7f368951b9269512a397c72d13c26585526.src","preCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(new Function<CalciteConnection, Void>() {\n      public Void apply(CalciteConnection connection) {\n        try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n          final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n              + \" SET \\\"account_id\\\"=888\\n\"\n              + \" WHERE \\\"store_id\\\"=666\\n\";\n          final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n              + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n              + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n              + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n              + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n          final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n              + \" SET \\\"account_id\\\" = 888\\n\"\n              + \"WHERE \\\"store_id\\\" = 666\";\n          that.query(sql)\n              .explainContains(explain)\n              .planUpdateHasSql(jdbcSql, 1);\n          return null;\n        } catch (SQLException e) {\n          throw new RuntimeException(e);\n        }\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":796,"status":"M"}],"commitId":"d59b639d27da704f00eff616324a2c04aa06f84c","commitMessage":"@@@[CALCITE-2259] Allow Java 8 syntax\n\nIn summary: use lambdas where possible.  switch from Guava function\ntypes to Java function types or lambdas.  but continue to use Guava\ncomponents (such as immutable collections and cache) that have no\nequivalent in the Java runtime.\n\n1. Change single-abstract-method (SAM) classes to lambdas. Preserve\nformatting wherever possible.\n\n2. Change AssertQuery.returns argument type from Guava Function to Java\nConsumer. If you are using a lambda and see 'returns is deprecated'. \nremove the 'return null;' line.  and the lambda will become a Consumer\n(whose return is void).\n\n3. Change RelOptRuleOperand and RelOptRule.operand methods to take Java\nPredicate rather than Guava Predicate.\n\n4. Change the argument of Hook.add and .addThread from Guava Function to\nJava Consumer.\n\n5. Change 'list.toArray(new T[list.size()])' to 'list.toArray(new T[0])'\nbecause the latter is simpler.  and just as efficient on recent Java\nversions.\n\n6. Resource references; change \"try (Closeable ignore = foo())\" to \"try\n  (foo())\".  especially uses of TryThreadLocal and Hook.Closeable.\n\n7. Convert linq4j Function1 to java Function.  Function2 to java BiFunction\n\n8. Fix occurrences of Intellij's \"Explicit type can be replaced with\n<>\" inspection. (Occurs for \"List<String> list = new\nArrayList<String>();\".)\n\n9. Change Guava Preconditions.checkNotNull to Java\nObjects.requireNonNull. (Kevin Risden)\n\n10. Break out anonymous classes and fix dependency problems.\n\n11. Use CacheLoader.of(Function) where possible.\n\n12. Replace sub-classes of ThreadLocal with ThreadLocal.withInitial().\n\n13. Replace Guava collection methods with calls to Java collection types. \nfor example replace Lists.newArrayList() with new ArrayList<>(). \nMaps.newHashSet() with new HashSet<>().  similarly Sets.\n\n14. Replace Guava Joiner with String.join.\n\n15. Replace Collections.emptyList() with ImmutableList.of() in a few\nplaces.\n\nFor backwards compatibility.  we preserved (and deprecated) the old\nmethods that used Guava types. In a few cases where new and old have\nthe same signature (after erasure).  we could not add a method with the\nsame name.  so we gave the new method a \"J\" suffix. Examples include\nHook.property and .propertyJ.  RelOptRule.operand and .operandJ.\n\nIn test code.  we have not slavishly ensured backwards compatibility.\n\nWe do not intend to remove uses of Guava's immutable collections.\n\nWe have ignored Intellij's \"Pseudo functional style code\" inspection\nmost of the time.  but in a few cases have converted Lists.transform(). \nIterables.transform().  and Iterables.filter() into Java streams. Use\nthe Util.toImmutableList() collector if the result is to be an\nimmutable list. Use Util.transform() rather than Lists.transform()\nif you have a Java function rather than a Guava function or lambda.\n\nNot covered in this change (might be done in future):\n* Convert Collections.sort(list) to list.sort.\n* Review uses of 'for (Map.Entry<K.  V> e : map.entrySet())' and see\n  whether it makes sense to convert to 'map.forEach((k.  v) ->\n  ...)'. Intellij inspection is called 'Replace with Map.forEach'.\n\nBreaking changes:\n* LatticeStatisticProvider.Factory.  result of RexUtil.notFun().  and\n  arguments to Mappings.target() are Function (was Guava.  now Java)\n* Argument to SqlSpecialOperator.TokenSequence.parser() is Predicate\n  (was Guava.  now Java)\n* AggregateNode.AccumulatorFactory extends Supplier (was Guava.  now Java)\n","date":"2018-07-09 01:16:26","modifiedFileCount":"514","status":"M","submitter":"Julian Hyde"},{"authorTime":"2019-02-14 04:35:36","codes":[{"authorDate":"2019-02-14 04:35:36","commitOrder":5,"curCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n            + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n            + \" \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n        final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n            + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666)\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n      } catch (SQLException e) {\n        throw TestUtil.rethrow(e);\n      }\n    });\n  }\n","date":"2019-02-27 15:04:26","endLine":822,"groupId":"8924","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"testTableModifyInsertWithSubQuery","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/9a/65ff35c35afd7969351833158de288a0084ab3.src","preCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n            + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n            + \" \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n        final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n            + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666)\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n      } catch (SQLException e) {\n        throw new RuntimeException(e);\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":787,"status":"M"},{"authorDate":"2019-02-14 04:35:36","commitOrder":5,"curCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \" SET \\\"account_id\\\"=888\\n\"\n            + \" WHERE \\\"store_id\\\"=666\\n\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n        final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" SET \\\"account_id\\\" = 888\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n        return null;\n      } catch (SQLException e) {\n        throw TestUtil.rethrow(e);\n      }\n    });\n  }\n","date":"2019-02-27 15:04:26","endLine":850,"groupId":"8928","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"testTableModifyUpdate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/9a/65ff35c35afd7969351833158de288a0084ab3.src","preCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \" SET \\\"account_id\\\"=888\\n\"\n            + \" WHERE \\\"store_id\\\"=666\\n\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n        final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" SET \\\"account_id\\\" = 888\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n        return null;\n      } catch (SQLException e) {\n        throw new RuntimeException(e);\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":824,"status":"M"}],"commitId":"ebafff1ede5921901b322872693bf1dbdf09fc8d","commitMessage":"@@@[CALCITE-2878] Avoid use of new RuntimeException(e) in tests\n\nnew RuntimeException(e) adds very little info in tests.  and it makes stacktraces harder to read.\nSo it makes sense to just sneaky-throw in those cases.  especially for test purposes.\n","date":"2019-02-27 15:04:26","modifiedFileCount":"38","status":"M","submitter":"Vladimir Sitnikov"},{"authorTime":"2020-04-02 10:39:10","codes":[{"authorDate":"2020-04-02 10:39:10","commitOrder":6,"curCode":"  @Test void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n            + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n            + \" \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n        final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n            + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666)\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n      } catch (SQLException e) {\n        throw TestUtil.rethrow(e);\n      }\n    });\n  }\n","date":"2020-04-06 04:57:49","endLine":905,"groupId":"101013","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"testTableModifyInsertWithSubQuery","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/93/d9225e24795985dc38bb15e55325e153eec03d.src","preCode":"  @Test public void testTableModifyInsertWithSubQuery() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"(\\n\"\n            + \" \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"SELECT  \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1, \\\"category_id\\\", \\\"currency_id\\\",\"\n            + \" \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[INSERT], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[+($3, 1)], category_id=[$4], currency_id=[$5], amount=[$6])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\\n\";\n        final String jdbcSql = \"INSERT INTO \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" (\\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\", \\\"time_id\\\",\"\n            + \" \\\"category_id\\\", \\\"currency_id\\\", \\\"amount\\\")\\n\"\n            + \"(SELECT \\\"store_id\\\", \\\"account_id\\\", \\\"exp_date\\\",\"\n            + \" \\\"time_id\\\" + 1 AS \\\"time_id\\\", \\\"category_id\\\",\"\n            + \" \\\"currency_id\\\", \\\"amount\\\"\\n\"\n            + \"FROM \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \"WHERE \\\"store_id\\\" = 666)\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n      } catch (SQLException e) {\n        throw TestUtil.rethrow(e);\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":870,"status":"M"},{"authorDate":"2020-04-02 10:39:10","commitOrder":6,"curCode":"  @Test void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \" SET \\\"account_id\\\"=888\\n\"\n            + \" WHERE \\\"store_id\\\"=666\\n\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n        final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" SET \\\"account_id\\\" = 888\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n        return null;\n      } catch (SQLException e) {\n        throw TestUtil.rethrow(e);\n      }\n    });\n  }\n","date":"2020-04-06 04:57:49","endLine":933,"groupId":"101013","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"testTableModifyUpdate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/93/d9225e24795985dc38bb15e55325e153eec03d.src","preCode":"  @Test public void testTableModifyUpdate() throws Exception {\n    final AssertThat that = CalciteAssert\n        .model(JdbcTest.FOODMART_MODEL)\n        .enable(CalciteAssert.DB == DatabaseInstance.HSQLDB);\n\n    that.doWithConnection(connection -> {\n      try (LockWrapper ignore = exclusiveCleanDb(connection)) {\n        final String sql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\\n\"\n            + \" SET \\\"account_id\\\"=888\\n\"\n            + \" WHERE \\\"store_id\\\"=666\\n\";\n        final String explain = \"PLAN=JdbcToEnumerableConverter\\n\"\n            + \"  JdbcTableModify(table=[[foodmart, expense_fact]], operation=[UPDATE], updateColumnList=[[account_id]], sourceExpressionList=[[888]], flattened=[false])\\n\"\n            + \"    JdbcProject(store_id=[$0], account_id=[$1], exp_date=[$2], time_id=[$3], category_id=[$4], currency_id=[$5], amount=[$6], EXPR$0=[888])\\n\"\n            + \"      JdbcFilter(condition=[=($0, 666)])\\n\"\n            + \"        JdbcTableScan(table=[[foodmart, expense_fact]])\";\n        final String jdbcSql = \"UPDATE \\\"foodmart\\\".\\\"expense_fact\\\"\"\n            + \" SET \\\"account_id\\\" = 888\\n\"\n            + \"WHERE \\\"store_id\\\" = 666\";\n        that.query(sql)\n            .explainContains(explain)\n            .planUpdateHasSql(jdbcSql, 1);\n        return null;\n      } catch (SQLException e) {\n        throw TestUtil.rethrow(e);\n      }\n    });\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/JdbcAdapterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":907,"status":"M"}],"commitId":"9492dd4146f63ddc028010d6c4e86f6a5cb29a8d","commitMessage":"@@@[CALCITE-3892] Make junit test classes and methods non-public where possible\n\nPrior to junit 5.  classes and methods had to be public. This is no\nlonger the case.\n\nSome classes need to remain public because they are referenced from\nelsewhere.  or if they use reflection somehow. The remaining 'public'\nkeyword will be informative to maintainers.\n","date":"2020-04-06 04:57:49","modifiedFileCount":"196","status":"M","submitter":"Julian Hyde"}]
