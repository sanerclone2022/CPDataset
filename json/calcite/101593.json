[{"authorTime":"2020-01-30 14:49:20","codes":[{"authorDate":"2020-01-30 14:49:20","commitOrder":1,"curCode":"  @Test void testCubeWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by cube(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH CUBE\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withSpark()\n        .ok(expectedInSpark)\n        .withPresto()\n        .ok(expectedPresto);\n  }\n","date":"2020-06-11 15:17:17","endLine":4768,"groupId":"16190","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testCubeWithGroupBy","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d8/681dbcb1b9da8a56f6dc773d995c57e1d9626f.src","preCode":"  @Test void testCubeWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by cube(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH CUBE\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withSpark()\n        .ok(expectedInSpark)\n        .withPresto()\n        .ok(expectedPresto);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":4749,"status":"B"},{"authorDate":"2020-01-30 14:49:20","commitOrder":1,"curCode":"  @Test void testRollupWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by rollup(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH ROLLUP\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withSpark()\n        .ok(expectedInSpark)\n        .withPresto()\n        .ok(expectedPresto);\n  }\n","date":"2020-06-11 15:17:17","endLine":4789,"groupId":"16191","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testRollupWithGroupBy","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d8/681dbcb1b9da8a56f6dc773d995c57e1d9626f.src","preCode":"  @Test void testRollupWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by rollup(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH ROLLUP\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withSpark()\n        .ok(expectedInSpark)\n        .withPresto()\n        .ok(expectedPresto);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":4770,"status":"B"}],"commitId":"f577b7e3d91191051cfdaade27e0a74f3603648a","commitMessage":"@@@[CALCITE-3724] Presto dialect implementation\n\nFixup (by Danny):\n- Add a new tool RelToSqlConverterUtil#specialOperatorByName and remove\nClickHouseSqlDialect.CLICKHOUSE_SUBSTRING\n- Remove the common code in PrestoSqlDialect and reuse codes from other\ndialect instances\n\nclose apache#calcite#1776\n","date":"2020-06-11 15:17:17","modifiedFileCount":"5","status":"B","submitter":"XuQianJin-Stars"},{"authorTime":"2021-08-12 14:23:53","codes":[{"authorDate":"2021-08-12 14:23:53","commitOrder":2,"curCode":"  @Test void testCubeWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by cube(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH CUBE\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withPresto().ok(expectedPresto)\n        .withSpark().ok(expectedInSpark);\n  }\n","date":"2021-08-14 15:52:54","endLine":5427,"groupId":"101593","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testCubeWithGroupBy","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/98/f75c93796391bbde612ea6420ab122a1868587.src","preCode":"  @Test void testCubeWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by cube(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH CUBE\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY CUBE(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withSpark()\n        .ok(expectedInSpark)\n        .withPresto()\n        .ok(expectedPresto);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":5410,"status":"M"},{"authorDate":"2021-08-12 14:23:53","commitOrder":2,"curCode":"  @Test void testRollupWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by rollup(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH ROLLUP\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withPresto().ok(expectedPresto)\n        .withSpark().ok(expectedSpark);\n  }\n","date":"2021-08-14 15:52:54","endLine":5446,"groupId":"101593","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testRollupWithGroupBy","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/98/f75c93796391bbde612ea6420ab122a1868587.src","preCode":"  @Test void testRollupWithGroupBy() {\n    final String query = \"select count(*) \"\n        + \"from \\\"foodmart\\\".\\\"product\\\" \"\n        + \"group by rollup(\\\"product_id\\\",\\\"product_class_id\\\")\";\n    final String expected = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    final String expectedInSpark = \"SELECT COUNT(*)\\n\"\n        + \"FROM foodmart.product\\n\"\n        + \"GROUP BY product_id, product_class_id WITH ROLLUP\";\n    final String expectedPresto = \"SELECT COUNT(*)\\n\"\n        + \"FROM \\\"foodmart\\\".\\\"product\\\"\\n\"\n        + \"GROUP BY ROLLUP(\\\"product_id\\\", \\\"product_class_id\\\")\";\n    sql(query)\n        .ok(expected)\n        .withSpark()\n        .ok(expectedInSpark)\n        .withPresto()\n        .ok(expectedPresto);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":5429,"status":"M"}],"commitId":"dff28d1ce49871a451c7ff3e740259441da7c72a","commitMessage":"@@@Cosmetic\n\nIn RelToSqlConverterTest. \nmerge methods that test the same query in several dialects;\nmerge '.withXxx().ok(expectedXxx)' into one line. \nand sort such lines alphabetically;\nnormalize 'expectedPostgreSQL' and 'expectedPostgreSql' to\n'expectedPostgresql'.  and so forth.\n","date":"2021-08-14 15:52:54","modifiedFileCount":"2","status":"M","submitter":"Julian Hyde"}]
