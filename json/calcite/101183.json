[{"authorTime":"2019-03-27 14:58:58","codes":[{"authorDate":"2019-03-27 14:58:58","commitOrder":1,"curCode":"  @Test public void testWindowFunctionsIgnoreNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ IGNORE NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ IGNORE NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","date":"2019-04-01 05:42:24","endLine":4283,"groupId":"10150","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testWindowFunctionsIgnoreNulls","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/e7/f3691d70f0c29a648769039d6307ffe2297109.src","preCode":"  @Test public void testWindowFunctionsIgnoreNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ IGNORE NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ IGNORE NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/SqlValidatorTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":4247,"status":"B"},{"authorDate":"2019-03-27 14:58:58","commitOrder":1,"curCode":"  @Test public void testWindowFunctionsRespectNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ RESPECT NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ RESPECT NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","date":"2019-04-01 05:42:24","endLine":4324,"groupId":"10150","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testWindowFunctionsRespectNulls","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/e7/f3691d70f0c29a648769039d6307ffe2297109.src","preCode":"  @Test public void testWindowFunctionsRespectNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ RESPECT NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ RESPECT NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ RESPECT NULLS \\n\"\n        + \" from emp\").fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/SqlValidatorTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":4288,"status":"B"}],"commitId":"d7946a94adfd2e788f5d324910944dd65dab11ee","commitMessage":"@@@[CALCITE-883] Support RESPECT NULLS.  IGNORE NULLS option for LEAD.  LAG.  FIRST_VALUE.  LAST_VALUE.  NTH_VALUE functions (Chunwei Lei)\n\nIGNORE NULLS works in the parser and validator but not at runtime.\n\nWe have changed the Rex model support for aggregate functions even\nthough today it is only valid for windowed functions.\n\nFix javadoc error on JDK 8.\n\nClose apache/calcite#1108\n","date":"2019-04-01 05:42:24","modifiedFileCount":"38","status":"B","submitter":"Chunwei Lei"},{"authorTime":"2020-04-02 10:39:10","codes":[{"authorDate":"2020-04-02 10:39:10","commitOrder":2,"curCode":"  @Test void testWindowFunctionsIgnoreNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ IGNORE NULLS\\n\"\n        + \" from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ IGNORE NULLS\\n\"\n        + \" from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","date":"2020-04-06 04:57:49","endLine":4217,"groupId":"101183","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testWindowFunctionsIgnoreNulls","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/b6/f9115009e28a63267b183e3a0a9a5e7f343a61.src","preCode":"  @Test public void testWindowFunctionsIgnoreNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ IGNORE NULLS over (w)\\n\"\n        + \" from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ IGNORE NULLS\\n\"\n        + \" from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ IGNORE NULLS\\n\"\n        + \" from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/SqlValidatorTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":4177,"status":"M"},{"authorDate":"2020-04-02 10:39:10","commitOrder":2,"curCode":"  @Test void testWindowFunctionsRespectNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ RESPECT NULLS\\n\"\n        + \"from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ RESPECT NULLS\\n\"\n        + \"from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","date":"2020-04-06 04:57:49","endLine":4262,"groupId":"101183","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testWindowFunctionsRespectNulls","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/b6/f9115009e28a63267b183e3a0a9a5e7f343a61.src","preCode":"  @Test public void testWindowFunctionsRespectNulls() {\n    winSql(\"select lead(sal, 4) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lead(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select lag(sal, 4) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select first_value(sal) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select last_value(sal) RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\").ok();\n\n    winSql(\"select ^sum(sal)^ RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'SUM'\");\n\n    winSql(\"select ^count(sal)^ RESPECT NULLS over (w)\\n\"\n        + \"from emp window w as (order by empno)\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'COUNT'\");\n\n    winSql(\"select ^avg(sal)^ RESPECT NULLS\\n\"\n        + \"from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'AVG'\");\n\n    winSql(\"select ^abs(sal)^ RESPECT NULLS\\n\"\n        + \"from emp\")\n        .fails(\"Cannot specify IGNORE NULLS or RESPECT NULLS following 'ABS'\");\n  }\n","realPath":"core/src/test/java/org/apache/calcite/test/SqlValidatorTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":4222,"status":"M"}],"commitId":"9492dd4146f63ddc028010d6c4e86f6a5cb29a8d","commitMessage":"@@@[CALCITE-3892] Make junit test classes and methods non-public where possible\n\nPrior to junit 5.  classes and methods had to be public. This is no\nlonger the case.\n\nSome classes need to remain public because they are referenced from\nelsewhere.  or if they use reflection somehow. The remaining 'public'\nkeyword will be informative to maintainers.\n","date":"2020-04-06 04:57:49","modifiedFileCount":"196","status":"M","submitter":"Julian Hyde"}]
