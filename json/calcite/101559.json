[{"authorTime":"2018-01-30 21:13:12","codes":[{"authorDate":"2018-01-30 21:13:12","commitOrder":1,"curCode":"  @Test public void testFloorWeek() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO WEEK) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toMonday(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(10), \"\n        + \"DATEADD(day, - (6 + DATEPART(weekday, [hire_date] )) % 7, [hire_date] ), 126))\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT STR_TO_DATE(DATE_FORMAT(`hire_date` , '%x%v-1'), \"\n        + \"'%x%v-%w')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","date":"2020-04-17 16:35:48","endLine":2881,"groupId":"5519","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testFloorWeek","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/9e/5307061dda10e557d113018d29b22ba600df5d.src","preCode":"  @Test public void testFloorWeek() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO WEEK) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toMonday(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(10), \"\n        + \"DATEADD(day, - (6 + DATEPART(weekday, [hire_date] )) % 7, [hire_date] ), 126))\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT STR_TO_DATE(DATE_FORMAT(`hire_date` , '%x%v-1'), \"\n        + \"'%x%v-%w')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":2864,"status":"B"},{"authorDate":"2018-01-30 21:13:12","commitOrder":1,"curCode":"  @Test public void testFloorMonth() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO MONTH) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toStartOfMonth(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(7), [hire_date] , \"\n        + \"126)+'-01')\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT DATE_FORMAT(`hire_date`, '%Y-%m-01')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","date":"2020-04-17 16:35:48","endLine":3022,"groupId":"5519","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testFloorMonth","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/9e/5307061dda10e557d113018d29b22ba600df5d.src","preCode":"  @Test public void testFloorMonth() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO MONTH) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toStartOfMonth(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(7), [hire_date] , \"\n        + \"126)+'-01')\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT DATE_FORMAT(`hire_date`, '%Y-%m-01')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":3006,"status":"B"}],"commitId":"39e58566c1ac02824d99ae9260d3315539efd57e","commitMessage":"@@@[CALCITE-2157] ClickHouse dialect implementation (Chris Baynes)\n\nclose apache/calcite#618\n","date":"2020-04-17 16:35:48","modifiedFileCount":"3","status":"B","submitter":"Chris Baynes"},{"authorTime":"2020-01-30 14:49:20","codes":[{"authorDate":"2020-01-30 14:49:20","commitOrder":2,"curCode":"  @Test void testFloorWeek() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO WEEK) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toMonday(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(10), \"\n        + \"DATEADD(day, - (6 + DATEPART(weekday, [hire_date] )) % 7, [hire_date] ), 126))\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT STR_TO_DATE(DATE_FORMAT(`hire_date` , '%x%v-1'), \"\n        + \"'%x%v-%w')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","date":"2020-06-11 15:17:17","endLine":2968,"groupId":"101559","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testFloorWeek","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d8/681dbcb1b9da8a56f6dc773d995c57e1d9626f.src","preCode":"  @Test public void testFloorWeek() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO WEEK) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toMonday(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(10), \"\n        + \"DATEADD(day, - (6 + DATEPART(weekday, [hire_date] )) % 7, [hire_date] ), 126))\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT STR_TO_DATE(DATE_FORMAT(`hire_date` , '%x%v-1'), \"\n        + \"'%x%v-%w')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":2951,"status":"M"},{"authorDate":"2020-01-30 14:49:20","commitOrder":2,"curCode":"  @Test void testFloorMonth() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO MONTH) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toStartOfMonth(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(7), [hire_date] , \"\n        + \"126)+'-01')\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT DATE_FORMAT(`hire_date`, '%Y-%m-01')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","date":"2020-06-11 15:17:17","endLine":3109,"groupId":"101559","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testFloorMonth","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-calcite-10-0.7/blobInfo/CC_OUT/blobs/d8/681dbcb1b9da8a56f6dc773d995c57e1d9626f.src","preCode":"  @Test public void testFloorMonth() {\n    final String query = \"SELECT floor(\\\"hire_date\\\" TO MONTH) FROM \\\"employee\\\"\";\n    final String expectedClickHouse = \"SELECT toStartOfMonth(`hire_date`)\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    final String expectedMssql = \"SELECT CONVERT(DATETIME, CONVERT(VARCHAR(7), [hire_date] , \"\n        + \"126)+'-01')\\n\"\n        + \"FROM [foodmart].[employee]\";\n    final String expectedMysql = \"SELECT DATE_FORMAT(`hire_date`, '%Y-%m-01')\\n\"\n        + \"FROM `foodmart`.`employee`\";\n    sql(query)\n        .withClickHouse()\n        .ok(expectedClickHouse)\n        .withMssql()\n        .ok(expectedMssql)\n        .withMysql()\n        .ok(expectedMysql);\n  }\n","realPath":"core/src/test/java/org/apache/calcite/rel/rel2sql/RelToSqlConverterTest.java","repoName":"calcite","snippetEndLine":0,"snippetStartLine":0,"startLine":3093,"status":"M"}],"commitId":"f577b7e3d91191051cfdaade27e0a74f3603648a","commitMessage":"@@@[CALCITE-3724] Presto dialect implementation\n\nFixup (by Danny):\n- Add a new tool RelToSqlConverterUtil#specialOperatorByName and remove\nClickHouseSqlDialect.CLICKHOUSE_SUBSTRING\n- Remove the common code in PrestoSqlDialect and reuse codes from other\ndialect instances\n\nclose apache#calcite#1776\n","date":"2020-06-11 15:17:17","modifiedFileCount":"5","status":"M","submitter":"XuQianJin-Stars"}]
