[{"authorTime":"2019-07-13 03:55:36","codes":[{"authorDate":"2019-07-13 03:55:36","commitOrder":1,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","date":"2019-07-13 03:55:36","endLine":112,"groupId":"1419","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/84/8b0c31ca5cb95098acfdcd5aab7ad61bea206f.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":95,"status":"B"},{"authorDate":"2019-07-13 03:55:36","commitOrder":1,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), new BaseFileScanTask(\n              DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter))));\n    }\n","date":"2019-07-13 03:55:36","endLine":112,"groupId":"1419","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/63/ca8552885a862d83d8d777ec3494114ec04a2a.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), new BaseFileScanTask(\n              DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter))));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":94,"status":"B"}],"commitId":"e4c6fb979003b1629961b0c950ec6acec994de3b","commitMessage":"@@@Add metadata tables (#252)\n\nThis commit adds metadata tables:\n* history -- the snapshot log\n* snapshots -- known snapshots\n* manifests -- manifest files for a snapshot\n* files -- data files for a snapshot\n* entries -- manifest entries for a snapshot","date":"2019-07-13 03:55:36","modifiedFileCount":"23","status":"B","submitter":"Ryan Blue"},{"authorTime":"2019-07-17 00:44:16","codes":[{"authorDate":"2019-07-13 03:55:36","commitOrder":2,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","date":"2019-07-13 03:55:36","endLine":112,"groupId":"1419","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/84/8b0c31ca5cb95098acfdcd5aab7ad61bea206f.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":95,"status":"N"},{"authorDate":"2019-07-17 00:44:16","commitOrder":2,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), new BaseFileScanTask(\n              DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)),\n              fileSchema));\n    }\n","date":"2019-07-17 00:44:16","endLine":128,"groupId":"1419","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/69/5899279ccd80e97a1571fc0d8d3024d5a52268.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), new BaseFileScanTask(\n              DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter))));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":105,"status":"M"}],"commitId":"33a38826f6c104e52981df15d49f1ee420e04c49","commitMessage":"@@@Fix data files table for unpartitioned tables (#285)\n\n","date":"2019-07-17 00:44:16","modifiedFileCount":"9","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-02-04 06:53:50","codes":[{"authorDate":"2019-07-13 03:55:36","commitOrder":3,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","date":"2019-07-13 03:55:36","endLine":112,"groupId":"1419","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/84/8b0c31ca5cb95098acfdcd5aab7ad61bea206f.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":95,"status":"N"},{"authorDate":"2020-02-04 06:53:50","commitOrder":3,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-02-04 06:53:50","endLine":130,"groupId":"1419","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/4b/153b19fc2ba30d5d92e307e7a665dfd86680c0.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), new BaseFileScanTask(\n              DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)),\n              fileSchema));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":108,"status":"M"}],"commitId":"c3dc9824b381e5e479e356be5e0f4fcf61a9fc37","commitMessage":"@@@Inherit snapshot ids for manifest entries (#675)\n\nThis change makes the snapshot ID optional for each data file in a manifest so that a null snapshot ID indicates that it should be inherited from the manifest metadata. As a consequence.  people can create manifests with missing snapshot IDs that will be assigned at commit time.\n\nCloses #504.","date":"2020-02-04 06:53:50","modifiedFileCount":"28","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-02-18 02:11:32","codes":[{"authorDate":"2020-02-18 02:11:32","commitOrder":4,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","date":"2020-02-18 02:11:32","endLine":113,"groupId":"1419","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/11/b430ebf1b550d7fb5e87c4b819d5e98d68f8bd.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":105,"status":"M"},{"authorDate":"2020-02-18 02:11:32","commitOrder":4,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-02-18 02:11:32","endLine":120,"groupId":"1419","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ab/c06a48fbeb2803be7d82a9c47aefb66da93762.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = Avro\n          .read(ops.io().newInputFile(snapshot.manifestListLocation()))\n          .rename(\"manifest_file\", GenericManifestFile.class.getName())\n          .rename(\"partitions\", GenericPartitionFieldSummary.class.getName())\n          \r\n          .rename(\"r508\", GenericPartitionFieldSummary.class.getName())\n          .project(ManifestFile.schema())\n          .reuseContainers(false)\n          .build();\n\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":107,"status":"M"}],"commitId":"ad925bdf75b6c180cd367168deab47b4969c8177","commitMessage":"@@@Fix metadata tables that use manifestListLocation (#803)\n\n* Fix metadata tables that use manifestListLocation.\n\n* Fix checkstyle.\n\n* Update fix to metadata tables without current snapshot.\n","date":"2020-02-18 02:11:32","modifiedFileCount":"5","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-02-18 02:11:32","codes":[{"authorDate":"2020-04-23 01:52:01","commitOrder":5,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      Schema fileSchema = new Schema(schema().findType(\"data_file\").asStructType().fields());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-04-23 01:52:01","endLine":112,"groupId":"1419","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/d2/458f80a93cf86cae86c730904970b499616e67.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n\n      return CloseableIterable.transform(manifests, manifest -> new BaseFileScanTask(\n          DataFiles.fromManifest(manifest), schemaString, specString, ResidualEvaluator.unpartitioned(rowFilter)));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"M"},{"authorDate":"2020-02-18 02:11:32","commitOrder":5,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-02-18 02:11:32","endLine":120,"groupId":"1419","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ab/c06a48fbeb2803be7d82a9c47aefb66da93762.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":107,"status":"N"}],"commitId":"b655d40e8e6956640163d30700c8f20e4d571fbf","commitMessage":"@@@Inherit snapshot id and sequence number in entries metadata table (#951)\n\n","date":"2020-04-23 01:52:01","modifiedFileCount":"5","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-06-03 03:43:03","codes":[{"authorDate":"2020-06-03 03:43:03","commitOrder":6,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Schema fileSchema = new Schema(schema().findType(\"data_file\").asStructType().fields());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-06-03 03:43:03","endLine":113,"groupId":"1419","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f2/536ec427c9f991884daa8810d0f361a4e620e9.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      Schema fileSchema = new Schema(schema().findType(\"data_file\").asStructType().fields());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"M"},{"authorDate":"2020-06-03 03:43:03","commitOrder":6,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-06-03 03:43:03","endLine":115,"groupId":"1419","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/dc/fc70f318afcbfeabc50b9411ee253fc27645f4.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.manifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"M"}],"commitId":"482f420141486f5b7b02bd62dc14cdb94b9a9cca","commitMessage":"@@@Split Snapshot.manifests into dataManifests and deleteManifests (#1080)\n\nThis replaces all calls to Snapshot.manifests with calls to one of 3 new methods:\n\n* `Snapshot.allManifests` returns both delete and data manifests\n* `Snapshot.deleteManifests` returns only delete manifests\n* `Snapshot.dataManifests` returns only data manifests\n\nExisting references mostly use either `allManifests` or `dataManifests`.  depending on the context. For example.  tests with assertions for the number of manifests use `allManifests` because the test cases should validate there are no new delete manifests.  but other tests that validate rewritten manifests are deleted use `dataManifests` because only data manifests are rewritten and deleted.\n\nThis tries to make minimal changes that preserve the current behavior. Operations are not updated to support delete manifests (rewrite still only rewrites data manifests).  but will carry through the list of delete manifests correctly.","date":"2020-06-03 03:43:03","modifiedFileCount":"46","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-06-06 00:17:36","codes":[{"authorDate":"2020-06-06 00:17:36","commitOrder":7,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Schema fileSchema = new Schema(schema().findType(\"data_file\").asStructType().fields());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-06-06 00:17:36","endLine":119,"groupId":"3312","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/52/0f113a322e3367a3aa87c67a16be42e12dfe9a.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Schema fileSchema = new Schema(schema().findType(\"data_file\").asStructType().fields());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"M"},{"authorDate":"2020-06-06 00:17:36","commitOrder":7,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-06-06 00:17:36","endLine":121,"groupId":"3312","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/db/0e08566db83eecf76c1c8470feeef4f450bcf3.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(rowFilter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"M"}],"commitId":"c299b45bb6ec9a0f2f18451a16136bde9110b5b0","commitMessage":"@@@Add ignoreResiduals option to TableScan (#1094)\n\n","date":"2020-06-06 00:17:36","modifiedFileCount":"15","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-06-06 00:17:36","codes":[{"authorDate":"2020-05-29 22:36:46","commitOrder":8,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Type fileProjection = schema().findType(\"data_file\");\n      Schema fileSchema = fileProjection != null ? new Schema(fileProjection.asStructType().fields()) : new Schema();\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-07-09 08:57:39","endLine":110,"groupId":"3312","id":15,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/3c/43fc40bda16f787304f7b9bb0c7014f64bbdfe.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Schema fileSchema = new Schema(schema().findType(\"data_file\").asStructType().fields());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":96,"status":"M"},{"authorDate":"2020-06-06 00:17:36","commitOrder":8,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-06-06 00:17:36","endLine":121,"groupId":"3312","id":16,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/db/0e08566db83eecf76c1c8470feeef4f450bcf3.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"N"}],"commitId":"ca468d569231e2cd5d502003586d5a49f53de470","commitMessage":"@@@Fix NPE when counting entries (#1077)\n\nCloses #1077\n","date":"2020-07-09 08:57:39","modifiedFileCount":"4","status":"M","submitter":"Xiang Li"},{"authorTime":"2020-06-06 00:17:36","codes":[{"authorDate":"2020-10-30 02:51:18","commitOrder":9,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Type fileProjection = schema().findType(\"data_file\");\n      Schema fileSchema = fileProjection != null ? new Schema(fileProjection.asStructType().fields()) : new Schema();\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals,\n              ops.current().specsById()));\n    }\n","date":"2020-10-30 02:51:18","endLine":118,"groupId":"3312","id":17,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/cc668f640d8896e2fdc66431902fcb3b38c874.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Type fileProjection = schema().findType(\"data_file\");\n      Schema fileSchema = fileProjection != null ? new Schema(fileProjection.asStructType().fields()) : new Schema();\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":103,"status":"M"},{"authorDate":"2020-06-06 00:17:36","commitOrder":9,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","date":"2020-06-06 00:17:36","endLine":121,"groupId":"3312","id":18,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/db/0e08566db83eecf76c1c8470feeef4f450bcf3.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"N"}],"commitId":"43a7427874ab01c6811979b3b97e6c97fe074184","commitMessage":"@@@Core: Fix entries metadata tables with delete manifests (#1673)\n\n","date":"2020-10-30 02:51:18","modifiedFileCount":"3","status":"M","submitter":"Russell Spitzer"},{"authorTime":"2021-08-05 20:23:07","codes":[{"authorDate":"2021-08-05 20:23:07","commitOrder":10,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, schema(), schemaString, specString, residuals,\n              ops.current().specsById()));\n    }\n","date":"2021-08-05 20:23:07","endLine":119,"groupId":"3312","id":19,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/7b/ae3491a7875ebdbaf180edd1fb355825d43393.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      Type fileProjection = schema().findType(\"data_file\");\n      Schema fileSchema = fileProjection != null ? new Schema(fileProjection.asStructType().fields()) : new Schema();\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals,\n              ops.current().specsById()));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"M"},{"authorDate":"2021-08-05 20:23:07","commitOrder":10,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, schema(), schemaString, specString, residuals));\n    }\n","date":"2021-08-05 20:23:07","endLine":114,"groupId":"3312","id":20,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/14/5663ce4d9b6c127a5a6343cbd73f92eb0467bf.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, fileSchema, schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":103,"status":"M"}],"commitId":"68091037944ff7e9de91e7b619f313a8e98c1adc","commitMessage":"@@@Spark: Fix nested struct pruning (#2877)\n\n* Spark: Support Nested Struct Pruning in DataTasks\n\nPreviously DataTasks would return full schemas for some tables and pruned schemas for others and would rely on the underlying framework to do the actual projection. This moves projection and pruning into the core responsibility of the task. This fixes an issue where Spark would be able to pushdown some nested struct predicates to a metadata table but we wouldn't recognize this when trying to do the projection in the framework. StaticDataTasks now support projection in their creation but only if it does not require pruning fields from within a struct which is an element of a List or Map.\n","date":"2021-08-05 20:23:07","modifiedFileCount":"12","status":"M","submitter":"Russell Spitzer"},{"authorTime":"2021-08-10 06:58:51","codes":[{"authorDate":"2021-08-05 20:23:07","commitOrder":11,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, schema(), schemaString, specString, residuals,\n              ops.current().specsById()));\n    }\n","date":"2021-08-05 20:23:07","endLine":119,"groupId":"102083","id":21,"instanceNumber":1,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/7b/ae3491a7875ebdbaf180edd1fb355825d43393.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      \r\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.allManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, schema(), schemaString, specString, residuals,\n              ops.current().specsById()));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"N"},{"authorDate":"2021-08-10 06:58:51","commitOrder":11,"curCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      \r\n      Expression partitionFilter = Projections\n          .inclusive(\n              transformSpec(fileSchema, table().spec(), PARTITION_FIELD_PREFIX),\n              caseSensitive)\n          .project(rowFilter);\n\n      ManifestEvaluator manifestEval = ManifestEvaluator.forPartitionFilter(\n          partitionFilter, table().spec(), caseSensitive);\n      CloseableIterable<ManifestFile> filtered = CloseableIterable.filter(manifests, manifestEval::eval);\n\n      \r\n      \r\n      \r\n      \r\n      return CloseableIterable.transform(filtered, manifest ->\n          new ManifestReadTask(ops.io(), manifest, schema(), schemaString, specString, residuals));\n    }\n","date":"2021-08-10 06:58:51","endLine":132,"groupId":"102083","id":22,"instanceNumber":2,"isCurCommit":0,"methodName":"planFiles","params":"(TableOperationsops@Snapshotsnapshot@ExpressionrowFilter@booleanignoreResiduals@booleancaseSensitive@booleancolStats)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/d6/b80ee6658760e4ccfbf6a432671099e6d1af8e.src","preCode":"    protected CloseableIterable<FileScanTask> planFiles(\n        TableOperations ops, Snapshot snapshot, Expression rowFilter,\n        boolean ignoreResiduals, boolean caseSensitive, boolean colStats) {\n      CloseableIterable<ManifestFile> manifests = CloseableIterable.withNoopClose(snapshot.dataManifests());\n      String schemaString = SchemaParser.toJson(schema());\n      String specString = PartitionSpecParser.toJson(PartitionSpec.unpartitioned());\n      Expression filter = ignoreResiduals ? Expressions.alwaysTrue() : rowFilter;\n      ResidualEvaluator residuals = ResidualEvaluator.unpartitioned(filter);\n\n      return CloseableIterable.transform(manifests, manifest ->\n          new ManifestReadTask(ops.io(), manifest, schema(), schemaString, specString, residuals));\n    }\n","realPath":"core/src/main/java/org/apache/iceberg/DataFilesTable.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":106,"status":"M"}],"commitId":"7a3bfedf25cb74624ed898cec81e3bcadffb2373","commitMessage":"@@@Core: Add predicate pushdown for files metadata table (#2926)\n\n","date":"2021-08-10 06:58:51","modifiedFileCount":"4","status":"M","submitter":"Szehon Ho"}]
