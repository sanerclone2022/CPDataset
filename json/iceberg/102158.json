[{"authorTime":"2019-03-21 07:25:05","codes":[{"authorDate":"2019-05-11 06:46:10","commitOrder":2,"curCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2019-05-11 06:46:10","endLine":582,"groupId":"4222","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ae/bded7eede4b87dea462cf195ebee939361cb91.src","preCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":561,"status":"B"},{"authorDate":"2019-03-21 07:25:05","commitOrder":2,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null) {\n      OutputFile out = manifestPath(0);\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2019-03-21 07:25:05","endLine":111,"groupId":"997","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/2b/b90387737e344de9c291e55f6d9e37aae76343.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null) {\n      OutputFile out = manifestPath(0);\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"NB"}],"commitId":"81ae930c61f708191aa1f30a787e4a3d10def6f8","commitMessage":"@@@Add SnapshotUpdate interface with set method (#180)\n\n","date":"2019-05-11 06:46:10","modifiedFileCount":"12","status":"M","submitter":"Ryan Blue"},{"authorTime":"2019-06-11 05:22:35","codes":[{"authorDate":"2019-05-11 06:46:10","commitOrder":3,"curCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2019-05-11 06:46:10","endLine":582,"groupId":"4222","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ae/bded7eede4b87dea462cf195ebee939361cb91.src","preCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":561,"status":"N"},{"authorDate":"2019-06-11 05:22:35","commitOrder":3,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2019-06-11 05:22:35","endLine":147,"groupId":"1011","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/73/b68d4e6bb3a28c07374b85ae63128648dba1be.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null) {\n      OutputFile out = manifestPath(0);\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":126,"status":"M"}],"commitId":"6ac23e03735d4514480a9f0155200faf7179f21b","commitMessage":"@@@Add appendManifest to AppendFiles API (#201)\n\nThis is intended for writers that need to checkpoint state. Writers that checkpoint should be able to create manifest files and append the contents of those manifests to a table.  instead of checkpointing\nindividual data files.","date":"2019-06-11 05:22:35","modifiedFileCount":"9","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2020-04-10 03:14:34","commitOrder":4,"curCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2020-04-10 03:14:34","endLine":707,"groupId":"995","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/45/37c232d183df34a569573d1665fe92467f0522.src","preCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":688,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":4,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2020-04-10 03:14:34","endLine":178,"groupId":"3065","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/3883151787bc831800c8212df89caffb3a3f79.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      OutputFile out = manifestPath(manifestCount.getAndIncrement());\n\n      ManifestWriter writer = new ManifestWriter(spec, out, snapshotId());\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"M"}],"commitId":"c094da57db072187b2d930ae6c5590218012ec3f","commitMessage":"@@@Prepare metadata writers for format v2 (#903)\n\n* Track format version in TableMetadata.\n* Pass formatVersion when creating a manifest writer.\n* Pass formatVersion when creating a manifest list writer.\n* Add v2 change section to spec.","date":"2020-04-10 03:14:34","modifiedFileCount":"12","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2020-06-10 23:43:19","commitOrder":5,"curCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(spec);\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(\"Failed to close manifest writer\", e);\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2020-06-10 23:43:19","endLine":342,"groupId":"4445","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/05/7b45f474bf7c358413c3ac9a9906d5155e174f.src","preCode":"  private ManifestFile newFilesAsManifest() throws IOException {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.cachedNewManifest = writer.toManifestFile();\n      this.hasNewFiles = false;\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":319,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":5,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2020-04-10 03:14:34","endLine":178,"groupId":"3065","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/3883151787bc831800c8212df89caffb3a3f79.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"N"}],"commitId":"bd606f56b14c49f39aa745534718d0cb6a50a8c9","commitMessage":"@@@Refactor MergingSnapshotProducer (#1098)\n\n","date":"2020-06-10 23:43:19","modifiedFileCount":"8","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2020-09-23 06:35:35","commitOrder":6,"curCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(spec);\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(e, \"Failed to close manifest writer\");\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2020-09-23 06:35:35","endLine":335,"groupId":"4445","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/5f/ebb8130c22f46c234138a8bae1b4225ef37803.src","preCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(spec);\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(\"Failed to close manifest writer\", e);\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":312,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":6,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2020-04-10 03:14:34","endLine":178,"groupId":"3065","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/3883151787bc831800c8212df89caffb3a3f79.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"N"}],"commitId":"96959ece9faeb795757388908274cfd0ff1856ca","commitMessage":"@@@Build: Fix warnings (#1427)\n\n","date":"2020-09-23 06:35:35","modifiedFileCount":"72","status":"M","submitter":"Russell Spitzer"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2021-03-30 08:24:02","commitOrder":7,"curCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(writeSpec());\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(e, \"Failed to close manifest writer\");\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2021-03-30 08:24:02","endLine":478,"groupId":"658","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/77/5ff1a74388bfbb60647f2c0468d2e0fb7cebc2.src","preCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(spec);\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(e, \"Failed to close manifest writer\");\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":455,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":7,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2020-04-10 03:14:34","endLine":178,"groupId":"3065","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/3883151787bc831800c8212df89caffb3a3f79.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"N"}],"commitId":"aba898b1a2ea15fd091228626b6887a5a72800c0","commitMessage":"@@@Spark: Fix RewriteDataFilesAction with custom outputSpecId (#2293)\n\n","date":"2021-03-30 08:24:02","modifiedFileCount":"7","status":"M","submitter":"Edgar Rodriguez"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2021-09-21 23:21:59","commitOrder":8,"curCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(dataSpec());\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(e, \"Failed to close manifest writer\");\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","date":"2021-09-21 23:21:59","endLine":544,"groupId":"102158","id":13,"instanceNumber":1,"isCurCommit":1,"methodName":"newFilesAsManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/e3/6b5da3e221931700ac69c2d6209e05b4b7226e.src","preCode":"  private ManifestFile newFilesAsManifest() {\n    if (hasNewFiles && cachedNewManifest != null) {\n      deleteFile(cachedNewManifest.path());\n      cachedNewManifest = null;\n    }\n\n    if (cachedNewManifest == null) {\n      try {\n        ManifestWriter<DataFile> writer = newManifestWriter(writeSpec());\n        try {\n          writer.addAll(newFiles);\n        } finally {\n          writer.close();\n        }\n\n        this.cachedNewManifest = writer.toManifestFile();\n        this.hasNewFiles = false;\n      } catch (IOException e) {\n        throw new RuntimeIOException(e, \"Failed to close manifest writer\");\n      }\n    }\n\n    return cachedNewManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":521,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":8,"curCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","date":"2020-04-10 03:14:34","endLine":178,"groupId":"102158","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"writeManifest","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/3883151787bc831800c8212df89caffb3a3f79.src","preCode":"  private ManifestFile writeManifest() throws IOException {\n    if (hasNewFiles && newManifest != null) {\n      deleteFile(newManifest.path());\n      newManifest = null;\n    }\n\n    if (newManifest == null && newFiles.size() > 0) {\n      ManifestWriter writer = newManifestWriter(spec);\n      try {\n        writer.addAll(newFiles);\n      } finally {\n        writer.close();\n      }\n\n      this.newManifest = writer.toManifestFile();\n      hasNewFiles = false;\n    }\n\n    return newManifest;\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"N"}],"commitId":"e743063909c623452b915cf1e30f26cf7b9125f2","commitMessage":"@@@Core: Support committing delete files with multiple specs (#2985)\n\n","date":"2021-09-21 23:21:59","modifiedFileCount":"5","status":"M","submitter":"Anton Okolnychyi"}]
