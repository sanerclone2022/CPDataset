[{"authorTime":"2020-12-11 02:34:51","codes":[{"authorDate":"2020-12-11 02:34:51","commitOrder":1,"curCode":"  public void testRetryTask() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 2);\n\n    \r\n    writeRecords(2, 0, false, true, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    \r\n    writeRecords(2, 1, false, false, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 2);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    List<Record> expected = writeRecords(2, 2, true, false, conf);\n    committer.commitJob(new JobContextImpl(conf, JOB_ID));\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 4);\n    HiveIcebergTestUtils.validateData(table, expected, 0);\n  }\n","date":"2020-12-11 02:34:51","endLine":166,"groupId":"4513","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testRetryTask","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/68/b2a00f6598af6ceac00866110c2d6aaa826821.src","preCode":"  public void testRetryTask() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 2);\n\n    \r\n    writeRecords(2, 0, false, true, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    \r\n    writeRecords(2, 1, false, false, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 2);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    List<Record> expected = writeRecords(2, 2, true, false, conf);\n    committer.commitJob(new JobContextImpl(conf, JOB_ID));\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 4);\n    HiveIcebergTestUtils.validateData(table, expected, 0);\n  }\n","realPath":"mr/src/test/java/org/apache/iceberg/mr/hive/TestHiveIcebergOutputCommitter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":145,"status":"B"},{"authorDate":"2020-12-11 02:34:51","commitOrder":1,"curCode":"  public void testAbortJob() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 1);\n    writeRecords(1, 0, true, false, conf);\n    committer.abortJob(new JobContextImpl(conf, JOB_ID), JobStatus.State.FAILED);\n\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n  }\n","date":"2020-12-11 02:34:51","endLine":178,"groupId":"536","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testAbortJob","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/68/b2a00f6598af6ceac00866110c2d6aaa826821.src","preCode":"  public void testAbortJob() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 1);\n    writeRecords(1, 0, true, false, conf);\n    committer.abortJob(new JobContextImpl(conf, JOB_ID), JobStatus.State.FAILED);\n\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n  }\n","realPath":"mr/src/test/java/org/apache/iceberg/mr/hive/TestHiveIcebergOutputCommitter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":169,"status":"B"}],"commitId":"05aa9011cb2b6c0e24427be652bb825d5f8488ac","commitMessage":"@@@Hive: Add OutputCommitter implementation (#1861)\n\n","date":"2020-12-11 02:34:51","modifiedFileCount":"4","status":"B","submitter":"pvary"},{"authorTime":"2021-03-30 20:07:23","codes":[{"authorDate":"2021-03-30 20:07:23","commitOrder":2,"curCode":"  public void testRetryTask() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 2);\n\n    \r\n    writeRecords(table.name(), 2, 0, false, true, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    \r\n    writeRecords(table.name(), 2, 1, false, false, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 2);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    List<Record> expected = writeRecords(table.name(), 2, 2, true, false, conf);\n    committer.commitJob(new JobContextImpl(conf, JOB_ID));\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 4);\n    HiveIcebergTestUtils.validateData(table, expected, 0);\n  }\n","date":"2021-03-30 20:07:23","endLine":177,"groupId":"101607","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testRetryTask","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/1f/5466b76924394e7e599b0252c0e3829b3f6fd8.src","preCode":"  public void testRetryTask() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 2);\n\n    \r\n    writeRecords(2, 0, false, true, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    \r\n    writeRecords(2, 1, false, false, conf);\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 2);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n\n    \r\n    List<Record> expected = writeRecords(2, 2, true, false, conf);\n    committer.commitJob(new JobContextImpl(conf, JOB_ID));\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 4);\n    HiveIcebergTestUtils.validateData(table, expected, 0);\n  }\n","realPath":"mr/src/test/java/org/apache/iceberg/mr/hive/TestHiveIcebergOutputCommitter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":156,"status":"M"},{"authorDate":"2021-03-30 20:07:23","commitOrder":2,"curCode":"  public void testAbortJob() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 1);\n    writeRecords(table.name(), 1, 0, true, false, conf);\n    committer.abortJob(new JobContextImpl(conf, JOB_ID), JobStatus.State.FAILED);\n\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n  }\n","date":"2021-03-30 20:07:23","endLine":189,"groupId":"101607","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testAbortJob","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/1f/5466b76924394e7e599b0252c0e3829b3f6fd8.src","preCode":"  public void testAbortJob() throws IOException {\n    HiveIcebergOutputCommitter committer = new HiveIcebergOutputCommitter();\n    Table table = table(temp.getRoot().getPath(), false);\n    JobConf conf = jobConf(table, 1);\n    writeRecords(1, 0, true, false, conf);\n    committer.abortJob(new JobContextImpl(conf, JOB_ID), JobStatus.State.FAILED);\n\n    HiveIcebergTestUtils.validateFiles(table, conf, JOB_ID, 0);\n    HiveIcebergTestUtils.validateData(table, Collections.emptyList(), 0);\n  }\n","realPath":"mr/src/test/java/org/apache/iceberg/mr/hive/TestHiveIcebergOutputCommitter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":180,"status":"M"}],"commitId":"d1510340eaff68d88a2e8194d58e7e493af02bcc","commitMessage":"@@@Hive: Implement multi-table inserts (#2228)\n\n","date":"2021-03-30 20:07:23","modifiedFileCount":"9","status":"M","submitter":"pvary"}]
