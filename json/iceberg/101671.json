[{"authorTime":"2020-11-20 02:23:35","codes":[{"authorDate":"2020-11-20 02:23:35","commitOrder":1,"curCode":"  public List<TableIdentifier> listTables(Namespace namespace) {\n    namespaceExists(namespace);\n    \r\n    String nextToken = null;\n    List<TableIdentifier> results = Lists.newArrayList();\n    do {\n      GetTablesResponse response = glue.getTables(GetTablesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .databaseName(IcebergToGlueConverter.toDatabaseName(namespace))\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasTableList()) {\n        results.addAll(response.tableList().stream()\n            .map(GlueToIcebergConverter::toTableId)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing of namespace: {} resulted in the following tables: {}\", namespace, results);\n    return results;\n  }\n","date":"2020-11-20 02:23:35","endLine":178,"groupId":"3880","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"listTables","params":"(Namespacenamespace)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/86/ce858a825dab642d80b71cdb4ba58bfc5bf730.src","preCode":"  public List<TableIdentifier> listTables(Namespace namespace) {\n    namespaceExists(namespace);\n    \r\n    String nextToken = null;\n    List<TableIdentifier> results = Lists.newArrayList();\n    do {\n      GetTablesResponse response = glue.getTables(GetTablesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .databaseName(IcebergToGlueConverter.toDatabaseName(namespace))\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasTableList()) {\n        results.addAll(response.tableList().stream()\n            .map(GlueToIcebergConverter::toTableId)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing of namespace: {} resulted in the following tables: {}\", namespace, results);\n    return results;\n  }\n","realPath":"aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":157,"status":"B"},{"authorDate":"2020-11-20 02:23:35","commitOrder":1,"curCode":"  public List<Namespace> listNamespaces(Namespace namespace) throws NoSuchNamespaceException {\n    if (!namespace.isEmpty()) {\n      \r\n      if (namespaceExists(namespace)) {\n        return Lists.newArrayList();\n      }\n      throw new NoSuchNamespaceException(\n          \"Glue does not support nested namespace, cannot list namespaces under %s\", namespace);\n    }\n\n    \r\n    String nextToken = null;\n    List<Namespace> results = Lists.newArrayList();\n    do {\n      GetDatabasesResponse response = glue.getDatabases(GetDatabasesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasDatabaseList()) {\n        results.addAll(response.databaseList().stream()\n            .map(GlueToIcebergConverter::toNamespace)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing namespace {} returned namespaces: {}\", namespace, results);\n    return results;\n  }\n","date":"2020-11-20 02:23:35","endLine":306,"groupId":"4942","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"listNamespaces","params":"(Namespacenamespace)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/86/ce858a825dab642d80b71cdb4ba58bfc5bf730.src","preCode":"  public List<Namespace> listNamespaces(Namespace namespace) throws NoSuchNamespaceException {\n    if (!namespace.isEmpty()) {\n      \r\n      if (namespaceExists(namespace)) {\n        return Lists.newArrayList();\n      }\n      throw new NoSuchNamespaceException(\n          \"Glue does not support nested namespace, cannot list namespaces under %s\", namespace);\n    }\n\n    \r\n    String nextToken = null;\n    List<Namespace> results = Lists.newArrayList();\n    do {\n      GetDatabasesResponse response = glue.getDatabases(GetDatabasesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasDatabaseList()) {\n        results.addAll(response.databaseList().stream()\n            .map(GlueToIcebergConverter::toNamespace)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing namespace {} returned namespaces: {}\", namespace, results);\n    return results;\n  }\n","realPath":"aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":278,"status":"B"}],"commitId":"0beb7d663694d78e6edecb241a008e9834c82d8c","commitMessage":"@@@AWS: Add Glue catalog and table operations (#1633)\n\n","date":"2020-11-20 02:23:35","modifiedFileCount":"3","status":"B","submitter":"jackye1995"},{"authorTime":"2020-11-20 02:23:35","codes":[{"authorDate":"2021-03-04 08:23:29","commitOrder":2,"curCode":"  public List<TableIdentifier> listTables(Namespace namespace) {\n    namespaceExists(namespace);\n    \r\n    String nextToken = null;\n    List<TableIdentifier> results = Lists.newArrayList();\n    do {\n      GetTablesResponse response = glue.getTables(GetTablesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .databaseName(IcebergToGlueConverter.toDatabaseName(namespace))\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasTableList()) {\n        results.addAll(response.tableList().stream()\n            .filter(this::isGlueIcebergTable)\n            .map(GlueToIcebergConverter::toTableId)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing of namespace: {} resulted in the following tables: {}\", namespace, results);\n    return results;\n  }\n","date":"2021-03-04 08:23:29","endLine":188,"groupId":"101671","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"listTables","params":"(Namespacenamespace)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/19/7a730bdc0558c471bb400f7ebbf106d8211857.src","preCode":"  public List<TableIdentifier> listTables(Namespace namespace) {\n    namespaceExists(namespace);\n    \r\n    String nextToken = null;\n    List<TableIdentifier> results = Lists.newArrayList();\n    do {\n      GetTablesResponse response = glue.getTables(GetTablesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .databaseName(IcebergToGlueConverter.toDatabaseName(namespace))\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasTableList()) {\n        results.addAll(response.tableList().stream()\n            .map(GlueToIcebergConverter::toTableId)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing of namespace: {} resulted in the following tables: {}\", namespace, results);\n    return results;\n  }\n","realPath":"aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":166,"status":"M"},{"authorDate":"2020-11-20 02:23:35","commitOrder":2,"curCode":"  public List<Namespace> listNamespaces(Namespace namespace) throws NoSuchNamespaceException {\n    if (!namespace.isEmpty()) {\n      \r\n      if (namespaceExists(namespace)) {\n        return Lists.newArrayList();\n      }\n      throw new NoSuchNamespaceException(\n          \"Glue does not support nested namespace, cannot list namespaces under %s\", namespace);\n    }\n\n    \r\n    String nextToken = null;\n    List<Namespace> results = Lists.newArrayList();\n    do {\n      GetDatabasesResponse response = glue.getDatabases(GetDatabasesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasDatabaseList()) {\n        results.addAll(response.databaseList().stream()\n            .map(GlueToIcebergConverter::toNamespace)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing namespace {} returned namespaces: {}\", namespace, results);\n    return results;\n  }\n","date":"2020-11-20 02:23:35","endLine":306,"groupId":"101671","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"listNamespaces","params":"(Namespacenamespace)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/86/ce858a825dab642d80b71cdb4ba58bfc5bf730.src","preCode":"  public List<Namespace> listNamespaces(Namespace namespace) throws NoSuchNamespaceException {\n    if (!namespace.isEmpty()) {\n      \r\n      if (namespaceExists(namespace)) {\n        return Lists.newArrayList();\n      }\n      throw new NoSuchNamespaceException(\n          \"Glue does not support nested namespace, cannot list namespaces under %s\", namespace);\n    }\n\n    \r\n    String nextToken = null;\n    List<Namespace> results = Lists.newArrayList();\n    do {\n      GetDatabasesResponse response = glue.getDatabases(GetDatabasesRequest.builder()\n          .catalogId(awsProperties.glueCatalogId())\n          .nextToken(nextToken)\n          .build());\n      nextToken = response.nextToken();\n      if (response.hasDatabaseList()) {\n        results.addAll(response.databaseList().stream()\n            .map(GlueToIcebergConverter::toNamespace)\n            .collect(Collectors.toList()));\n      }\n    } while (nextToken != null);\n\n    LOG.debug(\"Listing namespace {} returned namespaces: {}\", namespace, results);\n    return results;\n  }\n","realPath":"aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":278,"status":"N"}],"commitId":"ef6de31a805783bce87efb51d2e5843c192e6822","commitMessage":"@@@AWS: Do not list non-iceberg table in GlueCatalog (#2267)\n\n","date":"2021-03-04 08:23:29","modifiedFileCount":"3","status":"M","submitter":"Jack Ye"}]
