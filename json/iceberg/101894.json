[{"authorTime":"2020-11-13 03:36:32","codes":[{"authorDate":"2020-11-13 03:36:32","commitOrder":1,"curCode":"  public void testMetricsForNaNColumns() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA, NAN_ONLY_RECORD, NAN_ONLY_RECORD);\n    Assert.assertEquals(2L, (long) metrics.recordCount());\n    assertCounts(1, 2L, 0L, 2L, metrics);\n    assertCounts(2, 2L, 0L, 2L, metrics);\n    \r\n    assertBounds(1, FloatType.get(), Float.NaN, Float.NaN, metrics);\n    assertBounds(2, DoubleType.get(), Double.NaN, Double.NaN, metrics);\n  }\n","date":"2020-11-13 03:36:32","endLine":356,"groupId":"4151","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testMetricsForNaNColumns","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/6c/d7f88ddf278d7fe03d71f70b3e8cb10c5305e8.src","preCode":"  public void testMetricsForNaNColumns() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA, NAN_ONLY_RECORD, NAN_ONLY_RECORD);\n    Assert.assertEquals(2L, (long) metrics.recordCount());\n    assertCounts(1, 2L, 0L, 2L, metrics);\n    assertCounts(2, 2L, 0L, 2L, metrics);\n    \r\n    assertBounds(1, FloatType.get(), Float.NaN, Float.NaN, metrics);\n    assertBounds(2, DoubleType.get(), Double.NaN, Double.NaN, metrics);\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMetrics.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":348,"status":"B"},{"authorDate":"2020-11-13 03:36:32","commitOrder":1,"curCode":"  public void testColumnBoundsWithNaNValueInMiddle() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA,\n        FLOAT_DOUBLE_RECORD_1, NAN_ONLY_RECORD, FLOAT_DOUBLE_RECORD_2);\n    Assert.assertEquals(3L, (long) metrics.recordCount());\n    assertCounts(1, 3L, 0L, 1L, metrics);\n    assertCounts(2, 3L, 0L, 1L, metrics);\n\n    \r\n    \r\n    if (fileFormat() == FileFormat.ORC) {\n      assertBounds(1, FloatType.get(), 1.2F, 5.6F, metrics);\n      assertBounds(2, DoubleType.get(), 3.4D, 7.8D, metrics);\n    } else {\n      assertBounds(1, FloatType.get(), 1.2F, Float.NaN, metrics);\n      assertBounds(2, DoubleType.get(), 3.4D, Double.NaN, metrics);\n    }\n  }\n","date":"2020-11-13 03:36:32","endLine":394,"groupId":"3132","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testColumnBoundsWithNaNValueInMiddle","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/6c/d7f88ddf278d7fe03d71f70b3e8cb10c5305e8.src","preCode":"  public void testColumnBoundsWithNaNValueInMiddle() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA,\n        FLOAT_DOUBLE_RECORD_1, NAN_ONLY_RECORD, FLOAT_DOUBLE_RECORD_2);\n    Assert.assertEquals(3L, (long) metrics.recordCount());\n    assertCounts(1, 3L, 0L, 1L, metrics);\n    assertCounts(2, 3L, 0L, 1L, metrics);\n\n    \r\n    \r\n    if (fileFormat() == FileFormat.ORC) {\n      assertBounds(1, FloatType.get(), 1.2F, 5.6F, metrics);\n      assertBounds(2, DoubleType.get(), 3.4D, 7.8D, metrics);\n    } else {\n      assertBounds(1, FloatType.get(), 1.2F, Float.NaN, metrics);\n      assertBounds(2, DoubleType.get(), 3.4D, Double.NaN, metrics);\n    }\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMetrics.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":378,"status":"B"}],"commitId":"944a437f1057b8be60292426aebdb0b8059d90e0","commitMessage":"@@@Core: Add NaN counts to Metrics.  implement in Parquet (#1641)\n\n","date":"2020-11-13 03:36:32","modifiedFileCount":"11","status":"B","submitter":"yyanyy"},{"authorTime":"2021-06-25 06:58:29","codes":[{"authorDate":"2021-06-25 06:58:29","commitOrder":2,"curCode":"  public void testMetricsForNaNColumns() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA, NAN_ONLY_RECORD, NAN_ONLY_RECORD);\n    Assert.assertEquals(2L, (long) metrics.recordCount());\n    assertCounts(1, 2L, 0L, 2L, metrics);\n    assertCounts(2, 2L, 0L, 2L, metrics);\n\n    assertBounds(1, FloatType.get(), null, null, metrics);\n    assertBounds(2, DoubleType.get(), null, null, metrics);\n  }\n","date":"2021-06-25 06:58:29","endLine":360,"groupId":"101894","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testMetricsForNaNColumns","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/47/b79a655af668a9fe1fdf1e1c413d30ffbb9d74.src","preCode":"  public void testMetricsForNaNColumns() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA, NAN_ONLY_RECORD, NAN_ONLY_RECORD);\n    Assert.assertEquals(2L, (long) metrics.recordCount());\n    assertCounts(1, 2L, 0L, 2L, metrics);\n    assertCounts(2, 2L, 0L, 2L, metrics);\n    \r\n    assertBounds(1, FloatType.get(), Float.NaN, Float.NaN, metrics);\n    assertBounds(2, DoubleType.get(), Double.NaN, Double.NaN, metrics);\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMetrics.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":352,"status":"M"},{"authorDate":"2021-06-25 06:58:29","commitOrder":2,"curCode":"  public void testColumnBoundsWithNaNValueInMiddle() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA,\n        FLOAT_DOUBLE_RECORD_1, NAN_ONLY_RECORD, FLOAT_DOUBLE_RECORD_2);\n    Assert.assertEquals(3L, (long) metrics.recordCount());\n    assertCounts(1, 3L, 0L, 1L, metrics);\n    assertCounts(2, 3L, 0L, 1L, metrics);\n\n    assertBounds(1, FloatType.get(), 1.2F, 5.6F, metrics);\n    assertBounds(2, DoubleType.get(), 3.4D, 7.8D, metrics);\n  }\n","date":"2021-06-25 06:58:29","endLine":384,"groupId":"101894","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testColumnBoundsWithNaNValueInMiddle","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/47/b79a655af668a9fe1fdf1e1c413d30ffbb9d74.src","preCode":"  public void testColumnBoundsWithNaNValueInMiddle() throws IOException {\n    Metrics metrics = getMetrics(FLOAT_DOUBLE_ONLY_SCHEMA,\n        FLOAT_DOUBLE_RECORD_1, NAN_ONLY_RECORD, FLOAT_DOUBLE_RECORD_2);\n    Assert.assertEquals(3L, (long) metrics.recordCount());\n    assertCounts(1, 3L, 0L, 1L, metrics);\n    assertCounts(2, 3L, 0L, 1L, metrics);\n\n    \r\n    \r\n    if (fileFormat() == FileFormat.ORC) {\n      assertBounds(1, FloatType.get(), 1.2F, 5.6F, metrics);\n      assertBounds(2, DoubleType.get(), 3.4D, 7.8D, metrics);\n    } else {\n      assertBounds(1, FloatType.get(), 1.2F, Float.NaN, metrics);\n      assertBounds(2, DoubleType.get(), 3.4D, Double.NaN, metrics);\n    }\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMetrics.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":375,"status":"M"}],"commitId":"2e4684740b56f6d80328f50b7e7fef0863c262e7","commitMessage":"@@@Core: Fix float and double metrics for Parquet and ORC (#2464)\n\nThis replaces the metrics from Parquet and ORC with metrics that are accumulated by Iceberg writers to ensure that the metrics do not include NaN values.","date":"2021-06-25 06:58:29","modifiedFileCount":"18","status":"M","submitter":"yyanyy"}]
