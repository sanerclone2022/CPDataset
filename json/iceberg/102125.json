[{"authorTime":"2020-02-04 06:53:50","codes":[{"authorDate":"2020-02-04 06:53:50","commitOrder":3,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = manifestPath(manifestSuffix.getAndIncrement());\n      return ManifestWriter.copyManifest(reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","date":"2020-02-04 06:53:50","endLine":164,"groupId":"1753","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/39/e7a7d1c6955f63694312a8f2beb86479910da1.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = manifestPath(manifestSuffix.getAndIncrement());\n      return ManifestWriter.copyManifest(reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":157,"status":"MB"},{"authorDate":"2020-02-04 06:53:50","commitOrder":3,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = manifestPath(manifestCount.getAndIncrement());\n      return ManifestWriter.copyAppendManifest(reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","date":"2020-02-04 06:53:50","endLine":118,"groupId":"4216","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/24/6e10fa38c1b3320130dd3794126f820d809c0d.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = manifestPath(manifestCount.getAndIncrement());\n      return ManifestWriter.copyAppendManifest(reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":111,"status":"B"}],"commitId":"c3dc9824b381e5e479e356be5e0f4fcf61a9fc37","commitMessage":"@@@Inherit snapshot ids for manifest entries (#675)\n\nThis change makes the snapshot ID optional for each data file in a manifest so that a null snapshot ID indicates that it should be inherited from the manifest metadata. As a consequence.  people can create manifests with missing snapshot IDs that will be assigned at commit time.\n\nCloses #504.","date":"2020-02-04 06:53:50","modifiedFileCount":"28","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2020-04-10 03:14:34","commitOrder":4,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = newManifestOutput();\n      return ManifestWriter.copyManifest(reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","date":"2020-04-10 03:14:34","endLine":163,"groupId":"0","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/0e/ee04b68a6cf0acee0bce9fe2ca50338a441b9d.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = manifestPath(manifestSuffix.getAndIncrement());\n      return ManifestWriter.copyManifest(reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":156,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":4,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = newManifestOutput();\n      return ManifestWriter.copyAppendManifest(reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","date":"2020-04-10 03:14:34","endLine":116,"groupId":"4216","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/33/3883151787bc831800c8212df89caffb3a3f79.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = manifestPath(manifestCount.getAndIncrement());\n      return ManifestWriter.copyAppendManifest(reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":109,"status":"M"}],"commitId":"c094da57db072187b2d930ae6c5590218012ec3f","commitMessage":"@@@Prepare metadata writers for format v2 (#903)\n\n* Track format version in TableMetadata.\n* Pass formatVersion when creating a manifest writer.\n* Pass formatVersion when creating a manifest list writer.\n* Add v2 change section to spec.","date":"2020-04-10 03:14:34","modifiedFileCount":"12","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-04-16 07:44:35","codes":[{"authorDate":"2020-04-16 07:44:35","commitOrder":5,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestFiles.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = newManifestOutput();\n      return ManifestFiles.copyManifest(\n          ops.current().formatVersion(), reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","date":"2020-04-16 07:44:35","endLine":164,"groupId":"0","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/7c/adf91077a22e67204d765ef7035299c85253e9.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = newManifestOutput();\n      return ManifestWriter.copyManifest(reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":156,"status":"M"},{"authorDate":"2020-04-16 07:44:35","commitOrder":5,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestFiles.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = newManifestOutput();\n      return ManifestFiles.copyAppendManifest(\n          ops.current().formatVersion(), reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","date":"2020-04-16 07:44:35","endLine":117,"groupId":"2471","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f0/dda9a19b6424a4b3ac409a5e77c3dcb61ec2c1.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestReader.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = newManifestOutput();\n      return ManifestWriter.copyAppendManifest(reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":109,"status":"M"}],"commitId":"a5e77369c330873a6a292b8952b1ca09b7712bb7","commitMessage":"@@@Move manifest factory methods (#925)\n\n","date":"2020-04-16 07:44:35","modifiedFileCount":"18","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-04-23 00:40:34","codes":[{"authorDate":"2020-04-23 00:40:34","commitOrder":6,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    TableMetadata current = ops.current();\n    InputFile toCopy = ops.io().newInputFile(manifest.path());\n    OutputFile newFile = newManifestOutput();\n    return ManifestFiles.copyRewriteManifest(\n        current.formatVersion(), toCopy, specsById, newFile, snapshotId(), summaryBuilder);\n  }\n","date":"2020-04-23 00:40:34","endLine":163,"groupId":"102125","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/e5/2c5484dc4c6546d99fef15d07ec1c70b18187c.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestFiles.read(manifest, ops.io(), specsById)) {\n      OutputFile newFile = newManifestOutput();\n      return ManifestFiles.copyManifest(\n          ops.current().formatVersion(), reader, newFile, snapshotId(), summaryBuilder, ALLOWED_ENTRY_STATUSES);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":157,"status":"M"},{"authorDate":"2020-04-23 00:40:34","commitOrder":6,"curCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    TableMetadata current = ops.current();\n    InputFile toCopy = ops.io().newInputFile(manifest.path());\n    OutputFile newManifestPath = newManifestOutput();\n    return ManifestFiles.copyAppendManifest(\n        current.formatVersion(), toCopy, current.specsById(), newManifestPath, snapshotId(), summaryBuilder);\n  }\n","date":"2020-04-23 00:40:34","endLine":116,"groupId":"102125","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"copyManifest","params":"(ManifestFilemanifest)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/95/96932af8a19080fe43d90c1eacad271c2cfcbd.src","preCode":"  private ManifestFile copyManifest(ManifestFile manifest) {\n    try (ManifestReader reader = ManifestFiles.read(manifest, ops.io(), ops.current().specsById())) {\n      OutputFile newManifestPath = newManifestOutput();\n      return ManifestFiles.copyAppendManifest(\n          ops.current().formatVersion(), reader, newManifestPath, snapshotId(), summaryBuilder);\n    } catch (IOException e) {\n      throw new RuntimeIOException(e, \"Failed to close manifest: %s\", manifest);\n    }\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/FastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":110,"status":"M"}],"commitId":"30711e2a744aa4e154c4e4c55a51fca621126363","commitMessage":"@@@Refactor metadata inheritance for manifest rewrites (#941)\n\n","date":"2020-04-23 00:40:34","modifiedFileCount":"6","status":"M","submitter":"Ryan Blue"}]
