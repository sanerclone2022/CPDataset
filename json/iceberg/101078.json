[{"authorTime":"2020-11-14 07:55:36","codes":[{"authorDate":"2020-11-14 02:59:04","commitOrder":2,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rollback_to_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-11-14 02:59:04","endLine":271,"groupId":"4511","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/04/e4faa54721603210eb0c18c75960c4166ee167.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rollback_to_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRollbackToSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":235,"status":"NB"},{"authorDate":"2020-11-14 07:55:36","commitOrder":2,"curCode":"  public void testInvalidCherrypickSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.cherrypick_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-11-14 07:55:36","endLine":187,"groupId":"4511","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testInvalidCherrypickSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/9d/f5639073e8cb81a1f5411385aaf3e3263a0187.src","preCode":"  public void testInvalidCherrypickSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.cherrypick_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestCherrypickSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":163,"status":"B"}],"commitId":"165a278086f4b9b75f65e947ed4064fe5d633e83","commitMessage":"@@@Spark: Add CherrypickSnapshotProcedure (#1771)\n\n","date":"2020-11-14 07:55:36","modifiedFileCount":"1","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-12-03 08:34:37","codes":[{"authorDate":"2020-12-03 08:34:37","commitOrder":3,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rollback_to_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-12-03 08:34:37","endLine":271,"groupId":"4511","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/8c/e8a35c60e827a8ad11f428c3be17835f0e809f.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rollback_to_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRollbackToSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":235,"status":"M"},{"authorDate":"2020-12-03 08:34:37","commitOrder":3,"curCode":"  public void testInvalidCherrypickSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.cherrypick_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-12-03 08:34:37","endLine":187,"groupId":"4511","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testInvalidCherrypickSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/76/641d930d7522d8ca273be4f62fb0b4645de5a5.src","preCode":"  public void testInvalidCherrypickSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.cherrypick_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestCherrypickSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":163,"status":"M"}],"commitId":"a4e1cdb2bb595a1257af2fa460216bcdf682977b","commitMessage":"@@@Spark: Fix resolution of procedures with expressions (#1860)\n\n","date":"2020-12-03 08:34:37","modifiedFileCount":"4","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-12-09 23:37:55","codes":[{"authorDate":"2020-12-09 23:37:55","commitOrder":4,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rollback_to_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('t')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('t', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with empty table identifier\",\n        IllegalArgumentException.class, \"Cannot handle an empty identifier\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('', 1L)\", catalogName));\n  }\n","date":"2020-12-09 23:37:55","endLine":259,"groupId":"101078","id":5,"instanceNumber":1,"isCurCommit":1,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/d3/e6bdcbc285bf81ffadbacb3d7f403472e3cde8.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rollback_to_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rollback_to_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRollbackToSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":231,"status":"M"},{"authorDate":"2020-12-09 23:37:55","commitOrder":4,"curCode":"  public void testInvalidCherrypickSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.cherrypick_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('t')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with empty table identifier\",\n        IllegalArgumentException.class, \"Cannot handle an empty identifier\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('t', 2.2)\", catalogName));\n  }\n","date":"2020-12-09 23:37:55","endLine":179,"groupId":"101078","id":6,"instanceNumber":2,"isCurCommit":1,"methodName":"testInvalidCherrypickSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ba/1c5db167477d4526c560b5f6a422f692c5cd46.src","preCode":"  public void testInvalidCherrypickSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.cherrypick_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.cherrypick_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestCherrypickSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"M"}],"commitId":"e39584ed89356cacf006610bffd475a3ad3a1ac4","commitMessage":"@@@Spark: Migrate to identifiers in procedures (#1890)\n\n","date":"2020-12-09 23:37:55","modifiedFileCount":"16","status":"M","submitter":"Russell Spitzer"}]
