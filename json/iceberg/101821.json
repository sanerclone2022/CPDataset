[{"authorTime":"2020-02-04 06:53:50","codes":[{"authorDate":"2020-02-04 06:53:50","commitOrder":1,"curCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    long snapshotId = snapshot.snapshotId();\n    List<ManifestFile> manifests = table.currentSnapshot().manifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshotId, snapshotId),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","date":"2020-02-04 06:53:50","endLine":562,"groupId":"1494","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testAppendManifestWithSnapshotIdInheritance","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/21/690e43383dc745d1046be864e113ccf9f3ded2.src","preCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    long snapshotId = snapshot.snapshotId();\n    List<ManifestFile> manifests = table.currentSnapshot().manifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshotId, snapshotId),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMergeAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":528,"status":"B"},{"authorDate":"2020-02-04 06:53:50","commitOrder":1,"curCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newFastAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    List<ManifestFile> manifests = table.currentSnapshot().manifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshot.snapshotId(), snapshot.snapshotId()),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","date":"2020-02-04 06:53:50","endLine":316,"groupId":"1494","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testAppendManifestWithSnapshotIdInheritance","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f8/cb6d28f653bd4d15f72751e51b248afe24e16d.src","preCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newFastAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    List<ManifestFile> manifests = table.currentSnapshot().manifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshot.snapshotId(), snapshot.snapshotId()),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestFastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":283,"status":"B"}],"commitId":"c3dc9824b381e5e479e356be5e0f4fcf61a9fc37","commitMessage":"@@@Inherit snapshot ids for manifest entries (#675)\n\nThis change makes the snapshot ID optional for each data file in a manifest so that a null snapshot ID indicates that it should be inherited from the manifest metadata. As a consequence.  people can create manifests with missing snapshot IDs that will be assigned at commit time.\n\nCloses #504.","date":"2020-02-04 06:53:50","modifiedFileCount":"28","status":"B","submitter":"Anton Okolnychyi"},{"authorTime":"2020-06-03 03:43:03","codes":[{"authorDate":"2020-06-03 03:43:03","commitOrder":2,"curCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    long snapshotId = snapshot.snapshotId();\n    List<ManifestFile> manifests = table.currentSnapshot().allManifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshotId, snapshotId),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","date":"2020-06-03 03:43:03","endLine":578,"groupId":"1494","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testAppendManifestWithSnapshotIdInheritance","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/bc/6c6a3d5bc29e3bac1de485296afb17bde3e6ab.src","preCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    long snapshotId = snapshot.snapshotId();\n    List<ManifestFile> manifests = table.currentSnapshot().manifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshotId, snapshotId),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMergeAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":544,"status":"M"},{"authorDate":"2020-06-03 03:43:03","commitOrder":2,"curCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newFastAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    List<ManifestFile> manifests = table.currentSnapshot().allManifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshot.snapshotId(), snapshot.snapshotId()),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","date":"2020-06-03 03:43:03","endLine":356,"groupId":"1494","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testAppendManifestWithSnapshotIdInheritance","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/7d/48922dd22d902894215c9448de5a716fcc12f0.src","preCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newFastAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    List<ManifestFile> manifests = table.currentSnapshot().manifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshot.snapshotId(), snapshot.snapshotId()),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestFastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":323,"status":"M"}],"commitId":"482f420141486f5b7b02bd62dc14cdb94b9a9cca","commitMessage":"@@@Split Snapshot.manifests into dataManifests and deleteManifests (#1080)\n\nThis replaces all calls to Snapshot.manifests with calls to one of 3 new methods:\n\n* `Snapshot.allManifests` returns both delete and data manifests\n* `Snapshot.deleteManifests` returns only delete manifests\n* `Snapshot.dataManifests` returns only data manifests\n\nExisting references mostly use either `allManifests` or `dataManifests`.  depending on the context. For example.  tests with assertions for the number of manifests use `allManifests` because the test cases should validate there are no new delete manifests.  but other tests that validate rewritten manifests are deleted use `dataManifests` because only data manifests are rewritten and deleted.\n\nThis tries to make minimal changes that preserve the current behavior. Operations are not updated to support delete manifests (rewrite still only rewrites data manifests).  but will carry through the list of delete manifests correctly.","date":"2020-06-03 03:43:03","modifiedFileCount":"46","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-06-03 03:43:03","codes":[{"authorDate":"2020-08-08 09:28:52","commitOrder":3,"curCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Last sequence number should be 0\", 0, readMetadata().lastSequenceNumber());\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    long snapshotId = snapshot.snapshotId();\n    validateSnapshot(null, snapshot, 1, FILE_A, FILE_B);\n\n    List<ManifestFile> manifests = table.currentSnapshot().allManifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n    ManifestFile manifestFile = snapshot.allManifests().get(0);\n    validateManifest(manifestFile,\n        seqs(1, 1),\n        ids(snapshotId, snapshotId),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","date":"2020-08-08 09:28:52","endLine":947,"groupId":"101821","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testAppendManifestWithSnapshotIdInheritance","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/e8/8f9bf12c6bf66e32edccb75c5866b62815a9c4.src","preCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    long snapshotId = snapshot.snapshotId();\n    List<ManifestFile> manifests = table.currentSnapshot().allManifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshotId, snapshotId),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestMergeAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":909,"status":"M"},{"authorDate":"2020-06-03 03:43:03","commitOrder":3,"curCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newFastAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    List<ManifestFile> manifests = table.currentSnapshot().allManifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshot.snapshotId(), snapshot.snapshotId()),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","date":"2020-06-03 03:43:03","endLine":356,"groupId":"101821","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testAppendManifestWithSnapshotIdInheritance","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/7d/48922dd22d902894215c9448de5a716fcc12f0.src","preCode":"  public void testAppendManifestWithSnapshotIdInheritance() throws IOException {\n    table.updateProperties()\n        .set(TableProperties.SNAPSHOT_ID_INHERITANCE_ENABLED, \"true\")\n        .commit();\n\n    Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n\n    TableMetadata base = readMetadata();\n    Assert.assertNull(\"Should not have a current snapshot\", base.currentSnapshot());\n\n    ManifestFile manifest = writeManifest(FILE_A, FILE_B);\n    table.newFastAppend()\n        .appendManifest(manifest)\n        .commit();\n\n    Snapshot snapshot = table.currentSnapshot();\n    List<ManifestFile> manifests = table.currentSnapshot().allManifests();\n    Assert.assertEquals(\"Should have 1 committed manifest\", 1, manifests.size());\n\n    validateManifestEntries(manifests.get(0),\n        ids(snapshot.snapshotId(), snapshot.snapshotId()),\n        files(FILE_A, FILE_B),\n        statuses(Status.ADDED, Status.ADDED));\n\n    \r\n    Assert.assertEquals(\"Summary metadata should include 2 added files\",\n        \"2\", snapshot.summary().get(\"added-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 added records\",\n        \"2\", snapshot.summary().get(\"added-records\"));\n    Assert.assertEquals(\"Summary metadata should include 2 files in total\",\n        \"2\", snapshot.summary().get(\"total-data-files\"));\n    Assert.assertEquals(\"Summary metadata should include 2 records in total\",\n        \"2\", snapshot.summary().get(\"total-records\"));\n  }\n","realPath":"core/src/test/java/org/apache/iceberg/TestFastAppend.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":323,"status":"N"}],"commitId":"a624f6f247eb7ef5c3d6446ab98d400025d96176","commitMessage":"@@@Core: Add sequence number assertions in merge append tests (#1101)\n\n","date":"2020-08-08 09:28:52","modifiedFileCount":"2","status":"M","submitter":"Chen Junjie"}]
