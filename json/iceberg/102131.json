[{"authorTime":"2019-07-13 03:55:36","codes":[{"authorDate":"2019-08-02 04:05:56","commitOrder":4,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog);\n  }\n","date":"2019-08-02 04:05:56","endLine":332,"groupId":"3728","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ea/015ba201c30d08e500868ed8473b2ea735f2c4.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog);\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":324,"status":"B"},{"authorDate":"2019-07-13 03:55:36","commitOrder":4,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog);\n  }\n","date":"2019-07-13 03:55:36","endLine":336,"groupId":"4962","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ef/289b4ec727f99e3d010c0ee57dc974c3342ce2.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog);\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":324,"status":"NB"}],"commitId":"a7bed2bfde9ca0a179790bddf7e145c9eb6dce71","commitMessage":"@@@Spark: Add support for write-audit-publish workflows (#342)\n\n","date":"2019-08-02 04:05:56","modifiedFileCount":"6","status":"M","submitter":"Ryan Blue"},{"authorTime":"2019-11-16 08:51:06","codes":[{"authorDate":"2019-11-16 08:51:06","commitOrder":5,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2019-11-16 08:51:06","endLine":396,"groupId":"3728","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ba/a369a018d6373512fd24db245018f034aea966.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog);\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":388,"status":"M"},{"authorDate":"2019-11-16 08:51:06","commitOrder":5,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2019-11-16 08:51:06","endLine":410,"groupId":"4962","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/ba/a369a018d6373512fd24db245018f034aea966.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog);\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":398,"status":"M"}],"commitId":"c4cc4dcc427ddd62b8ae88b4120d6783d787b09e","commitMessage":"@@@Add mechanism to track and remove old metadata files (#631)\n\n","date":"2019-11-16 08:51:06","modifiedFileCount":"5","status":"M","submitter":"yathindranath"},{"authorTime":"2019-11-21 01:48:39","codes":[{"authorDate":"2019-11-21 01:48:39","commitOrder":6,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2019-11-21 01:48:39","endLine":391,"groupId":"134","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/a5/081a6b45d98b0265beffcb15ce702deb22d43b.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":383,"status":"M"},{"authorDate":"2019-11-21 01:48:39","commitOrder":6,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2019-11-21 01:48:39","endLine":405,"groupId":"4962","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/a5/081a6b45d98b0265beffcb15ce702deb22d43b.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(ops, null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":393,"status":"M"}],"commitId":"083edc1f749d9a64cd4042fb360a27a0a3bfe03c","commitMessage":"@@@Decouple TableMetadataParser and TableMetadata from TableOperations (#591)\n\nThe rationale behind not using TableOperations is:\n1. It saves the need to construct a TableOperations instance when you\n?? want to get a table's metadata by parsing its metadata files.\n2. It's more intuitive because a TableMetadata instance reflects a\n?? table's state and is determined by only a set of metadata files.","date":"2019-11-21 01:48:39","modifiedFileCount":"19","status":"M","submitter":"Xingyuan Lin"},{"authorTime":"2020-02-05 05:49:56","codes":[{"authorDate":"2019-11-21 01:48:39","commitOrder":7,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2019-11-21 01:48:39","endLine":391,"groupId":"134","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/a5/081a6b45d98b0265beffcb15ce702deb22d43b.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":383,"status":"N"},{"authorDate":"2020-02-05 05:49:56","commitOrder":7,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-02-05 05:49:56","endLine":410,"groupId":"4962","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/e4/4e002bdab4aad9d832c41850ad4ccbccda711c.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":393,"status":"M"}],"commitId":"a0ff334f2a9b0e1a429ccf69a85a12e8c255ed33","commitMessage":"@@@Add SnapshotManager to roll back and cherry-pick snapshots (#695)\n\n","date":"2020-02-05 05:49:56","modifiedFileCount":"10","status":"M","submitter":"Gautam"},{"authorTime":"2020-04-10 03:14:34","codes":[{"authorDate":"2020-04-10 03:14:34","commitOrder":8,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-04-10 03:14:34","endLine":393,"groupId":"134","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/4d/12cf5ce84c370fa98ed513c21830bbbf9dc5ac.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":385,"status":"M"},{"authorDate":"2020-04-10 03:14:34","commitOrder":8,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-04-10 03:14:34","endLine":412,"groupId":"4962","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/4d/12cf5ce84c370fa98ed513c21830bbbf9dc5ac.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(null, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":395,"status":"M"}],"commitId":"c094da57db072187b2d930ae6c5590218012ec3f","commitMessage":"@@@Prepare metadata writers for format v2 (#903)\n\n* Track format version in TableMetadata.\n* Pass formatVersion when creating a manifest writer.\n* Pass formatVersion when creating a manifest list writer.\n* Add v2 change section to spec.","date":"2020-04-10 03:14:34","modifiedFileCount":"12","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-04-11 07:02:33","codes":[{"authorDate":"2020-04-11 07:02:33","commitOrder":9,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-04-11 07:02:33","endLine":411,"groupId":"1030","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f3/bd7b226f9acc00a154e5b271870a639551114a.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":398,"status":"M"},{"authorDate":"2020-04-11 07:02:33","commitOrder":9,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-04-11 07:02:33","endLine":435,"groupId":"4962","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f3/bd7b226f9acc00a154e5b271870a639551114a.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":413,"status":"M"}],"commitId":"720b240a3e6a32b6f01173ebcc448c2c6e32e13a","commitMessage":"@@@Update Snapshot and TableMetadata with sequence numbers (#910)\n\n","date":"2020-04-11 07:02:33","modifiedFileCount":"11","status":"M","submitter":"Ryan Blue"},{"authorTime":"2020-09-04 13:48:01","codes":[{"authorDate":"2020-09-04 13:48:01","commitOrder":10,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        defaultSortOrderId, sortOrders, properties, currentSnapshotId, newSnapshots, snapshotLog,\n        addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-09-04 13:48:01","endLine":508,"groupId":"1030","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/31/155778969ed81f2c7876fe5815b9df47c8b15e.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        currentSnapshotId, newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":494,"status":"M"},{"authorDate":"2020-09-04 13:48:01","commitOrder":10,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        defaultSortOrderId, sortOrders, properties, snapshot.snapshotId(), newSnapshots, newSnapshotLog,\n        addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2020-09-04 13:48:01","endLine":533,"groupId":"4962","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/31/155778969ed81f2c7876fe5815b9df47c8b15e.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs, properties,\n        snapshot.snapshotId(), newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":510,"status":"M"}],"commitId":"454101c3573acb9cd94d6d9a306ed99a5a324ed9","commitMessage":"@@@API: Implement SortOrder (#1373)\n\nThis commit extends Iceberg metadata with a sort order that defines how data and delete files should be ordered.","date":"2020-09-04 13:48:01","modifiedFileCount":"17","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2021-01-31 05:48:52","codes":[{"authorDate":"2021-01-31 05:48:52","commitOrder":11,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        lastAssignedPartitionId, defaultSortOrderId, sortOrders, properties, currentSnapshotId,\n        newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2021-01-31 05:48:52","endLine":559,"groupId":"1030","id":15,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/cf/8e64b0203dd2ed2897b51440dfd8385b3739fd.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        defaultSortOrderId, sortOrders, properties, currentSnapshotId, newSnapshots, snapshotLog,\n        addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":545,"status":"M"},{"authorDate":"2021-01-31 05:48:52","commitOrder":11,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        lastAssignedPartitionId, defaultSortOrderId, sortOrders, properties, snapshot.snapshotId(),\n        newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2021-01-31 05:48:52","endLine":584,"groupId":"4962","id":16,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/cf/8e64b0203dd2ed2897b51440dfd8385b3739fd.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        defaultSortOrderId, sortOrders, properties, snapshot.snapshotId(), newSnapshots, newSnapshotLog,\n        addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":561,"status":"M"}],"commitId":"b3e01b74fb8909d0c5aa3f9a1b9468471e03c13c","commitMessage":"@@@Core: Add lastAssignedPartitionId to TableMetadata (#2089)\n\n","date":"2021-01-31 05:48:52","modifiedFileCount":"5","status":"M","submitter":"jun-he"},{"authorTime":"2021-02-23 08:16:04","codes":[{"authorDate":"2021-02-23 08:16:04","commitOrder":12,"curCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId,\n        currentSchemaId, schemas, defaultSpecId, specs, lastAssignedPartitionId,\n        defaultSortOrderId, sortOrders, properties, currentSnapshotId, newSnapshots, snapshotLog,\n        addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2021-02-23 08:16:04","endLine":595,"groupId":"102131","id":17,"instanceNumber":1,"isCurCommit":0,"methodName":"addStagedSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/1e/33c54b8ec6d005786743f882bb7125cdcc4e00.src","preCode":"  public TableMetadata addStagedSnapshot(Snapshot snapshot) {\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        lastAssignedPartitionId, defaultSortOrderId, sortOrders, properties, currentSnapshotId,\n        newSnapshots, snapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":580,"status":"M"},{"authorDate":"2021-02-23 08:16:04","commitOrder":12,"curCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId,\n        currentSchemaId, schemas, defaultSpecId, specs, lastAssignedPartitionId,\n        defaultSortOrderId, sortOrders, properties, snapshot.snapshotId(), newSnapshots, newSnapshotLog,\n        addPreviousFile(file, lastUpdatedMillis));\n  }\n","date":"2021-02-23 08:16:04","endLine":621,"groupId":"102131","id":18,"instanceNumber":2,"isCurCommit":0,"methodName":"replaceCurrentSnapshot","params":"(Snapshotsnapshot)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/1e/33c54b8ec6d005786743f882bb7125cdcc4e00.src","preCode":"  public TableMetadata replaceCurrentSnapshot(Snapshot snapshot) {\n    \r\n    if (snapshotsById.containsKey(snapshot.snapshotId())) {\n      return setCurrentSnapshotTo(snapshot);\n    }\n\n    ValidationException.check(formatVersion == 1 || snapshot.sequenceNumber() > lastSequenceNumber,\n        \"Cannot add snapshot with sequence number %s older than last sequence number %s\",\n        snapshot.sequenceNumber(), lastSequenceNumber);\n\n    List<Snapshot> newSnapshots = ImmutableList.<Snapshot>builder()\n        .addAll(snapshots)\n        .add(snapshot)\n        .build();\n    List<HistoryEntry> newSnapshotLog = ImmutableList.<HistoryEntry>builder()\n        .addAll(snapshotLog)\n        .add(new SnapshotLogEntry(snapshot.timestampMillis(), snapshot.snapshotId()))\n        .build();\n\n    return new TableMetadata(null, formatVersion, uuid, location,\n        snapshot.sequenceNumber(), snapshot.timestampMillis(), lastColumnId, schema, defaultSpecId, specs,\n        lastAssignedPartitionId, defaultSortOrderId, sortOrders, properties, snapshot.snapshotId(),\n        newSnapshots, newSnapshotLog, addPreviousFile(file, lastUpdatedMillis));\n  }\n","realPath":"core/src/main/java/org/apache/iceberg/TableMetadata.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":597,"status":"M"}],"commitId":"255e9525c5bfeb7b57e49a2d96178ebe615c5e16","commitMessage":"@@@Core: Add current-schema-id and schemas to table metadata (#2096)\n\n","date":"2021-02-23 08:16:04","modifiedFileCount":"8","status":"M","submitter":"yyanyy"}]
