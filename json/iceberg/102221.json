[{"authorTime":"2020-08-29 01:19:33","codes":[{"authorDate":"2020-08-29 01:19:33","commitOrder":1,"curCode":"  public void testSnapshotTwice() throws Exception {\n    long checkpointId = 1;\n    long timestamp = 1;\n    try (OneInputStreamOperatorTestHarness<RowData, DataFile> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), timestamp++);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), timestamp);\n\n      testHarness.prepareSnapshotPreBarrier(checkpointId++);\n      long expectedDataFiles = partitioned ? 2 : 1;\n      Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n\n      \r\n      for (int i = 0; i < 5; i++) {\n        testHarness.prepareSnapshotPreBarrier(checkpointId++);\n        Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n      }\n    }\n  }\n","date":"2020-08-29 01:19:33","endLine":158,"groupId":"4057","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testSnapshotTwice","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f4/e10d56c330b5500071e1523280ed9c3fe81931.src","preCode":"  public void testSnapshotTwice() throws Exception {\n    long checkpointId = 1;\n    long timestamp = 1;\n    try (OneInputStreamOperatorTestHarness<RowData, DataFile> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), timestamp++);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), timestamp);\n\n      testHarness.prepareSnapshotPreBarrier(checkpointId++);\n      long expectedDataFiles = partitioned ? 2 : 1;\n      Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n\n      \r\n      for (int i = 0; i < 5; i++) {\n        testHarness.prepareSnapshotPreBarrier(checkpointId++);\n        Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n      }\n    }\n  }\n","realPath":"flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergStreamWriter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":141,"status":"B"},{"authorDate":"2020-08-29 01:19:33","commitOrder":1,"curCode":"  public void testBoundedStreamCloseWithEmittingDataFiles() throws Exception {\n    try (OneInputStreamOperatorTestHarness<RowData, DataFile> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), 1);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), 2);\n\n      Assert.assertTrue(testHarness.getOneInputOperator() instanceof BoundedOneInput);\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      long expectedDataFiles = partitioned ? 2 : 1;\n      Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n\n      \r\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n      Assert.assertEquals(expectedDataFiles * 2, testHarness.extractOutputValues().size());\n    }\n  }\n","date":"2020-08-29 01:19:33","endLine":214,"groupId":"1496","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testBoundedStreamCloseWithEmittingDataFiles","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f4/e10d56c330b5500071e1523280ed9c3fe81931.src","preCode":"  public void testBoundedStreamCloseWithEmittingDataFiles() throws Exception {\n    try (OneInputStreamOperatorTestHarness<RowData, DataFile> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), 1);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), 2);\n\n      Assert.assertTrue(testHarness.getOneInputOperator() instanceof BoundedOneInput);\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      long expectedDataFiles = partitioned ? 2 : 1;\n      Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n\n      \r\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n      Assert.assertEquals(expectedDataFiles * 2, testHarness.extractOutputValues().size());\n    }\n  }\n","realPath":"flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergStreamWriter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":199,"status":"B"}],"commitId":"f950a3e63c98e88b1f8905faacf33a1d5d31e4c0","commitMessage":"@@@Flink: Add operator to collect data files and append to a table (#1185)\n\n","date":"2020-08-29 01:19:33","modifiedFileCount":"2","status":"B","submitter":"openinx"},{"authorTime":"2020-12-19 01:57:04","codes":[{"authorDate":"2020-12-19 01:57:04","commitOrder":2,"curCode":"  public void testSnapshotTwice() throws Exception {\n    long checkpointId = 1;\n    long timestamp = 1;\n    try (OneInputStreamOperatorTestHarness<RowData, WriteResult> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), timestamp++);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), timestamp);\n\n      testHarness.prepareSnapshotPreBarrier(checkpointId++);\n      long expectedDataFiles = partitioned ? 2 : 1;\n      WriteResult result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n\n      \r\n      for (int i = 0; i < 5; i++) {\n        testHarness.prepareSnapshotPreBarrier(checkpointId++);\n\n        result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n        Assert.assertEquals(0, result.deleteFiles().length);\n        Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n      }\n    }\n  }\n","date":"2020-12-19 01:57:04","endLine":169,"groupId":"3491","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testSnapshotTwice","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/28/db89456f7e510f35030829765640f84f560de1.src","preCode":"  public void testSnapshotTwice() throws Exception {\n    long checkpointId = 1;\n    long timestamp = 1;\n    try (OneInputStreamOperatorTestHarness<RowData, DataFile> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), timestamp++);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), timestamp);\n\n      testHarness.prepareSnapshotPreBarrier(checkpointId++);\n      long expectedDataFiles = partitioned ? 2 : 1;\n      Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n\n      \r\n      for (int i = 0; i < 5; i++) {\n        testHarness.prepareSnapshotPreBarrier(checkpointId++);\n        Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n      }\n    }\n  }\n","realPath":"flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergStreamWriter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":147,"status":"M"},{"authorDate":"2020-12-19 01:57:04","commitOrder":2,"curCode":"  public void testBoundedStreamCloseWithEmittingDataFiles() throws Exception {\n    try (OneInputStreamOperatorTestHarness<RowData, WriteResult> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), 1);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), 2);\n\n      Assert.assertTrue(testHarness.getOneInputOperator() instanceof BoundedOneInput);\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      long expectedDataFiles = partitioned ? 2 : 1;\n      WriteResult result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n\n      \r\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles * 2, result.dataFiles().length);\n    }\n  }\n","date":"2020-12-19 01:57:04","endLine":230,"groupId":"674","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testBoundedStreamCloseWithEmittingDataFiles","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/28/db89456f7e510f35030829765640f84f560de1.src","preCode":"  public void testBoundedStreamCloseWithEmittingDataFiles() throws Exception {\n    try (OneInputStreamOperatorTestHarness<RowData, DataFile> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), 1);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), 2);\n\n      Assert.assertTrue(testHarness.getOneInputOperator() instanceof BoundedOneInput);\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      long expectedDataFiles = partitioned ? 2 : 1;\n      Assert.assertEquals(expectedDataFiles, testHarness.extractOutputValues().size());\n\n      \r\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n      Assert.assertEquals(expectedDataFiles * 2, testHarness.extractOutputValues().size());\n    }\n  }\n","realPath":"flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergStreamWriter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":210,"status":"M"}],"commitId":"77c5617c102c2ab27fbf35cac3fd75380a887d5d","commitMessage":"@@@Flink: Commit both data files and delete files (#1939)\n\n","date":"2020-12-19 01:57:04","modifiedFileCount":"9","status":"M","submitter":"openinx"},{"authorTime":"2021-07-19 18:57:09","codes":[{"authorDate":"2020-12-19 01:57:04","commitOrder":3,"curCode":"  public void testSnapshotTwice() throws Exception {\n    long checkpointId = 1;\n    long timestamp = 1;\n    try (OneInputStreamOperatorTestHarness<RowData, WriteResult> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), timestamp++);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), timestamp);\n\n      testHarness.prepareSnapshotPreBarrier(checkpointId++);\n      long expectedDataFiles = partitioned ? 2 : 1;\n      WriteResult result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n\n      \r\n      for (int i = 0; i < 5; i++) {\n        testHarness.prepareSnapshotPreBarrier(checkpointId++);\n\n        result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n        Assert.assertEquals(0, result.deleteFiles().length);\n        Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n      }\n    }\n  }\n","date":"2020-12-19 01:57:04","endLine":169,"groupId":"102221","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testSnapshotTwice","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/28/db89456f7e510f35030829765640f84f560de1.src","preCode":"  public void testSnapshotTwice() throws Exception {\n    long checkpointId = 1;\n    long timestamp = 1;\n    try (OneInputStreamOperatorTestHarness<RowData, WriteResult> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), timestamp++);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), timestamp);\n\n      testHarness.prepareSnapshotPreBarrier(checkpointId++);\n      long expectedDataFiles = partitioned ? 2 : 1;\n      WriteResult result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n\n      \r\n      for (int i = 0; i < 5; i++) {\n        testHarness.prepareSnapshotPreBarrier(checkpointId++);\n\n        result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n        Assert.assertEquals(0, result.deleteFiles().length);\n        Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n      }\n    }\n  }\n","realPath":"flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergStreamWriter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":147,"status":"N"},{"authorDate":"2021-07-19 18:57:09","commitOrder":3,"curCode":"  public void testBoundedStreamCloseWithEmittingDataFiles() throws Exception {\n    try (OneInputStreamOperatorTestHarness<RowData, WriteResult> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), 1);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), 2);\n\n      Assertions.assertThat(testHarness.getOneInputOperator()).isInstanceOf(BoundedOneInput.class);\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      long expectedDataFiles = partitioned ? 2 : 1;\n      WriteResult result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n\n      \r\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles * 2, result.dataFiles().length);\n    }\n  }\n","date":"2021-07-19 18:57:09","endLine":232,"groupId":"102221","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testBoundedStreamCloseWithEmittingDataFiles","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/e5/ffd01042c31d57e434f8aa35e48b74842e909e.src","preCode":"  public void testBoundedStreamCloseWithEmittingDataFiles() throws Exception {\n    try (OneInputStreamOperatorTestHarness<RowData, WriteResult> testHarness = createIcebergStreamWriter()) {\n      testHarness.processElement(SimpleDataUtil.createRowData(1, \"hello\"), 1);\n      testHarness.processElement(SimpleDataUtil.createRowData(2, \"world\"), 2);\n\n      Assert.assertTrue(testHarness.getOneInputOperator() instanceof BoundedOneInput);\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      long expectedDataFiles = partitioned ? 2 : 1;\n      WriteResult result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles, result.dataFiles().length);\n\n      \r\n      ((BoundedOneInput) testHarness.getOneInputOperator()).endInput();\n\n      result = WriteResult.builder().addAll(testHarness.extractOutputValues()).build();\n      Assert.assertEquals(0, result.deleteFiles().length);\n      Assert.assertEquals(expectedDataFiles * 2, result.dataFiles().length);\n    }\n  }\n","realPath":"flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergStreamWriter.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":212,"status":"M"}],"commitId":"0055e855ccabbd6a592b3b49e1f38131f62e0fdd","commitMessage":"@@@Move Assert.assertTrue(..) instance checks to AssertJ assertions (#2756)\n\n","date":"2021-07-19 18:57:09","modifiedFileCount":"25","status":"M","submitter":"Eduard Tudenh?fner"}]
