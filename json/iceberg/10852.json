[{"authorTime":"2021-04-13 12:02:48","codes":[{"authorDate":"2021-04-13 12:02:48","commitOrder":1,"curCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(\"migrated\", \"true\");\n\n    \r\n    properties.putIfAbsent(LOCATION, sourceTableLocation());\n\n    return properties;\n  }\n","date":"2021-04-13 12:02:48","endLine":173,"groupId":"388","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"destTableProps","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/02/1c5e593631cb783c7787aacdc12c07be2b4e19.src","preCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(\"migrated\", \"true\");\n\n    \r\n    properties.putIfAbsent(LOCATION, sourceTableLocation());\n\n    return properties;\n  }\n","realPath":"spark3/src/main/java/org/apache/iceberg/spark/actions/BaseMigrateTableSparkAction.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":155,"status":"B"},{"authorDate":"2021-04-13 12:02:48","commitOrder":1,"curCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.remove(LOCATION);\n    properties.remove(TableProperties.WRITE_METADATA_LOCATION);\n    properties.remove(TableProperties.WRITE_NEW_DATA_LOCATION);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(TableProperties.GC_ENABLED, \"false\");\n    properties.put(\"snapshot\", \"true\");\n\n    \r\n    if (destTableLocation != null) {\n      properties.put(LOCATION, destTableLocation);\n    }\n\n    return properties;\n  }\n","date":"2021-04-13 12:02:48","endLine":185,"groupId":"237","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"destTableProps","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/4d/4f37ba1467144637ebee9e46fa09f32a52c45e.src","preCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.remove(LOCATION);\n    properties.remove(TableProperties.WRITE_METADATA_LOCATION);\n    properties.remove(TableProperties.WRITE_NEW_DATA_LOCATION);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(TableProperties.GC_ENABLED, \"false\");\n    properties.put(\"snapshot\", \"true\");\n\n    \r\n    if (destTableLocation != null) {\n      properties.put(LOCATION, destTableLocation);\n    }\n\n    return properties;\n  }\n","realPath":"spark3/src/main/java/org/apache/iceberg/spark/actions/BaseSnapshotTableSparkAction.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":159,"status":"B"}],"commitId":"6eaabb59653f51bdfbb4063ebe14632b1f044d96","commitMessage":"@@@Spark: Refactor snapshot and migrate actions (#2437)\n\n","date":"2021-04-13 12:02:48","modifiedFileCount":"4","status":"B","submitter":"Anton Okolnychyi"},{"authorTime":"2021-08-24 00:27:42","codes":[{"authorDate":"2021-04-13 12:02:48","commitOrder":2,"curCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(\"migrated\", \"true\");\n\n    \r\n    properties.putIfAbsent(LOCATION, sourceTableLocation());\n\n    return properties;\n  }\n","date":"2021-04-13 12:02:48","endLine":173,"groupId":"388","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"destTableProps","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/02/1c5e593631cb783c7787aacdc12c07be2b4e19.src","preCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(\"migrated\", \"true\");\n\n    \r\n    properties.putIfAbsent(LOCATION, sourceTableLocation());\n\n    return properties;\n  }\n","realPath":"spark3/src/main/java/org/apache/iceberg/spark/actions/BaseMigrateTableSparkAction.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":155,"status":"N"},{"authorDate":"2021-08-24 00:27:42","commitOrder":2,"curCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.remove(LOCATION);\n    properties.remove(TableProperties.WRITE_METADATA_LOCATION);\n    properties.remove(TableProperties.WRITE_FOLDER_STORAGE_LOCATION);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(TableProperties.GC_ENABLED, \"false\");\n    properties.put(\"snapshot\", \"true\");\n\n    \r\n    if (destTableLocation != null) {\n      properties.put(LOCATION, destTableLocation);\n    }\n\n    return properties;\n  }\n","date":"2021-08-24 00:27:42","endLine":186,"groupId":"237","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"destTableProps","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/fd/c5bf09ce4d3c0483c6090302e616de23f970cb.src","preCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.remove(LOCATION);\n    properties.remove(TableProperties.WRITE_METADATA_LOCATION);\n    properties.remove(TableProperties.WRITE_NEW_DATA_LOCATION);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(TableProperties.GC_ENABLED, \"false\");\n    properties.put(\"snapshot\", \"true\");\n\n    \r\n    if (destTableLocation != null) {\n      properties.put(LOCATION, destTableLocation);\n    }\n\n    return properties;\n  }\n","realPath":"spark3/src/main/java/org/apache/iceberg/spark/actions/BaseSnapshotTableSparkAction.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":160,"status":"M"}],"commitId":"aef12c0e702ef8c306826581893963e3dc5f6ba3","commitMessage":"@@@Core: Rename WRITE_NEW_DATA_LOCATION to WRITE_FOLDER_STORAGE_LOCATION (#2965)\n\n","date":"2021-08-24 00:27:42","modifiedFileCount":"7","status":"M","submitter":"Jack Ye"},{"authorTime":"2021-09-23 02:18:43","codes":[{"authorDate":"2021-04-13 12:02:48","commitOrder":3,"curCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(\"migrated\", \"true\");\n\n    \r\n    properties.putIfAbsent(LOCATION, sourceTableLocation());\n\n    return properties;\n  }\n","date":"2021-04-13 12:02:48","endLine":173,"groupId":"10852","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"destTableProps","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/02/1c5e593631cb783c7787aacdc12c07be2b4e19.src","preCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(\"migrated\", \"true\");\n\n    \r\n    properties.putIfAbsent(LOCATION, sourceTableLocation());\n\n    return properties;\n  }\n","realPath":"spark3/src/main/java/org/apache/iceberg/spark/actions/BaseMigrateTableSparkAction.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":155,"status":"N"},{"authorDate":"2021-09-23 02:18:43","commitOrder":3,"curCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.remove(LOCATION);\n    properties.remove(TableProperties.WRITE_METADATA_LOCATION);\n    properties.remove(TableProperties.WRITE_FOLDER_STORAGE_LOCATION);\n    properties.remove(TableProperties.OBJECT_STORE_PATH);\n    properties.remove(TableProperties.WRITE_DATA_LOCATION);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(TableProperties.GC_ENABLED, \"false\");\n    properties.put(\"snapshot\", \"true\");\n\n    \r\n    if (destTableLocation != null) {\n      properties.put(LOCATION, destTableLocation);\n    }\n\n    return properties;\n  }\n","date":"2021-09-23 02:18:43","endLine":188,"groupId":"10852","id":6,"instanceNumber":2,"isCurCommit":1,"methodName":"destTableProps","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/1c/cb448f1dccbfe63111e9947841fcfa27ea539e.src","preCode":"  protected Map<String, String> destTableProps() {\n    Map<String, String> properties = Maps.newHashMap();\n\n    \r\n    properties.putAll(JavaConverters.mapAsJavaMapConverter(v1SourceTable().properties()).asJava());\n    EXCLUDED_PROPERTIES.forEach(properties::remove);\n\n    \r\n    properties.remove(LOCATION);\n    properties.remove(TableProperties.WRITE_METADATA_LOCATION);\n    properties.remove(TableProperties.WRITE_FOLDER_STORAGE_LOCATION);\n\n    \r\n    properties.put(TableCatalog.PROP_PROVIDER, \"iceberg\");\n    properties.putAll(additionalProperties());\n\n    \r\n    properties.put(TableProperties.GC_ENABLED, \"false\");\n    properties.put(\"snapshot\", \"true\");\n\n    \r\n    if (destTableLocation != null) {\n      properties.put(LOCATION, destTableLocation);\n    }\n\n    return properties;\n  }\n","realPath":"spark3/src/main/java/org/apache/iceberg/spark/actions/BaseSnapshotTableSparkAction.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":160,"status":"M"}],"commitId":"12e30ebaeb6dc0ff7e6bb01c0d9f8ae8a5f06ddf","commitMessage":"@@@Core: Prefer write.data.path to write.folder-storage.path or write.object-storage.path (#3094)\n\n","date":"2021-09-23 02:18:43","modifiedFileCount":"7","status":"M","submitter":"Yufei Gu"}]
