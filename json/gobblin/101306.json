[{"authorTime":"2017-07-31 15:51:25","codes":[{"authorDate":"2017-07-31 15:51:25","commitOrder":1,"curCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closed, false);\n    Assert.assertEquals(dummyWriters.get(0).committed, false);\n  }\n","date":"2017-07-31 15:51:25","endLine":49,"groupId":"4800","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testCloseOnFlushDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/11/b2274d0100e951dd2fcfec7f3b5f15af32a4fc.src","preCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closed, false);\n    Assert.assertEquals(dummyWriters.get(0).committed, false);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":34,"status":"B"},{"authorDate":"2017-07-31 15:51:25","commitOrder":1,"curCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closed, true);\n    Assert.assertEquals(dummyWriters.get(0).committed, true);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closed, true);\n    Assert.assertEquals(dummyWriters.get(1).committed, true);\n  }\n","date":"2017-07-31 15:51:25","endLine":97,"groupId":"4800","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testWriteAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/11/b2274d0100e951dd2fcfec7f3b5f15af32a4fc.src","preCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closed, true);\n    Assert.assertEquals(dummyWriters.get(0).committed, true);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closed, true);\n    Assert.assertEquals(dummyWriters.get(1).committed, true);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":71,"status":"B"}],"commitId":"5457af88d56b8fb89b172129fd1ff24ecdd4eba8","commitMessage":"@@@Merge pull request #2031 from abti/move_packages_to_apache\n","date":"2017-07-31 15:51:25","modifiedFileCount":"2","status":"B","submitter":"Abhishek Tiwari"},{"authorTime":"2017-08-10 00:04:03","codes":[{"authorDate":"2017-08-10 00:04:03","commitOrder":2,"curCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertFalse(dummyWriters.get(0).closed);\n    Assert.assertFalse(dummyWriters.get(0).committed);\n    Assert.assertTrue(dummyWriters.get(0).handlerCalled);\n  }\n","date":"2017-08-10 00:04:03","endLine":53,"groupId":"3659","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testCloseOnFlushDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/b1/4793a866414e16945adc8742c5b4385a3433d8.src","preCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closed, false);\n    Assert.assertEquals(dummyWriters.get(0).committed, false);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":37,"status":"M"},{"authorDate":"2017-08-10 00:04:03","commitOrder":2,"curCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).closed);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).closed);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","date":"2017-08-10 00:04:03","endLine":105,"groupId":"7621","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testWriteAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/b1/4793a866414e16945adc8742c5b4385a3433d8.src","preCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closed, true);\n    Assert.assertEquals(dummyWriters.get(0).committed, true);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.flush();\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closed, true);\n    Assert.assertEquals(dummyWriters.get(1).committed, true);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":77,"status":"M"}],"commitId":"f502cbee33282c89438613c5882018006c5f3225","commitMessage":"@@@[GOBBLIN-184] Call the flush method of CloseOnFlushWriterWrapper when a FlushControlMessage is received\n\nCloses #2040 from\nhtran1/close_on_flush_handler_fix\n","date":"2017-08-10 00:04:03","modifiedFileCount":"2","status":"M","submitter":"Hung Tran"},{"authorTime":"2017-08-16 03:44:28","codes":[{"authorDate":"2017-08-16 03:44:28","commitOrder":3,"curCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 0);\n    Assert.assertFalse(dummyWriters.get(0).committed);\n    Assert.assertTrue(dummyWriters.get(0).handlerCalled);\n  }\n","date":"2017-08-16 03:44:28","endLine":53,"groupId":"3659","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testCloseOnFlushDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/60/0657289b785a942b257f5d29dcfd0fdc26dcea.src","preCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertFalse(dummyWriters.get(0).closed);\n    Assert.assertFalse(dummyWriters.get(0).committed);\n    Assert.assertTrue(dummyWriters.get(0).handlerCalled);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":37,"status":"M"},{"authorDate":"2017-08-16 03:44:28","commitOrder":3,"curCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","date":"2017-08-16 03:44:28","endLine":105,"groupId":"7621","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testWriteAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/60/0657289b785a942b257f5d29dcfd0fdc26dcea.src","preCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).closed);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).closed);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":77,"status":"M"}],"commitId":"eca08356b0a460627d0db90bc397858497e6e29d","commitMessage":"@@@[GOBBLIN-206] Remove extra close of CloseOnFlushWriterWrapper\n\n[GOBBLIN-206] Remove extra close of\nCloseOnFlushWriterWrapper\n\nFix test.\n\nCloses #2058 from htran1/close_fix_1\n","date":"2017-08-16 03:44:28","modifiedFileCount":"2","status":"M","submitter":"Hung Tran"},{"authorTime":"2017-09-21 05:25:02","codes":[{"authorDate":"2017-09-21 05:25:02","commitOrder":4,"curCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n\n    writer.getMessageHandler().handleMessage(FlushControlMessage.builder().build());\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 0);\n    Assert.assertFalse(dummyWriters.get(0).committed);\n    Assert.assertEquals(dummyWriters.get(0).handlerCalled, 1);\n  }\n","date":"2017-09-21 05:25:02","endLine":55,"groupId":"101306","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testCloseOnFlushDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/ef/435b13a801b51cbd400993be204752fa043fe2.src","preCode":"  public void testCloseOnFlushDisabled()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 0);\n    Assert.assertFalse(dummyWriters.get(0).committed);\n    Assert.assertTrue(dummyWriters.get(0).handlerCalled);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":38,"status":"M"},{"authorDate":"2017-09-21 05:25:02","commitOrder":4,"curCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(CloseOnFlushWriterWrapper.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(FlushControlMessage.builder().build());\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertEquals(dummyWriters.get(0).handlerCalled, 1);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(FlushControlMessage.builder().build());\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertEquals(dummyWriters.get(1).handlerCalled, 1);\n  }\n","date":"2017-09-21 05:25:02","endLine":106,"groupId":"101306","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testWriteAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/ef/435b13a801b51cbd400993be204752fa043fe2.src","preCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":78,"status":"M"}],"commitId":"99b71523887c7d7f780ac78c20941093bd3751f5","commitMessage":"@@@[GOBBLIN-234] Add a ControlMessageInjector that generates metadata up?\n\nCloses #2107 from htran1/metadata_update\n","date":"2017-09-21 05:25:02","modifiedFileCount":"9","status":"M","submitter":"Hung Tran"}]
