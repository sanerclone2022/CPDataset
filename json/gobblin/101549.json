[{"authorTime":"2019-09-24 01:16:28","codes":[{"authorDate":"2020-04-17 07:05:57","commitOrder":2,"curCode":"  private void reloadFolder(List<FileStatus> statuses, File outputDir, FileSystem fs) throws IOException {\n    statuses.clear();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), extensionName);\n      }\n    })) {\n      statuses.add(status);\n    }\n  }\n","date":"2020-04-17 07:05:57","endLine":173,"groupId":"4168","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"reloadFolder","params":"(List<FileStatus>statuses@FileoutputDir@FileSystemfs)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/e6/a3fab61a199d8d23a6608cfd408c23e654a2db.src","preCode":"  private void reloadFolder(List<FileStatus> statuses, File outputDir, FileSystem fs) throws IOException {\n    statuses.clear();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), extensionName);\n      }\n    })) {\n      statuses.add(status);\n    }\n  }\n","realPath":"gobblin-compaction/src/test/java/org/apache/gobblin/compaction/mapreduce/OrcCompactionTaskTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":163,"status":"B"},{"authorDate":"2019-09-24 01:16:28","commitOrder":2,"curCode":"  public void testNonDedup() throws Exception {\n    File basePath = Files.createTempDir();\n    basePath.deleteOnExit();\n\n    String minutelyPath = \"Identity/MemberAccount_2/minutely/2017/04/03/10/20_30/run_2017-04-03-10-20\";\n    String hourlyPath = \"Identity/MemberAccount_2/hourly/2017/04/03/10/\";\n    File jobDir = new File(basePath, minutelyPath);\n    Assert.assertTrue(jobDir.mkdirs());\n\n    createTestingData(jobDir);\n\n    EmbeddedGobblin embeddedGobblin_nondedup = createEmbeddedGobblin(\"basic\", basePath.getAbsolutePath().toString())\n        .setConfiguration(CompactionJobConfigurator.COMPACTION_JOB_CONFIGURATOR_FACTORY_CLASS_KEY,\n            TestCompactionOrcJobConfigurator.Factory.class.getName())\n        .setConfiguration(COMPACTION_OUTPUT_EXTENSION, \"orc\")\n        .setConfiguration(COMPACTION_SHOULD_DEDUPLICATE, \"false\");\n    JobExecutionResult execution = embeddedGobblin_nondedup.run();\n    Assert.assertTrue(execution.isSuccessful());\n\n    \r\n    File outputDir = new File(basePath, hourlyPath);\n    FileSystem fs = FileSystem.getLocal(new Configuration());\n    List<FileStatus> statuses = new ArrayList<>();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), \"orc\");\n      }\n    })) {\n      statuses.add(status);\n    }\n\n    Assert.assertTrue(statuses.size() == 1);\n    List<OrcStruct> result = readOrcFile(statuses.get(0).getPath());\n    Assert.assertEquals(result.size(), 4);\n\n    result.sort(new Comparator<OrcStruct>() {\n      @Override\n      public int compare(OrcStruct o1, OrcStruct o2) {\n        return o1.compareTo(o2);\n      }\n    });\n    Assert.assertEquals(result.get(0).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(0).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(1).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(1).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"i\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"j\"), new IntWritable(3));\n    Assert.assertEquals(result.get(3).getFieldValue(\"i\"), new IntWritable(4));\n    Assert.assertEquals(result.get(3).getFieldValue(\"j\"), new IntWritable(5));\n  }\n","date":"2019-09-24 01:16:28","endLine":200,"groupId":"7055","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testNonDedup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/f8/557908bb131b457e9cec8fdbca8369f4adc456.src","preCode":"  public void testNonDedup() throws Exception {\n    File basePath = Files.createTempDir();\n    basePath.deleteOnExit();\n\n    String minutelyPath = \"Identity/MemberAccount_2/minutely/2017/04/03/10/20_30/run_2017-04-03-10-20\";\n    String hourlyPath = \"Identity/MemberAccount_2/hourly/2017/04/03/10/\";\n    File jobDir = new File(basePath, minutelyPath);\n    Assert.assertTrue(jobDir.mkdirs());\n\n    createTestingData(jobDir);\n\n    EmbeddedGobblin embeddedGobblin_nondedup = createEmbeddedGobblin(\"basic\", basePath.getAbsolutePath().toString())\n        .setConfiguration(CompactionJobConfigurator.COMPACTION_JOB_CONFIGURATOR_FACTORY_CLASS_KEY,\n            TestCompactionOrcJobConfigurator.Factory.class.getName())\n        .setConfiguration(COMPACTION_OUTPUT_EXTENSION, \"orc\")\n        .setConfiguration(COMPACTION_SHOULD_DEDUPLICATE, \"false\");\n    JobExecutionResult execution = embeddedGobblin_nondedup.run();\n    Assert.assertTrue(execution.isSuccessful());\n\n    \r\n    File outputDir = new File(basePath, hourlyPath);\n    FileSystem fs = FileSystem.getLocal(new Configuration());\n    List<FileStatus> statuses = new ArrayList<>();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), \"orc\");\n      }\n    })) {\n      statuses.add(status);\n    }\n\n    Assert.assertTrue(statuses.size() == 1);\n    List<OrcStruct> result = readOrcFile(statuses.get(0).getPath());\n    Assert.assertEquals(result.size(), 4);\n\n    result.sort(new Comparator<OrcStruct>() {\n      @Override\n      public int compare(OrcStruct o1, OrcStruct o2) {\n        return o1.compareTo(o2);\n      }\n    });\n    Assert.assertEquals(result.get(0).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(0).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(1).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(1).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"i\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"j\"), new IntWritable(3));\n    Assert.assertEquals(result.get(3).getFieldValue(\"i\"), new IntWritable(4));\n    Assert.assertEquals(result.get(3).getFieldValue(\"j\"), new IntWritable(5));\n  }\n","realPath":"gobblin-compaction/src/test/java/org/apache/gobblin/compaction/mapreduce/OrcCompactionTaskTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":150,"status":"NB"}],"commitId":"32f866b08e524148b1c13192a35bc19c3d8b3ee2","commitMessage":"@@@[GOBBLIN-1117] Enable record count verification for ORC format\n\nCloses #2957 from autumnust/orc-recompact-fix\n","date":"2020-04-17 07:05:57","modifiedFileCount":"5","status":"M","submitter":"Lei Sun"},{"authorTime":"2020-09-09 02:26:14","codes":[{"authorDate":"2020-04-17 07:05:57","commitOrder":3,"curCode":"  private void reloadFolder(List<FileStatus> statuses, File outputDir, FileSystem fs) throws IOException {\n    statuses.clear();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), extensionName);\n      }\n    })) {\n      statuses.add(status);\n    }\n  }\n","date":"2020-04-17 07:05:57","endLine":173,"groupId":"101549","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"reloadFolder","params":"(List<FileStatus>statuses@FileoutputDir@FileSystemfs)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/e6/a3fab61a199d8d23a6608cfd408c23e654a2db.src","preCode":"  private void reloadFolder(List<FileStatus> statuses, File outputDir, FileSystem fs) throws IOException {\n    statuses.clear();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), extensionName);\n      }\n    })) {\n      statuses.add(status);\n    }\n  }\n","realPath":"gobblin-compaction/src/test/java/org/apache/gobblin/compaction/mapreduce/OrcCompactionTaskTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":163,"status":"N"},{"authorDate":"2020-09-09 02:26:14","commitOrder":3,"curCode":"  public void testNonDedup() throws Exception {\n    File basePath = Files.createTempDir();\n    basePath.deleteOnExit();\n\n    String minutelyPath = \"Identity/MemberAccount_2/minutely/2017/04/03/10/20_30/run_2017-04-03-10-20\";\n    String hourlyPath = \"Identity/MemberAccount_2/hourly/2017/04/03/10/\";\n    File jobDir = new File(basePath, minutelyPath);\n    Assert.assertTrue(jobDir.mkdirs());\n\n    createTestingData(jobDir);\n\n    EmbeddedGobblin embeddedGobblin_nondedup = createEmbeddedGobblinCompactionJob(\"basic\", basePath.getAbsolutePath().toString())\n        .setConfiguration(CompactionJobConfigurator.COMPACTION_JOB_CONFIGURATOR_FACTORY_CLASS_KEY,\n            TestCompactionOrcJobConfigurator.Factory.class.getName())\n        .setConfiguration(COMPACTION_OUTPUT_EXTENSION, \"orc\")\n        .setConfiguration(COMPACTION_SHOULD_DEDUPLICATE, \"false\");\n    JobExecutionResult execution = embeddedGobblin_nondedup.run();\n    Assert.assertTrue(execution.isSuccessful());\n\n    \r\n    File outputDir = new File(basePath, hourlyPath);\n    FileSystem fs = FileSystem.getLocal(new Configuration());\n    List<FileStatus> statuses = new ArrayList<>();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), \"orc\");\n      }\n    })) {\n      statuses.add(status);\n    }\n\n    Assert.assertTrue(statuses.size() == 1);\n    List<OrcStruct> result = readOrcFile(statuses.get(0).getPath());\n    Assert.assertEquals(result.size(), 4);\n\n    result.sort(new Comparator<OrcStruct>() {\n      @Override\n      public int compare(OrcStruct o1, OrcStruct o2) {\n        return o1.compareTo(o2);\n      }\n    });\n    Assert.assertEquals(result.get(0).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(0).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(1).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(1).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"i\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"j\"), new IntWritable(3));\n    Assert.assertEquals(result.get(3).getFieldValue(\"i\"), new IntWritable(4));\n    Assert.assertEquals(result.get(3).getFieldValue(\"j\"), new IntWritable(5));\n  }\n","date":"2020-09-09 02:26:14","endLine":332,"groupId":"101549","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testNonDedup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/b9/c4152a83b5234e62e5499ef0d05f02430bcaba.src","preCode":"  public void testNonDedup() throws Exception {\n    File basePath = Files.createTempDir();\n    basePath.deleteOnExit();\n\n    String minutelyPath = \"Identity/MemberAccount_2/minutely/2017/04/03/10/20_30/run_2017-04-03-10-20\";\n    String hourlyPath = \"Identity/MemberAccount_2/hourly/2017/04/03/10/\";\n    File jobDir = new File(basePath, minutelyPath);\n    Assert.assertTrue(jobDir.mkdirs());\n\n    createTestingData(jobDir);\n\n    EmbeddedGobblin embeddedGobblin_nondedup = createEmbeddedGobblin(\"basic\", basePath.getAbsolutePath().toString())\n        .setConfiguration(CompactionJobConfigurator.COMPACTION_JOB_CONFIGURATOR_FACTORY_CLASS_KEY,\n            TestCompactionOrcJobConfigurator.Factory.class.getName())\n        .setConfiguration(COMPACTION_OUTPUT_EXTENSION, \"orc\")\n        .setConfiguration(COMPACTION_SHOULD_DEDUPLICATE, \"false\");\n    JobExecutionResult execution = embeddedGobblin_nondedup.run();\n    Assert.assertTrue(execution.isSuccessful());\n\n    \r\n    File outputDir = new File(basePath, hourlyPath);\n    FileSystem fs = FileSystem.getLocal(new Configuration());\n    List<FileStatus> statuses = new ArrayList<>();\n    for (FileStatus status : fs.listStatus(new Path(outputDir.getAbsolutePath()), new PathFilter() {\n      @Override\n      public boolean accept(Path path) {\n        return FilenameUtils.isExtension(path.getName(), \"orc\");\n      }\n    })) {\n      statuses.add(status);\n    }\n\n    Assert.assertTrue(statuses.size() == 1);\n    List<OrcStruct> result = readOrcFile(statuses.get(0).getPath());\n    Assert.assertEquals(result.size(), 4);\n\n    result.sort(new Comparator<OrcStruct>() {\n      @Override\n      public int compare(OrcStruct o1, OrcStruct o2) {\n        return o1.compareTo(o2);\n      }\n    });\n    Assert.assertEquals(result.get(0).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(0).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(1).getFieldValue(\"i\"), new IntWritable(1));\n    Assert.assertEquals(result.get(1).getFieldValue(\"j\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"i\"), new IntWritable(2));\n    Assert.assertEquals(result.get(2).getFieldValue(\"j\"), new IntWritable(3));\n    Assert.assertEquals(result.get(3).getFieldValue(\"i\"), new IntWritable(4));\n    Assert.assertEquals(result.get(3).getFieldValue(\"j\"), new IntWritable(5));\n  }\n","realPath":"gobblin-compaction/src/test/java/org/apache/gobblin/compaction/mapreduce/OrcCompactionTaskTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":282,"status":"M"}],"commitId":"778a8634978981e63d3a096af336b14f79aebeca","commitMessage":"@@@[GOBBLIN-1257] Fix the handling of collection field types during ORC schema up-conversion in compaction[]\n\nCloses #3097 from sv2000/orcCompaction\n","date":"2020-09-09 02:26:14","modifiedFileCount":"4","status":"M","submitter":"sv2000"}]
