[{"authorTime":"2017-07-31 15:51:25","codes":[{"authorDate":"2017-07-31 15:51:25","commitOrder":1,"curCode":"  public void onJobCompletion(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean alertEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.ALERT_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    \r\n    if (jobState.getState() == JobState.RunningState.FAILED) {\n      int failures = jobState.getPropAsInt(ConfigurationKeys.JOB_FAILURES_KEY, 0);\n      int maxFailures =\n          jobState.getPropAsInt(ConfigurationKeys.JOB_MAX_FAILURES_KEY, ConfigurationKeys.DEFAULT_JOB_MAX_FAILURES);\n      if (alertEmailEnabled && failures >= maxFailures) {\n        try {\n          EmailUtils.sendJobFailureAlertEmail(jobState.getJobName(), jobState.toString(), failures, jobState);\n        } catch (EmailException ee) {\n          LOGGER.error(\"Failed to send job failure alert email for job \" + jobState.getJobId(), ee);\n        }\n        return;\n      }\n    }\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCompletionEmail(\n            jobState.getJobId(), jobState.toString(), jobState.getState().toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job completion notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","date":"2017-07-31 15:51:25","endLine":70,"groupId":"699","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"onJobCompletion","params":"(JobContextjobContext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/31/06f4ddf4d94a037708f6bac07adff530bc8f2e.src","preCode":"  public void onJobCompletion(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean alertEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.ALERT_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    \r\n    if (jobState.getState() == JobState.RunningState.FAILED) {\n      int failures = jobState.getPropAsInt(ConfigurationKeys.JOB_FAILURES_KEY, 0);\n      int maxFailures =\n          jobState.getPropAsInt(ConfigurationKeys.JOB_MAX_FAILURES_KEY, ConfigurationKeys.DEFAULT_JOB_MAX_FAILURES);\n      if (alertEmailEnabled && failures >= maxFailures) {\n        try {\n          EmailUtils.sendJobFailureAlertEmail(jobState.getJobName(), jobState.toString(), failures, jobState);\n        } catch (EmailException ee) {\n          LOGGER.error(\"Failed to send job failure alert email for job \" + jobState.getJobId(), ee);\n        }\n        return;\n      }\n    }\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCompletionEmail(\n            jobState.getJobId(), jobState.toString(), jobState.getState().toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job completion notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","realPath":"gobblin-runtime/src/main/java/org/apache/gobblin/runtime/listeners/EmailNotificationJobListener.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":40,"status":"B"},{"authorDate":"2017-07-31 15:51:25","commitOrder":1,"curCode":"  public void onJobCancellation(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCancellationEmail(jobState.getJobId(), jobState.toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job cancellation notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","date":"2017-07-31 15:51:25","endLine":85,"groupId":"699","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"onJobCancellation","params":"(JobContextjobContext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/31/06f4ddf4d94a037708f6bac07adff530bc8f2e.src","preCode":"  public void onJobCancellation(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCancellationEmail(jobState.getJobId(), jobState.toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job cancellation notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","realPath":"gobblin-runtime/src/main/java/org/apache/gobblin/runtime/listeners/EmailNotificationJobListener.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":73,"status":"B"}],"commitId":"5457af88d56b8fb89b172129fd1ff24ecdd4eba8","commitMessage":"@@@Merge pull request #2031 from abti/move_packages_to_apache\n","date":"2017-07-31 15:51:25","modifiedFileCount":"2","status":"B","submitter":"Abhishek Tiwari"},{"authorTime":"2017-07-31 15:51:25","codes":[{"authorDate":"2021-02-12 01:18:32","commitOrder":2,"curCode":"  public void onJobCompletion(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean alertEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.ALERT_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    \r\n    if (jobState.getState() == JobState.RunningState.FAILED) {\n      int failures = jobState.getPropAsInt(ConfigurationKeys.JOB_FAILURES_KEY, 0) + jobContext.getDatasetStateFailures();\n      int maxFailures =\n          jobState.getPropAsInt(ConfigurationKeys.JOB_MAX_FAILURES_KEY, ConfigurationKeys.DEFAULT_JOB_MAX_FAILURES);\n      if (alertEmailEnabled && failures >= maxFailures) {\n        try {\n          EmailUtils.sendJobFailureAlertEmail(jobState.getJobName(), jobState.toString(), failures, jobState);\n        } catch (EmailException ee) {\n          LOGGER.error(\"Failed to send job failure alert email for job \" + jobState.getJobId(), ee);\n        }\n        return;\n      }\n    }\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCompletionEmail(\n            jobState.getJobId(), jobState.toString(), jobState.getState().toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job completion notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","date":"2021-02-12 01:18:32","endLine":72,"groupId":"10827","id":3,"instanceNumber":1,"isCurCommit":1,"methodName":"onJobCompletion","params":"(JobContextjobContext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/02/aa4a2423cb00953bc8d00481d2eaf862e4a141.src","preCode":"  public void onJobCompletion(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean alertEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.ALERT_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    \r\n    if (jobState.getState() == JobState.RunningState.FAILED) {\n      int failures = jobState.getPropAsInt(ConfigurationKeys.JOB_FAILURES_KEY, 0);\n      int maxFailures =\n          jobState.getPropAsInt(ConfigurationKeys.JOB_MAX_FAILURES_KEY, ConfigurationKeys.DEFAULT_JOB_MAX_FAILURES);\n      if (alertEmailEnabled && failures >= maxFailures) {\n        try {\n          EmailUtils.sendJobFailureAlertEmail(jobState.getJobName(), jobState.toString(), failures, jobState);\n        } catch (EmailException ee) {\n          LOGGER.error(\"Failed to send job failure alert email for job \" + jobState.getJobId(), ee);\n        }\n        return;\n      }\n    }\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCompletionEmail(\n            jobState.getJobId(), jobState.toString(), jobState.getState().toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job completion notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","realPath":"gobblin-runtime/src/main/java/org/apache/gobblin/runtime/listeners/EmailNotificationJobListener.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":42,"status":"M"},{"authorDate":"2017-07-31 15:51:25","commitOrder":2,"curCode":"  public void onJobCancellation(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCancellationEmail(jobState.getJobId(), jobState.toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job cancellation notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","date":"2017-07-31 15:51:25","endLine":85,"groupId":"10827","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"onJobCancellation","params":"(JobContextjobContext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/31/06f4ddf4d94a037708f6bac07adff530bc8f2e.src","preCode":"  public void onJobCancellation(JobContext jobContext) {\n    JobState jobState = jobContext.getJobState();\n    boolean notificationEmailEnabled =\n        Boolean.valueOf(jobState.getProp(ConfigurationKeys.NOTIFICATION_EMAIL_ENABLED_KEY, Boolean.toString(false)));\n\n    if (notificationEmailEnabled) {\n      try {\n        EmailUtils.sendJobCancellationEmail(jobState.getJobId(), jobState.toString(), jobState);\n      } catch (EmailException ee) {\n        LOGGER.error(\"Failed to send job cancellation notification email for job \" + jobState.getJobId(), ee);\n      }\n    }\n  }\n","realPath":"gobblin-runtime/src/main/java/org/apache/gobblin/runtime/listeners/EmailNotificationJobListener.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":73,"status":"N"}],"commitId":"5a2fb0d1453ab425c5c379325d680d085372482a","commitMessage":"@@@[GOBBLIN-1387] add function for jobcontext to access datasetstate failures\n\nCloses #3225 from Will-Lo/fix-bug-email-failures\n","date":"2021-02-12 01:18:32","modifiedFileCount":"3","status":"M","submitter":"William Lo"}]
