[{"authorTime":"2017-08-16 03:44:28","codes":[{"authorDate":"2017-08-16 03:44:28","commitOrder":3,"curCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","date":"2017-08-16 03:44:28","endLine":105,"groupId":"7621","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testWriteAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/60/0657289b785a942b257f5d29dcfd0fdc26dcea.src","preCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":77,"status":"MB"},{"authorDate":"2017-08-16 03:44:28","commitOrder":3,"curCode":"  public void testCloseAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    \r\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.close();\n\n    \r\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n  }\n","date":"2017-08-16 03:44:28","endLine":131,"groupId":"3659","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testCloseAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/60/0657289b785a942b257f5d29dcfd0fdc26dcea.src","preCode":"  public void testCloseAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    \r\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.close();\n\n    \r\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":108,"status":"B"}],"commitId":"eca08356b0a460627d0db90bc397858497e6e29d","commitMessage":"@@@[GOBBLIN-206] Remove extra close of CloseOnFlushWriterWrapper\n\n[GOBBLIN-206] Remove extra close of\nCloseOnFlushWriterWrapper\n\nFix test.\n\nCloses #2058 from htran1/close_fix_1\n","date":"2017-08-16 03:44:28","modifiedFileCount":"2","status":"M","submitter":"Hung Tran"},{"authorTime":"2017-09-21 05:25:02","codes":[{"authorDate":"2017-09-21 05:25:02","commitOrder":4,"curCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(CloseOnFlushWriterWrapper.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(FlushControlMessage.builder().build());\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertEquals(dummyWriters.get(0).handlerCalled, 1);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(FlushControlMessage.builder().build());\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertEquals(dummyWriters.get(1).handlerCalled, 1);\n  }\n","date":"2017-09-21 05:25:02","endLine":106,"groupId":"101314","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testWriteAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/ef/435b13a801b51cbd400993be204752fa043fe2.src","preCode":"  public void testWriteAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 1);\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.size(), 2);\n    Assert.assertEquals(dummyWriters.get(1).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(1).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(1).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(1).committed);\n    Assert.assertFalse(dummyWriters.get(1).handlerCalled);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":78,"status":"M"},{"authorDate":"2017-09-21 05:25:02","commitOrder":4,"curCode":"  public void testCloseAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(CloseOnFlushWriterWrapper.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(FlushControlMessage.builder().build());\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    Assert.assertEquals(dummyWriters.get(0).handlerCalled, 1);\n\n    writer.close();\n\n    \r\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n  }\n","date":"2017-09-21 05:25:02","endLine":131,"groupId":"101314","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testCloseAfterFlush","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/ef/435b13a801b51cbd400993be204752fa043fe2.src","preCode":"  public void testCloseAfterFlush()\n      throws IOException {\n    WorkUnitState state = new WorkUnitState();\n    state.getJobState().setProp(ConfigurationKeys.WRITER_CLOSE_ON_FLUSH_KEY, \"true\");\n    List<DummyWriter> dummyWriters = new ArrayList<>();\n    CloseOnFlushWriterWrapper<byte[]> writer = getCloseOnFlushWriter(dummyWriters, state);\n\n    byte[] record = new byte[]{'a', 'b', 'c', 'd'};\n\n    writer.writeEnvelope(new RecordEnvelope(record));\n    writer.getMessageHandler().handleMessage(new FlushControlMessage(new FlushControlMessage.FlushReason(\"flush\")));\n\n    Assert.assertEquals(dummyWriters.get(0).recordsWritten(), 1);\n    Assert.assertEquals(dummyWriters.get(0).flushCount, 1);\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n    Assert.assertTrue(dummyWriters.get(0).committed);\n    \r\n    Assert.assertFalse(dummyWriters.get(0).handlerCalled);\n\n    writer.close();\n\n    \r\n    Assert.assertEquals(dummyWriters.get(0).closeCount, 1);\n  }\n","realPath":"gobblin-core/src/test/java/org/apache/gobblin/writer/CloseOnFlushWriterWrapperTest.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":109,"status":"M"}],"commitId":"99b71523887c7d7f780ac78c20941093bd3751f5","commitMessage":"@@@[GOBBLIN-234] Add a ControlMessageInjector that generates metadata up?\n\nCloses #2107 from htran1/metadata_update\n","date":"2017-09-21 05:25:02","modifiedFileCount":"9","status":"M","submitter":"Hung Tran"}]
