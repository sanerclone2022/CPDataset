[{"authorTime":"2020-07-21 12:42:42","codes":[{"authorDate":"2020-07-21 12:42:42","commitOrder":1,"curCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = getJob(pauseRoutineLoadStmt.getDbFullName(), pauseRoutineLoadStmt.getName());\n        if (routineLoadJob == null) {\n            throw new DdlException(\"There is not operable routine load job with name \" + pauseRoutineLoadStmt.getName());\n        }\n        \r\n        String dbFullName;\n        String tableName;\n        try {\n            dbFullName = routineLoadJob.getDbFullName();\n            tableName = routineLoadJob.getTableName();\n        } catch (MetaNotFoundException e) {\n            throw new DdlException(\"The metadata of job has been changed. The job will be cancelled automatically\", e);\n        }\n        if (!Catalog.getCurrentCatalog().getAuth().checkTblPriv(ConnectContext.get(),\n                                                                dbFullName,\n                                                                tableName,\n                                                                PrivPredicate.LOAD)) {\n            ErrorReport.reportAnalysisException(ErrorCode.ERR_TABLEACCESS_DENIED_ERROR, \"LOAD\",\n                                                ConnectContext.get().getQualifiedUser(),\n                                                ConnectContext.get().getRemoteIP(),\n                                                tableName);\n        }\n\n        routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                                   new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                                   \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                                   false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been paused by user\")\n                         .build());\n    }\n","date":"2020-07-21 12:42:42","endLine":238,"groupId":"8164","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"pauseRoutineLoadJob","params":"(PauseRoutineLoadStmtpauseRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/92/5e31ef576cb6937a72aece7c7c9faf61971c90.src","preCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = getJob(pauseRoutineLoadStmt.getDbFullName(), pauseRoutineLoadStmt.getName());\n        if (routineLoadJob == null) {\n            throw new DdlException(\"There is not operable routine load job with name \" + pauseRoutineLoadStmt.getName());\n        }\n        \r\n        String dbFullName;\n        String tableName;\n        try {\n            dbFullName = routineLoadJob.getDbFullName();\n            tableName = routineLoadJob.getTableName();\n        } catch (MetaNotFoundException e) {\n            throw new DdlException(\"The metadata of job has been changed. The job will be cancelled automatically\", e);\n        }\n        if (!Catalog.getCurrentCatalog().getAuth().checkTblPriv(ConnectContext.get(),\n                                                                dbFullName,\n                                                                tableName,\n                                                                PrivPredicate.LOAD)) {\n            ErrorReport.reportAnalysisException(ErrorCode.ERR_TABLEACCESS_DENIED_ERROR, \"LOAD\",\n                                                ConnectContext.get().getQualifiedUser(),\n                                                ConnectContext.get().getRemoteIP(),\n                                                tableName);\n        }\n\n        routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                                   new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                                   \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                                   false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been paused by user\")\n                         .build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":204,"status":"B"},{"authorDate":"2020-07-21 12:42:42","commitOrder":1,"curCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = getJob(stopRoutineLoadStmt.getDbFullName(), stopRoutineLoadStmt.getName());\n        if (routineLoadJob == null) {\n            throw new DdlException(\"There is not operable routine load job with name \" + stopRoutineLoadStmt.getName());\n        }\n        \r\n        String dbFullName;\n        String tableName;\n        try {\n            dbFullName = routineLoadJob.getDbFullName();\n            tableName = routineLoadJob.getTableName();\n        } catch (MetaNotFoundException e) {\n            throw new DdlException(\"The metadata of job has been changed. The job will be cancelled automatically\", e);\n        }\n        if (!Catalog.getCurrentCatalog().getAuth().checkTblPriv(ConnectContext.get(),\n                                                                dbFullName,\n                                                                tableName,\n                                                                PrivPredicate.LOAD)) {\n            ErrorReport.reportAnalysisException(ErrorCode.ERR_TABLEACCESS_DENIED_ERROR, \"LOAD\",\n                                                ConnectContext.get().getQualifiedUser(),\n                                                ConnectContext.get().getRemoteIP(),\n                                                tableName);\n        }\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                                    new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR, \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                                   false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","date":"2020-07-21 12:42:42","endLine":306,"groupId":"8164","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"stopRoutineLoadJob","params":"(StopRoutineLoadStmtstopRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/92/5e31ef576cb6937a72aece7c7c9faf61971c90.src","preCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = getJob(stopRoutineLoadStmt.getDbFullName(), stopRoutineLoadStmt.getName());\n        if (routineLoadJob == null) {\n            throw new DdlException(\"There is not operable routine load job with name \" + stopRoutineLoadStmt.getName());\n        }\n        \r\n        String dbFullName;\n        String tableName;\n        try {\n            dbFullName = routineLoadJob.getDbFullName();\n            tableName = routineLoadJob.getTableName();\n        } catch (MetaNotFoundException e) {\n            throw new DdlException(\"The metadata of job has been changed. The job will be cancelled automatically\", e);\n        }\n        if (!Catalog.getCurrentCatalog().getAuth().checkTblPriv(ConnectContext.get(),\n                                                                dbFullName,\n                                                                tableName,\n                                                                PrivPredicate.LOAD)) {\n            ErrorReport.reportAnalysisException(ErrorCode.ERR_TABLEACCESS_DENIED_ERROR, \"LOAD\",\n                                                ConnectContext.get().getQualifiedUser(),\n                                                ConnectContext.get().getRemoteIP(),\n                                                tableName);\n        }\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                                    new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR, \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                                   false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":274,"status":"B"}],"commitId":"ad17afef9139a9aeedeb2e92638e95886d515f14","commitMessage":"@@@[CodeRefactor] #4098 Make FE multi module (#4099)\n\nThis PR change the FE code structure to maven multi module structure. \nSee ISSUE: #4098 for more info.  such as How to resolve conflicts.","date":"2020-07-21 12:42:42","modifiedFileCount":"0","status":"B","submitter":"Mingyu Chen"},{"authorTime":"2020-08-06 23:11:02","codes":[{"authorDate":"2020-08-06 23:11:02","commitOrder":2,"curCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(pauseRoutineLoadStmt.getDbFullName(),\n                pauseRoutineLoadStmt.getName());\n\n        routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                        \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId()).add(\"current_state\",\n                routineLoadJob.getState()).add(\"user\", ConnectContext.get().getQualifiedUser()).add(\"msg\",\n                        \"routine load job has been paused by user\").build());\n    }\n","date":"2020-08-06 23:11:02","endLine":247,"groupId":"8164","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"pauseRoutineLoadJob","params":"(PauseRoutineLoadStmtpauseRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/f9/6f7c02b0ae835f03ebbe8fa4e3524aa76d04a1.src","preCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = getJob(pauseRoutineLoadStmt.getDbFullName(), pauseRoutineLoadStmt.getName());\n        if (routineLoadJob == null) {\n            throw new DdlException(\"There is not operable routine load job with name \" + pauseRoutineLoadStmt.getName());\n        }\n        \r\n        String dbFullName;\n        String tableName;\n        try {\n            dbFullName = routineLoadJob.getDbFullName();\n            tableName = routineLoadJob.getTableName();\n        } catch (MetaNotFoundException e) {\n            throw new DdlException(\"The metadata of job has been changed. The job will be cancelled automatically\", e);\n        }\n        if (!Catalog.getCurrentCatalog().getAuth().checkTblPriv(ConnectContext.get(),\n                                                                dbFullName,\n                                                                tableName,\n                                                                PrivPredicate.LOAD)) {\n            ErrorReport.reportAnalysisException(ErrorCode.ERR_TABLEACCESS_DENIED_ERROR, \"LOAD\",\n                                                ConnectContext.get().getQualifiedUser(),\n                                                ConnectContext.get().getRemoteIP(),\n                                                tableName);\n        }\n\n        routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                                   new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                                   \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                                   false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been paused by user\")\n                         .build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":235,"status":"M"},{"authorDate":"2020-08-06 23:11:02","commitOrder":2,"curCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(stopRoutineLoadStmt.getDbFullName(),\n                stopRoutineLoadStmt.getName());\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR,\n                        \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","date":"2020-08-06 23:11:02","endLine":277,"groupId":"8164","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"stopRoutineLoadJob","params":"(StopRoutineLoadStmtstopRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/f9/6f7c02b0ae835f03ebbe8fa4e3524aa76d04a1.src","preCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = getJob(stopRoutineLoadStmt.getDbFullName(), stopRoutineLoadStmt.getName());\n        if (routineLoadJob == null) {\n            throw new DdlException(\"There is not operable routine load job with name \" + stopRoutineLoadStmt.getName());\n        }\n        \r\n        String dbFullName;\n        String tableName;\n        try {\n            dbFullName = routineLoadJob.getDbFullName();\n            tableName = routineLoadJob.getTableName();\n        } catch (MetaNotFoundException e) {\n            throw new DdlException(\"The metadata of job has been changed. The job will be cancelled automatically\", e);\n        }\n        if (!Catalog.getCurrentCatalog().getAuth().checkTblPriv(ConnectContext.get(),\n                                                                dbFullName,\n                                                                tableName,\n                                                                PrivPredicate.LOAD)) {\n            ErrorReport.reportAnalysisException(ErrorCode.ERR_TABLEACCESS_DENIED_ERROR, \"LOAD\",\n                                                ConnectContext.get().getQualifiedUser(),\n                                                ConnectContext.get().getRemoteIP(),\n                                                tableName);\n        }\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                                    new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR, \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                                   false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":264,"status":"M"}],"commitId":"237c0807a4644ab7382abd2afc69e783bfc3c4b2","commitMessage":"@@@[RoutineLoad] Support modify routine load job (#4158)\n\nSupport ALTER ROUTINE LOAD JOB stmt.  for example:\n\n```\nalter routine load db1.label1\nproperties\n(\n\"desired_concurrent_number\"=\"3\". \n\"max_batch_interval\" = \"5\". \n\"max_batch_rows\" = \"300000\". \n\"max_batch_size\" = \"209715200\". \n\"strict_mode\" = \"false\". \n\"timezone\" = \"+08:00\"\n)\n```\n\nDetails can be found in `alter-routine-load.md`","date":"2020-08-06 23:11:02","modifiedFileCount":"11","status":"M","submitter":"Mingyu Chen"},{"authorTime":"2020-08-06 23:11:02","codes":[{"authorDate":"2021-08-11 16:38:06","commitOrder":3,"curCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        List<RoutineLoadJob> jobs = Lists.newArrayList();\n        if (pauseRoutineLoadStmt.isAll()) {\n            jobs = checkPrivAndGetAllJobs(pauseRoutineLoadStmt.getDbFullName());\n        } else {\n            RoutineLoadJob routineLoadJob = checkPrivAndGetJob(pauseRoutineLoadStmt.getDbFullName(),\n                    pauseRoutineLoadStmt.getName());\n            jobs.add(routineLoadJob);\n        }\n\n        for (RoutineLoadJob routineLoadJob : jobs) {\n            try {\n                routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                        new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                                \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                        false );\n                LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId()).add(\"current_state\",\n                        routineLoadJob.getState()).add(\"user\", ConnectContext.get().getQualifiedUser()).add(\"msg\",\n                        \"routine load job has been paused by user\").build());\n            } catch (UserException e) {\n                LOG.warn(\"failed to pause routine load job {}\", routineLoadJob.getName(), e);\n                continue;\n            }\n        }\n    }\n","date":"2021-08-11 16:38:06","endLine":292,"groupId":"6887","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"pauseRoutineLoadJob","params":"(PauseRoutineLoadStmtpauseRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/7b/7e62faa9b803da8a593d1e6b0d4d604df211c9.src","preCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(pauseRoutineLoadStmt.getDbFullName(),\n                pauseRoutineLoadStmt.getName());\n\n        routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                        \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId()).add(\"current_state\",\n                routineLoadJob.getState()).add(\"user\", ConnectContext.get().getQualifiedUser()).add(\"msg\",\n                        \"routine load job has been paused by user\").build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":267,"status":"M"},{"authorDate":"2020-08-06 23:11:02","commitOrder":3,"curCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(stopRoutineLoadStmt.getDbFullName(),\n                stopRoutineLoadStmt.getName());\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR,\n                        \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","date":"2020-08-06 23:11:02","endLine":277,"groupId":"8164","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"stopRoutineLoadJob","params":"(StopRoutineLoadStmtstopRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/f9/6f7c02b0ae835f03ebbe8fa4e3524aa76d04a1.src","preCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(stopRoutineLoadStmt.getDbFullName(),\n                stopRoutineLoadStmt.getName());\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR,\n                        \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":264,"status":"N"}],"commitId":"708b6c529e83e9f0b70bd9d5dd950721cb8a77a2","commitMessage":"@@@[RoutineLoad] Support pause or resume all routine load jobs (#6394)\n\n1. PAUSE ALL ROUTINE LOAD;\n2. RESUME ALL ROUTINE LOAD;","date":"2021-08-11 16:38:06","modifiedFileCount":"4","status":"M","submitter":"Mingyu Chen"},{"authorTime":"2020-08-06 23:11:02","codes":[{"authorDate":"2021-08-12 11:50:57","commitOrder":4,"curCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        List<RoutineLoadJob> jobs = Lists.newArrayList();\n        if (pauseRoutineLoadStmt.isAll()) {\n            jobs = checkPrivAndGetAllJobs(pauseRoutineLoadStmt.getDbFullName());\n        } else {\n            RoutineLoadJob routineLoadJob = checkPrivAndGetJob(pauseRoutineLoadStmt.getDbFullName(),\n                    pauseRoutineLoadStmt.getName());\n            jobs.add(routineLoadJob);\n        }\n\n        for (RoutineLoadJob routineLoadJob : jobs) {\n            try {\n                routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                        new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                                \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                        false );\n                LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId()).add(\"current_state\",\n                        routineLoadJob.getState()).add(\"user\", ConnectContext.get().getQualifiedUser()).add(\"msg\",\n                        \"routine load job has been paused by user\").build());\n            } catch (UserException e) {\n                LOG.warn(\"failed to pause routine load job {}\", routineLoadJob.getName(), e);\n                \r\n                \r\n                if (!pauseRoutineLoadStmt.isAll()) {\n                    throw e;\n                }\n                continue;\n            }\n        }\n    }\n","date":"2021-08-12 11:50:57","endLine":297,"groupId":"101112","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"pauseRoutineLoadJob","params":"(PauseRoutineLoadStmtpauseRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/0f/0a123069310177f4c9a2d1382786dd2a672bef.src","preCode":"    public void pauseRoutineLoadJob(PauseRoutineLoadStmt pauseRoutineLoadStmt)\n            throws UserException {\n        List<RoutineLoadJob> jobs = Lists.newArrayList();\n        if (pauseRoutineLoadStmt.isAll()) {\n            jobs = checkPrivAndGetAllJobs(pauseRoutineLoadStmt.getDbFullName());\n        } else {\n            RoutineLoadJob routineLoadJob = checkPrivAndGetJob(pauseRoutineLoadStmt.getDbFullName(),\n                    pauseRoutineLoadStmt.getName());\n            jobs.add(routineLoadJob);\n        }\n\n        for (RoutineLoadJob routineLoadJob : jobs) {\n            try {\n                routineLoadJob.updateState(RoutineLoadJob.JobState.PAUSED,\n                        new ErrorReason(InternalErrorCode.MANUAL_PAUSE_ERR,\n                                \"User \" + ConnectContext.get().getQualifiedUser() + \" pauses routine load job\"),\n                        false );\n                LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId()).add(\"current_state\",\n                        routineLoadJob.getState()).add(\"user\", ConnectContext.get().getQualifiedUser()).add(\"msg\",\n                        \"routine load job has been paused by user\").build());\n            } catch (UserException e) {\n                LOG.warn(\"failed to pause routine load job {}\", routineLoadJob.getName(), e);\n                continue;\n            }\n        }\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":267,"status":"M"},{"authorDate":"2020-08-06 23:11:02","commitOrder":4,"curCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(stopRoutineLoadStmt.getDbFullName(),\n                stopRoutineLoadStmt.getName());\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR,\n                        \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","date":"2020-08-06 23:11:02","endLine":277,"groupId":"101112","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"stopRoutineLoadJob","params":"(StopRoutineLoadStmtstopRoutineLoadStmt)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/f9/6f7c02b0ae835f03ebbe8fa4e3524aa76d04a1.src","preCode":"    public void stopRoutineLoadJob(StopRoutineLoadStmt stopRoutineLoadStmt)\n            throws UserException {\n        RoutineLoadJob routineLoadJob = checkPrivAndGetJob(stopRoutineLoadStmt.getDbFullName(),\n                stopRoutineLoadStmt.getName());\n        routineLoadJob.updateState(RoutineLoadJob.JobState.STOPPED,\n                new ErrorReason(InternalErrorCode.MANUAL_STOP_ERR,\n                        \"User  \" + ConnectContext.get().getQualifiedUser() + \" stop routine load job\"),\n                false );\n        LOG.info(new LogBuilder(LogKey.ROUTINE_LOAD_JOB, routineLoadJob.getId())\n                         .add(\"current_state\", routineLoadJob.getState())\n                         .add(\"user\", ConnectContext.get().getQualifiedUser())\n                         .add(\"msg\", \"routine load job has been stopped by user\")\n                         .build());\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/load/routineload/RoutineLoadManager.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":264,"status":"N"}],"commitId":"671d8f6af82c7fa32a539b7e85d1c66822be0b68","commitMessage":"@@@[Bug] Return error if user failed to pause/resume a certain routine load. (#6426)\n\nWhen operating a single job.  maintain the same behavior as before\nThis problem is introduced by #6394.","date":"2021-08-12 11:50:57","modifiedFileCount":"1","status":"M","submitter":"Mingyu Chen"}]
