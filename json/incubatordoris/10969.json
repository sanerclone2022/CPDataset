[{"authorTime":"2020-07-21 12:42:42","codes":[{"authorDate":"2020-07-21 12:42:42","commitOrder":1,"curCode":"    private void resolveKeywordFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        \r\n        \r\n        if (\"text\".equals(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    \r\n                    if (\"keyword\".equals(innerTypeObject.optString(\"type\"))) {\n                        searchContext.fetchFieldsContext().put(colName, colName + \".\" + key);\n                    }\n                }\n            }\n        }\n    }\n","date":"2020-07-21 12:42:42","endLine":125,"groupId":"5550","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"resolveKeywordFields","params":"(SearchContextsearchContext@JSONObjectfieldObject@StringcolName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/b6/d16e2c5892d934d0c30ef860b041313096c43f.src","preCode":"    private void resolveKeywordFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        \r\n        \r\n        if (\"text\".equals(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    \r\n                    if (\"keyword\".equals(innerTypeObject.optString(\"type\"))) {\n                        searchContext.fetchFieldsContext().put(colName, colName + \".\" + key);\n                    }\n                }\n            }\n        }\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/external/elasticsearch/MappingPhase.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":109,"status":"B"},{"authorDate":"2020-07-21 12:42:42","commitOrder":1,"curCode":"    private void resolveDocValuesFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        String docValueField = null;\n        if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(innerTypeObject.optString(\"type\"))) {\n                        continue;\n                    }\n                    if (innerTypeObject.has(\"doc_values\")) {\n                        boolean docValue = innerTypeObject.getBoolean(\"doc_values\");\n                        if (docValue) {\n                            docValueField = colName;\n                        }\n                    } else {\n                        \r\n                        docValueField = colName + \".\" + key;\n                    }\n                }\n            }\n        } else {\n            \r\n            if (fieldObject.has(\"doc_values\")) {\n                boolean docValue = fieldObject.optBoolean(\"doc_values\");\n                if (!docValue) {\n                    return;\n                }\n            }\n            docValueField = colName;\n        }\n        searchContext.docValueFieldsContext().put(colName, docValueField);\n    }\n","date":"2020-07-21 12:42:42","endLine":160,"groupId":"6784","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"resolveDocValuesFields","params":"(SearchContextsearchContext@JSONObjectfieldObject@StringcolName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/b6/d16e2c5892d934d0c30ef860b041313096c43f.src","preCode":"    private void resolveDocValuesFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        String docValueField = null;\n        if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(innerTypeObject.optString(\"type\"))) {\n                        continue;\n                    }\n                    if (innerTypeObject.has(\"doc_values\")) {\n                        boolean docValue = innerTypeObject.getBoolean(\"doc_values\");\n                        if (docValue) {\n                            docValueField = colName;\n                        }\n                    } else {\n                        \r\n                        docValueField = colName + \".\" + key;\n                    }\n                }\n            }\n        } else {\n            \r\n            if (fieldObject.has(\"doc_values\")) {\n                boolean docValue = fieldObject.optBoolean(\"doc_values\");\n                if (!docValue) {\n                    return;\n                }\n            }\n            docValueField = colName;\n        }\n        searchContext.docValueFieldsContext().put(colName, docValueField);\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/external/elasticsearch/MappingPhase.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":127,"status":"B"}],"commitId":"ad17afef9139a9aeedeb2e92638e95886d515f14","commitMessage":"@@@[CodeRefactor] #4098 Make FE multi module (#4099)\n\nThis PR change the FE code structure to maven multi module structure. \nSee ISSUE: #4098 for more info.  such as How to resolve conflicts.","date":"2020-07-21 12:42:42","modifiedFileCount":"0","status":"B","submitter":"Mingyu Chen"},{"authorTime":"2020-08-11 12:09:17","codes":[{"authorDate":"2020-07-21 12:42:42","commitOrder":2,"curCode":"    private void resolveKeywordFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        \r\n        \r\n        if (\"text\".equals(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    \r\n                    if (\"keyword\".equals(innerTypeObject.optString(\"type\"))) {\n                        searchContext.fetchFieldsContext().put(colName, colName + \".\" + key);\n                    }\n                }\n            }\n        }\n    }\n","date":"2020-07-21 12:42:42","endLine":125,"groupId":"10969","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"resolveKeywordFields","params":"(SearchContextsearchContext@JSONObjectfieldObject@StringcolName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/b6/d16e2c5892d934d0c30ef860b041313096c43f.src","preCode":"    private void resolveKeywordFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        \r\n        \r\n        if (\"text\".equals(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    \r\n                    if (\"keyword\".equals(innerTypeObject.optString(\"type\"))) {\n                        searchContext.fetchFieldsContext().put(colName, colName + \".\" + key);\n                    }\n                }\n            }\n        }\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/external/elasticsearch/MappingPhase.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":109,"status":"N"},{"authorDate":"2020-08-11 12:09:17","commitOrder":2,"curCode":"    private void resolveDocValuesFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        String docValueField = null;\n        if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(innerTypeObject.optString(\"type\"))) {\n                        continue;\n                    }\n                    if (innerTypeObject.has(\"doc_values\")) {\n                        boolean docValue = innerTypeObject.getBoolean(\"doc_values\");\n                        if (docValue) {\n                            docValueField = colName;\n                        }\n                    } else {\n                        \r\n                        docValueField = colName + \".\" + key;\n                    }\n                }\n            }\n        } else {\n            \r\n            if (fieldObject.has(\"doc_values\")) {\n                boolean docValue = fieldObject.optBoolean(\"doc_values\");\n                if (!docValue) {\n                    return;\n                }\n            }\n            docValueField = colName;\n        }\n        \r\n        if (StringUtils.isNotEmpty(docValueField)) {\n            searchContext.docValueFieldsContext().put(colName, docValueField);\n        }\n    }\n","date":"2020-08-11 12:09:17","endLine":164,"groupId":"10969","id":4,"instanceNumber":2,"isCurCommit":1,"methodName":"resolveDocValuesFields","params":"(SearchContextsearchContext@JSONObjectfieldObject@StringcolName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/4b/82e18f1c4fd8d25a0273746473243bddb49f8c.src","preCode":"    private void resolveDocValuesFields(SearchContext searchContext, JSONObject fieldObject, String colName) {\n        String fieldType = fieldObject.optString(\"type\");\n        String docValueField = null;\n        if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(fieldType)) {\n            JSONObject fieldsObject = fieldObject.optJSONObject(\"fields\");\n            if (fieldsObject != null) {\n                for (String key : fieldsObject.keySet()) {\n                    JSONObject innerTypeObject = fieldsObject.optJSONObject(key);\n                    if (EsTable.DEFAULT_DOCVALUE_DISABLED_FIELDS.contains(innerTypeObject.optString(\"type\"))) {\n                        continue;\n                    }\n                    if (innerTypeObject.has(\"doc_values\")) {\n                        boolean docValue = innerTypeObject.getBoolean(\"doc_values\");\n                        if (docValue) {\n                            docValueField = colName;\n                        }\n                    } else {\n                        \r\n                        docValueField = colName + \".\" + key;\n                    }\n                }\n            }\n        } else {\n            \r\n            if (fieldObject.has(\"doc_values\")) {\n                boolean docValue = fieldObject.optBoolean(\"doc_values\");\n                if (!docValue) {\n                    return;\n                }\n            }\n            docValueField = colName;\n        }\n        searchContext.docValueFieldsContext().put(colName, docValueField);\n    }\n","realPath":"fe/fe-core/src/main/java/org/apache/doris/external/elasticsearch/MappingPhase.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":128,"status":"M"}],"commitId":"48f3ba35ec8044c5df1acb251e0cdffc458ac583","commitMessage":"@@@[Doris On ES][Bug-Fix] Resolve NullPointerException when multi fields with `text` type (#4300)\n\n","date":"2020-08-11 12:09:17","modifiedFileCount":"2","status":"M","submitter":"hexiang55"}]
