[{"authorTime":"2020-10-10 21:16:53","codes":[{"authorDate":"2020-10-10 21:16:53","commitOrder":1,"curCode":"    private static void checkCreateOlapTableLike(String createTableSql, String createTableLikeSql,\n                                                 String newDbName, String existedDbName,\n                                                 String newTblName, String existedTblName) throws Exception {\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        OlapTable newTbl = (OlapTable) newDb.getTable(newTblName);\n        OlapTable existedTbl = (OlapTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl);\n    }\n","date":"2020-10-10 21:16:53","endLine":96,"groupId":"6475","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"checkCreateOlapTableLike","params":"(StringcreateTableSql@StringcreateTableLikeSql@StringnewDbName@StringexistedDbName@StringnewTblName@StringexistedTblName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/b0/9c6b40f94b1e39e2c43ead095367532289d38b.src","preCode":"    private static void checkCreateOlapTableLike(String createTableSql, String createTableLikeSql,\n                                                 String newDbName, String existedDbName,\n                                                 String newTblName, String existedTblName) throws Exception {\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        OlapTable newTbl = (OlapTable) newDb.getTable(newTblName);\n        OlapTable existedTbl = (OlapTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl);\n    }\n","realPath":"fe/fe-core/src/test/java/org/apache/doris/catalog/CreateTableLikeTest.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":86,"status":"B"},{"authorDate":"2020-10-10 21:16:53","commitOrder":1,"curCode":"    private static void checkCreateMysqlTableLike(String createTableSql, String createTableLikeSql,\n                                                  String newDbName, String existedDbName,\n                                                  String newTblName, String existedTblName) throws Exception {\n\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        MysqlTable newTbl = (MysqlTable) newDb.getTable(newTblName);\n        MysqlTable existedTbl = (MysqlTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl);\n    }\n","date":"2020-10-10 21:16:53","endLine":109,"groupId":"6475","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"checkCreateMysqlTableLike","params":"(StringcreateTableSql@StringcreateTableLikeSql@StringnewDbName@StringexistedDbName@StringnewTblName@StringexistedTblName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/b0/9c6b40f94b1e39e2c43ead095367532289d38b.src","preCode":"    private static void checkCreateMysqlTableLike(String createTableSql, String createTableLikeSql,\n                                                  String newDbName, String existedDbName,\n                                                  String newTblName, String existedTblName) throws Exception {\n\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        MysqlTable newTbl = (MysqlTable) newDb.getTable(newTblName);\n        MysqlTable existedTbl = (MysqlTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl);\n    }\n","realPath":"fe/fe-core/src/test/java/org/apache/doris/catalog/CreateTableLikeTest.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":98,"status":"B"}],"commitId":"28f4e922a75c37904f267c075ff82f048cb5a853","commitMessage":"@@@[CREATE TABLE]Support new syntax CREATE TABLE LIKE to clone an existe? (#4705)\n\nSupport new synatx CREATE TABLE [IF NOT EXISTS] [db_name].table_name AS [db_name2].table_name2;\nto create a new table from existed table with same table schema.\nISSUE: #4355","date":"2020-10-10 21:16:53","modifiedFileCount":"7","status":"B","submitter":"WangCong"},{"authorTime":"2021-08-31 20:33:26","codes":[{"authorDate":"2021-08-31 20:33:26","commitOrder":2,"curCode":"    private static void checkCreateOlapTableLike(String createTableSql, String createTableLikeSql,\n                                                 String newDbName, String existedDbName,\n                                                 String newTblName, String existedTblName, int rollupSize) throws Exception {\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        OlapTable newTbl = (OlapTable) newDb.getTable(newTblName);\n        OlapTable existedTbl = (OlapTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl, rollupSize);\n    }\n","date":"2021-08-31 20:33:26","endLine":118,"groupId":"6475","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"checkCreateOlapTableLike","params":"(StringcreateTableSql@StringcreateTableLikeSql@StringnewDbName@StringexistedDbName@StringnewTblName@StringexistedTblName@introllupSize)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/85/8eb763d40b3712f7bba6c93787226486cb5df3.src","preCode":"    private static void checkCreateOlapTableLike(String createTableSql, String createTableLikeSql,\n                                                 String newDbName, String existedDbName,\n                                                 String newTblName, String existedTblName) throws Exception {\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        OlapTable newTbl = (OlapTable) newDb.getTable(newTblName);\n        OlapTable existedTbl = (OlapTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl);\n    }\n","realPath":"fe/fe-core/src/test/java/org/apache/doris/catalog/CreateTableLikeTest.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":108,"status":"M"},{"authorDate":"2021-08-31 20:33:26","commitOrder":2,"curCode":"    private static void checkCreateMysqlTableLike(String createTableSql, String createTableLikeSql,\n                                                  String newDbName, String existedDbName,\n                                                  String newTblName, String existedTblName) throws Exception {\n\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        MysqlTable newTbl = (MysqlTable) newDb.getTable(newTblName);\n        MysqlTable existedTbl = (MysqlTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl, 0);\n    }\n","date":"2021-08-31 20:33:26","endLine":131,"groupId":"6475","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"checkCreateMysqlTableLike","params":"(StringcreateTableSql@StringcreateTableLikeSql@StringnewDbName@StringexistedDbName@StringnewTblName@StringexistedTblName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/85/8eb763d40b3712f7bba6c93787226486cb5df3.src","preCode":"    private static void checkCreateMysqlTableLike(String createTableSql, String createTableLikeSql,\n                                                  String newDbName, String existedDbName,\n                                                  String newTblName, String existedTblName) throws Exception {\n\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        MysqlTable newTbl = (MysqlTable) newDb.getTable(newTblName);\n        MysqlTable existedTbl = (MysqlTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl);\n    }\n","realPath":"fe/fe-core/src/test/java/org/apache/doris/catalog/CreateTableLikeTest.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":120,"status":"M"}],"commitId":"a949dcd9f6e4e2a87be8c61302d080f78b390ee9","commitMessage":"@@@[Feature] Create table like clause support copy rollup (#6475)\n\nfor issue #6474\n\n```sql\ncreate table test.table1 like test.table with rollup r1. r2 -- copy some rollup\n\ncreate table test.table1 like test.table with rollup all -- copy all rollup\n\ncreate table test.table1 like test.table  -- only copy base table\n```","date":"2021-08-31 20:33:26","modifiedFileCount":"3","status":"M","submitter":"shee"},{"authorTime":"2021-09-03 13:34:49","codes":[{"authorDate":"2021-09-03 13:34:49","commitOrder":3,"curCode":"    private static void checkCreateOlapTableLike(String createTableSql, String createTableLikeSql,\n                                                 String newDbName, String existedDbName,\n                                                 String newTblName, String existedTblName, int rollupSize) throws Exception {\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDbOrDdlException(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDbOrDdlException(\"default_cluster:\" + existedDbName);\n        OlapTable newTbl = (OlapTable) newDb.getTableOrDdlException(newTblName);\n        OlapTable existedTbl = (OlapTable) existedDb.getTableOrDdlException(existedTblName);\n        checkTableEqual(newTbl, existedTbl, rollupSize);\n    }\n","date":"2021-09-03 13:34:49","endLine":118,"groupId":"10612","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"checkCreateOlapTableLike","params":"(StringcreateTableSql@StringcreateTableLikeSql@StringnewDbName@StringexistedDbName@StringnewTblName@StringexistedTblName@introllupSize)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/12/7dd65c26ed094e8456b48b380ea855d211b086.src","preCode":"    private static void checkCreateOlapTableLike(String createTableSql, String createTableLikeSql,\n                                                 String newDbName, String existedDbName,\n                                                 String newTblName, String existedTblName, int rollupSize) throws Exception {\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        OlapTable newTbl = (OlapTable) newDb.getTable(newTblName);\n        OlapTable existedTbl = (OlapTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl, rollupSize);\n    }\n","realPath":"fe/fe-core/src/test/java/org/apache/doris/catalog/CreateTableLikeTest.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":108,"status":"M"},{"authorDate":"2021-09-03 13:34:49","commitOrder":3,"curCode":"    private static void checkCreateMysqlTableLike(String createTableSql, String createTableLikeSql,\n                                                  String newDbName, String existedDbName,\n                                                  String newTblName, String existedTblName) throws Exception {\n\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDbOrDdlException(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDbOrDdlException(\"default_cluster:\" + existedDbName);\n        MysqlTable newTbl = (MysqlTable) newDb.getTableOrDdlException(newTblName);\n        MysqlTable existedTbl = (MysqlTable) existedDb.getTableOrDdlException(existedTblName);\n        checkTableEqual(newTbl, existedTbl, 0);\n    }\n","date":"2021-09-03 13:34:49","endLine":131,"groupId":"10612","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"checkCreateMysqlTableLike","params":"(StringcreateTableSql@StringcreateTableLikeSql@StringnewDbName@StringexistedDbName@StringnewTblName@StringexistedTblName)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/12/7dd65c26ed094e8456b48b380ea855d211b086.src","preCode":"    private static void checkCreateMysqlTableLike(String createTableSql, String createTableLikeSql,\n                                                  String newDbName, String existedDbName,\n                                                  String newTblName, String existedTblName) throws Exception {\n\n        createTable(createTableSql);\n        createTableLike(createTableLikeSql);\n        Database newDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + newDbName);\n        Database existedDb = Catalog.getCurrentCatalog().getDb(\"default_cluster:\" + existedDbName);\n        MysqlTable newTbl = (MysqlTable) newDb.getTable(newTblName);\n        MysqlTable existedTbl = (MysqlTable) existedDb.getTable(existedTblName);\n        checkTableEqual(newTbl, existedTbl, 0);\n    }\n","realPath":"fe/fe-core/src/test/java/org/apache/doris/catalog/CreateTableLikeTest.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":120,"status":"M"}],"commitId":"df54b34f9843adf80d5fa753383797690e9458dd","commitMessage":"@@@[Catalog] Enforce null check at Catalog.getDb and Database.getTable (#6416)\n\nfix #5378 #5391 #5688 #5973 #6155 and all replay NPE. All replay method can now throw MetaNotFoundException and caught to log a warning for potential inconsistent metadata cases.\n\ntry to establish a clear notice for future developer to check null.","date":"2021-09-03 13:34:49","modifiedFileCount":"190","status":"M","submitter":"ccoffline"}]
