[{"authorTime":"2020-07-29 16:18:05","codes":[{"authorDate":"2020-07-29 16:18:05","commitOrder":1,"curCode":"    BitmapValue init(Object value) {\n        try {\n            BitmapValue bitmapValue = new BitmapValue();\n            if (value instanceof byte[]) {\n                bitmapValue.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else {\n                bitmapValue.add(value == null ? 0l : Long.valueOf(value.toString()));\n            }\n            return bitmapValue;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build bitmap value failed\", e);\n        }\n    }\n","date":"2020-07-29 16:18:05","endLine":236,"groupId":"3778","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"init","params":"(Objectvalue)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/bd/6f0db71cadf5c98b6580d9bf5353e62e16a304.src","preCode":"    BitmapValue init(Object value) {\n        try {\n            BitmapValue bitmapValue = new BitmapValue();\n            if (value instanceof byte[]) {\n                bitmapValue.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else {\n                bitmapValue.add(value == null ? 0l : Long.valueOf(value.toString()));\n            }\n            return bitmapValue;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build bitmap value failed\", e);\n        }\n    }\n","realPath":"fe/spark-dpp/src/main/java/org/apache/doris/load/loadv2/dpp/SparkRDDAggregator.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":224,"status":"B"},{"authorDate":"2020-07-29 16:18:05","commitOrder":1,"curCode":"    Hll init(Object value) {\n        try {\n            Hll hll = new Hll();\n            if (value instanceof byte[]) {\n                hll.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else {\n                hll.updateWithHash(value == null ? 0 : value);\n            }\n            return hll;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build hll value failed\", e);\n        }\n    }\n","date":"2020-07-29 16:18:05","endLine":280,"groupId":"3779","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"init","params":"(Objectvalue)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/bd/6f0db71cadf5c98b6580d9bf5353e62e16a304.src","preCode":"    Hll init(Object value) {\n        try {\n            Hll hll = new Hll();\n            if (value instanceof byte[]) {\n                hll.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else {\n                hll.updateWithHash(value == null ? 0 : value);\n            }\n            return hll;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build hll value failed\", e);\n        }\n    }\n","realPath":"fe/spark-dpp/src/main/java/org/apache/doris/load/loadv2/dpp/SparkRDDAggregator.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":268,"status":"B"}],"commitId":"0e79f6908b975bcbe16d95291e05a7f123b9e423","commitMessage":"@@@[CodeRefactor] Modify FE modules (#4146)\n\nThis CL mainly changes:\n\n1. Add 2 new FE modules\n\n    1. fe-common\n\n        save all common classes for other modules.  currently only `jmockit`\n        \n    2. spark-dpp\n\n        The Spark DPP application for Spark Load. And I removed all dpp related classes to this module.  including unit tests.\n        \n2. Change the `build.sh`\n\n    Add a new param `--spark-dpp` to compile the `spark-dpp` alone. And `--fe` will compile all FE modules.\n    \n    the output of `spark-dpp` module is `spark-dpp-1.0.0-jar-with-dependencies.jar`.  and it will be installed to `output/fe/spark-dpp/`.\n\n3. Modify some bugs of spark load","date":"2020-07-29 16:18:05","modifiedFileCount":"3","status":"B","submitter":"Mingyu Chen"},{"authorTime":"2021-05-07 11:18:23","codes":[{"authorDate":"2021-05-07 11:18:23","commitOrder":2,"curCode":"    BitmapValue init(Object value) {\n        try {\n            BitmapValue bitmapValue = new BitmapValue();\n            if (value instanceof byte[]) {\n                bitmapValue.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else if (value != null){\n                bitmapValue.add(Long.valueOf(value.toString()));\n            }\n            return bitmapValue;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build bitmap value failed\", e);\n        }\n    }\n","date":"2021-05-07 11:18:23","endLine":243,"groupId":"111614","id":3,"instanceNumber":1,"isCurCommit":1,"methodName":"init","params":"(Objectvalue)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/2d/90a9da73a19747e84df8a2370d343094753413.src","preCode":"    BitmapValue init(Object value) {\n        try {\n            BitmapValue bitmapValue = new BitmapValue();\n            if (value instanceof byte[]) {\n                bitmapValue.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else {\n                bitmapValue.add(value == null ? 0l : Long.valueOf(value.toString()));\n            }\n            return bitmapValue;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build bitmap value failed\", e);\n        }\n    }\n","realPath":"fe/spark-dpp/src/main/java/org/apache/doris/load/loadv2/dpp/SparkRDDAggregator.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":231,"status":"M"},{"authorDate":"2021-05-07 11:18:23","commitOrder":2,"curCode":"    Hll init(Object value) {\n        try {\n            Hll hll = new Hll();\n            if (value instanceof byte[]) {\n                hll.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else if (value != null){\n                hll.updateWithHash(value);\n            }\n            return hll;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build hll value failed\", e);\n        }\n    }\n","date":"2021-05-07 11:18:23","endLine":287,"groupId":"111614","id":4,"instanceNumber":2,"isCurCommit":1,"methodName":"init","params":"(Objectvalue)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-incubatordoris-10-0.7/blobInfo/CC_OUT/blobs/2d/90a9da73a19747e84df8a2370d343094753413.src","preCode":"    Hll init(Object value) {\n        try {\n            Hll hll = new Hll();\n            if (value instanceof byte[]) {\n                hll.deserialize(new DataInputStream(new ByteArrayInputStream((byte[]) value)));\n            } else {\n                hll.updateWithHash(value == null ? 0 : value);\n            }\n            return hll;\n        } catch (Exception e) {\n            throw new RuntimeException(\"build hll value failed\", e);\n        }\n    }\n","realPath":"fe/spark-dpp/src/main/java/org/apache/doris/load/loadv2/dpp/SparkRDDAggregator.java","repoName":"incubatordoris","snippetEndLine":0,"snippetStartLine":0,"startLine":275,"status":"M"}],"commitId":"9f706848b94060d3abe9373f5fe9bf9b92145954","commitMessage":"@@@[Bug] Fix somg bugs about Spark Load (#5701)\n\nThe distinct count result of bitmap/hll column may be incorrect in the spark load mode.\n\nFix some bugs in spark load to solve the above problem.\n1. FE is big end but BE is little end. BitmapValues should be transfered to little end in FE's serialization\n2. BitmapUnionAggregator/HllUnionAggregator ignore `null` value\n3. Make sure encodeVarint64 in FE is consistent with BE\n\nCo-authored-by: weixiang <weixiang06@meituan.com>","date":"2021-05-07 11:18:23","modifiedFileCount":"3","status":"M","submitter":"Xiang Wei"}]
