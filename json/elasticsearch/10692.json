[{"authorTime":"2019-12-21 01:01:05","codes":[{"authorDate":"2019-12-21 01:01:05","commitOrder":1,"curCode":"    public void testNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings),\n                    settings, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"nGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class, () -> tokenFilterFactory.create(tokenizer));\n            assertEquals(\"The [nGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\").put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n                .build();\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"nGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n            assertNotNull(tokenFilterFactory.create(tokenizer));\n            assertWarnings(\"The [nGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [ngram] instead.\");\n        }\n    }\n","date":"2019-12-21 01:01:05","endLine":81,"groupId":"53074","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testNGramFilterInCustomAnalyzerDeprecationError","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/90/190e42f2f8553bc023a4754d6e5f18bcc1c64b.src","preCode":"    public void testNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings),\n                    settings, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"nGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class, () -> tokenFilterFactory.create(tokenizer));\n            assertEquals(\"The [nGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\").put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n                .build();\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"nGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n            assertNotNull(tokenFilterFactory.create(tokenizer));\n            assertWarnings(\"The [nGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [ngram] instead.\");\n        }\n    }\n","realPath":"modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/CommonAnalysisPluginTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":43,"status":"B"},{"authorDate":"2019-12-21 01:01:05","commitOrder":1,"curCode":"    public void testEdgeNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings),\n                    settings, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"edgeNGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class, () -> tokenFilterFactory.create(tokenizer));\n            assertEquals(\"The [edgeNGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED,\n                    VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n                .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n                .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"edgeNGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n            assertNotNull(tokenFilterFactory.create(tokenizer));\n            assertWarnings(\"The [edgeNGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\");\n        }\n    }\n","date":"2019-12-21 01:01:05","endLine":128,"groupId":"53074","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testEdgeNGramFilterInCustomAnalyzerDeprecationError","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/90/190e42f2f8553bc023a4754d6e5f18bcc1c64b.src","preCode":"    public void testEdgeNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings),\n                    settings, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"edgeNGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class, () -> tokenFilterFactory.create(tokenizer));\n            assertEquals(\"The [edgeNGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED,\n                    VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n                .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n                .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"edgeNGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n            assertNotNull(tokenFilterFactory.create(tokenizer));\n            assertWarnings(\"The [edgeNGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\");\n        }\n    }\n","realPath":"modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/CommonAnalysisPluginTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":87,"status":"B"}],"commitId":"c6f7166145412a3a1a9c639cc07a2329e879a575","commitMessage":"@@@Throw Error on deprecated nGram and edgeNGram custom filters (#50376)\n\nThe camel-case `nGram` and `edgeNGram` filter names were deprecated in 6. We\ncurrently throw errors on new indices when they are used. However these errors\nare currently only thrown for pre-configured filters.  adding them as custom\nfilters doesn't trigger the warning and error. This change adds the appropriate\nexceptions for `nGram` and `edgeNGram` respectively.\n\nCloses #50360","date":"2019-12-21 01:01:05","modifiedFileCount":"1","status":"B","submitter":"Christoph B?scher"},{"authorTime":"2020-01-14 21:12:25","codes":[{"authorDate":"2020-01-14 21:12:25","commitOrder":2,"curCode":"    public void testNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class,\n                () -> createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings), settings, commonAnalysisPlugin));\n            assertEquals(\"The [nGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\").put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n                .build();\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7), settingsPre7, commonAnalysisPlugin);\n            assertWarnings(\"The [nGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [ngram] instead.\");\n        }\n    }\n","date":"2020-01-14 21:12:25","endLine":66,"groupId":"53074","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testNGramFilterInCustomAnalyzerDeprecationError","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/60/7450b9322d688bed748c85474f0348de6d0687.src","preCode":"    public void testNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings),\n                    settings, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"nGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class, () -> tokenFilterFactory.create(tokenizer));\n            assertEquals(\"The [nGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\").put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n                .build();\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"nGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n            assertNotNull(tokenFilterFactory.create(tokenizer));\n            assertWarnings(\"The [nGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [ngram] instead.\");\n        }\n    }\n","realPath":"modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/CommonAnalysisPluginTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":38,"status":"M"},{"authorDate":"2020-01-14 21:12:25","commitOrder":2,"curCode":"    public void testEdgeNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class,\n                () -> createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings), settings, commonAnalysisPlugin));\n            assertEquals(\"The [edgeNGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED,\n                    VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n                .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n                .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n           createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin);\n            assertWarnings(\"The [edgeNGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\");\n        }\n    }\n","date":"2020-01-14 21:12:25","endLine":104,"groupId":"53074","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testEdgeNGramFilterInCustomAnalyzerDeprecationError","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/60/7450b9322d688bed748c85474f0348de6d0687.src","preCode":"    public void testEdgeNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings),\n                    settings, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"edgeNGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class, () -> tokenFilterFactory.create(tokenizer));\n            assertEquals(\"The [edgeNGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED,\n                    VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n                .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n                .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            Map<String, TokenFilterFactory> tokenFilters = createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin).tokenFilter;\n            TokenFilterFactory tokenFilterFactory = tokenFilters.get(\"edgeNGram\");\n            Tokenizer tokenizer = new MockTokenizer();\n            tokenizer.setReader(new StringReader(\"foo bar\"));\n            assertNotNull(tokenFilterFactory.create(tokenizer));\n            assertWarnings(\"The [edgeNGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\");\n        }\n    }\n","realPath":"modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/CommonAnalysisPluginTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":72,"status":"M"}],"commitId":"736ed474e2602fd1fc0f48d2dfdf15db2bbe1793","commitMessage":"@@@Check for deprecations when analyzers are built (#50908)\n\nGenerally speaking.  deprecated analysis components in elasticsearch will issue deprecation\nwarnings when they are first used. However.  this means that no warnings are emitted when\nindexes are created with deprecated components.  and users have to actually index a document\nto see warnings. This makes it much harder to see these warnings and act on them at\nappropriate times.\n\nThis is worse in the case where components throw exceptions on upgrade. In this case.  users\nwill not be aware of a problem until a document is indexed.  instead of at index creation time.\n\nThis commit adds a new check that pushes an empty string through all user-defined analyzers\nand normalizers when an IndexAnalyzers object is built for each index; deprecation warnings\nand exceptions are now emitted when indexes are created or opened.\n\nFixes #42349","date":"2020-01-14 21:12:25","modifiedFileCount":"6","status":"M","submitter":"Alan Woodward"},{"authorTime":"2020-04-01 03:52:01","codes":[{"authorDate":"2020-04-01 03:52:01","commitOrder":3,"curCode":"    public void testNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetadata.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class,\n                () -> createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings), settings, commonAnalysisPlugin));\n            assertEquals(\"The [nGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetadata.SETTING_VERSION_CREATED, VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\").put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n                .build();\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7), settingsPre7, commonAnalysisPlugin);\n            assertWarnings(\"The [nGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [ngram] instead.\");\n        }\n    }\n","date":"2020-04-01 03:52:01","endLine":69,"groupId":"10692","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testNGramFilterInCustomAnalyzerDeprecationError","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/f7/4d16846a017c70d5474616e97302b13141d21d.src","preCode":"    public void testNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class,\n                () -> createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings), settings, commonAnalysisPlugin));\n            assertEquals(\"The [nGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\").put(\"index.analysis.filter.my_ngram.type\", \"nGram\")\n                .build();\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7), settingsPre7, commonAnalysisPlugin);\n            assertWarnings(\"The [nGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [ngram] instead.\");\n        }\n    }\n","realPath":"modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/CommonAnalysisPluginTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":41,"status":"M"},{"authorDate":"2020-04-01 03:52:01","commitOrder":3,"curCode":"    public void testEdgeNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetadata.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class,\n                () -> createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings), settings, commonAnalysisPlugin));\n            assertEquals(\"The [edgeNGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetadata.SETTING_VERSION_CREATED,\n                    VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n                .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n                .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n           createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin);\n            assertWarnings(\"The [edgeNGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\");\n        }\n    }\n","date":"2020-04-01 03:52:01","endLine":107,"groupId":"10692","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testEdgeNGramFilterInCustomAnalyzerDeprecationError","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/f7/4d16846a017c70d5474616e97302b13141d21d.src","preCode":"    public void testEdgeNGramFilterInCustomAnalyzerDeprecationError() throws IOException {\n        final Settings settings = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n            .put(IndexMetaData.SETTING_VERSION_CREATED,\n                VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, Version.CURRENT))\n            .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n            .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n            .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n            .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n            .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n            IllegalArgumentException ex = expectThrows(IllegalArgumentException.class,\n                () -> createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settings), settings, commonAnalysisPlugin));\n            assertEquals(\"The [edgeNGram] token filter name was deprecated in 6.4 and cannot be used in new indices. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\", ex.getMessage());\n        }\n\n        final Settings settingsPre7 = Settings.builder().put(Environment.PATH_HOME_SETTING.getKey(), createTempDir())\n                .put(IndexMetaData.SETTING_VERSION_CREATED,\n                    VersionUtils.randomVersionBetween(random(), Version.V_7_0_0, Version.V_7_6_0))\n                .put(\"index.analysis.analyzer.custom_analyzer.type\", \"custom\")\n                .put(\"index.analysis.analyzer.custom_analyzer.tokenizer\", \"standard\")\n                .putList(\"index.analysis.analyzer.custom_analyzer.filter\", \"my_ngram\")\n                .put(\"index.analysis.filter.my_ngram.type\", \"edgeNGram\")\n                .build();\n\n        try (CommonAnalysisPlugin commonAnalysisPlugin = new CommonAnalysisPlugin()) {\n           createTestAnalysis(IndexSettingsModule.newIndexSettings(\"index\", settingsPre7),\n                    settingsPre7, commonAnalysisPlugin);\n            assertWarnings(\"The [edgeNGram] token filter name is deprecated and will be removed in a future version. \"\n                    + \"Please change the filter name to [edge_ngram] instead.\");\n        }\n    }\n","realPath":"modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/CommonAnalysisPluginTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":75,"status":"M"}],"commitId":"95a7eed9aa35f47b228e402508709b5bd6703cf4","commitMessage":"@@@Rename MetaData to Metadata in all of the places (#54519)\n\nThis is a simple naming change PR.  to fix the fact that \"metadata\" is a\nsingle English word.  and for too long we have not followed general\nnaming conventions for it. We are also not consistent about it.  for\nexample.  METADATA instead of META_DATA if we were trying to be\nconsistent with MetaData (although METADATA is correct when considered\nin the context of \"metadata\"). This was a simple find and replace across\nthe code base.  only taking a few minutes to fix this naming issue\nforever.","date":"2020-04-01 03:52:01","modifiedFileCount":"1712","status":"M","submitter":"Jason Tedor"}]
