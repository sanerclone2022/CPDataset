[{"authorTime":"2018-04-26 03:22:53","codes":[{"authorDate":"2018-04-26 03:22:53","commitOrder":1,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings indexSettings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module = new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", indexSettings), emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-04-26 03:22:53","endLine":356,"groupId":"10026","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/00/8b05f6a1e958db82a077cf4a3a1999e957b64d.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings indexSettings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module = new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", indexSettings), emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":348,"status":"B"},{"authorDate":"2018-04-26 03:22:53","commitOrder":1,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings indexSettings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module = new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", indexSettings), emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-04-26 03:22:53","endLine":368,"groupId":"10023","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/00/8b05f6a1e958db82a077cf4a3a1999e957b64d.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings indexSettings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module = new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", indexSettings), emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":358,"status":"B"}],"commitId":"d74fb9eb4559077e2d20b19a9ed62d9ff825027a","commitMessage":"@@@Opened x-pack ILM code\n","date":"2018-04-26 03:22:53","modifiedFileCount":"0","status":"B","submitter":"Tal Levy"},{"authorTime":"2018-06-11 16:47:26","codes":[{"authorDate":"2018-06-11 16:47:26","commitOrder":2,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module =\n                new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", settings), emptyAnalysisRegistry, new InternalEngineFactory());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-06-11 16:47:26","endLine":365,"groupId":"0","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/1d/531bdeb902f73404f7c1c753ba25c8b6869ca5.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings indexSettings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module = new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", indexSettings), emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":356,"status":"M"},{"authorDate":"2018-06-11 16:47:26","commitOrder":2,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module =\n                new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", settings), emptyAnalysisRegistry, new InternalEngineFactory());\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-06-11 16:47:26","endLine":378,"groupId":"0","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/1d/531bdeb902f73404f7c1c753ba25c8b6869ca5.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings indexSettings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module = new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", indexSettings), emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":367,"status":"M"}],"commitId":"9ee492a3f0768a3790671bfe46223e700082730a","commitMessage":"@@@Merge branch 'master' into index-lifecycle\n","date":"2018-06-11 16:47:26","modifiedFileCount":"192","status":"M","submitter":"Colin Goodheart-Smithe"},{"authorTime":"2018-07-27 17:51:09","codes":[{"authorDate":"2018-07-27 17:51:09","commitOrder":3,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-07-27 17:51:09","endLine":364,"groupId":"2362","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/a8/2b932e2b570eb6f0e5fcf6332c33b06e6da71c.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module =\n                new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", settings), emptyAnalysisRegistry, new InternalEngineFactory());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":355,"status":"M"},{"authorDate":"2018-07-27 17:51:09","commitOrder":3,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-07-27 17:51:09","endLine":377,"groupId":"2362","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/a8/2b932e2b570eb6f0e5fcf6332c33b06e6da71c.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        IndexModule module =\n                new IndexModule(IndexSettingsModule.newIndexSettings(\"foo\", settings), emptyAnalysisRegistry, new InternalEngineFactory());\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":366,"status":"M"}],"commitId":"dfb277cfb7969ad543a31dea234579d0e886a73a","commitMessage":"@@@Merge branch 'master' into index-lifecycle\n","date":"2018-07-27 17:51:09","modifiedFileCount":"105","status":"M","submitter":"Colin Goodheart-Smithe"},{"authorTime":"2019-10-21 15:43:31","codes":[{"authorDate":"2018-07-27 17:51:09","commitOrder":4,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2018-07-27 17:51:09","endLine":364,"groupId":"2362","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/a8/2b932e2b570eb6f0e5fcf6332c33b06e6da71c.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":355,"status":"N"},{"authorDate":"2019-10-21 15:43:31","commitOrder":4,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2019-10-21 15:43:31","endLine":403,"groupId":"2362","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/63/10bf0457be45b72324961329be843b1900ddd9.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":392,"status":"M"}],"commitId":"f9a9dcb75288899f58bf833f13f561883aab45ef","commitMessage":"@@@Close query cache on index service creation failure (#48230)\n\nToday it is possible that we create the `QueryCache` and then fail to create\nthe owning `IndexService` and this means we do not close the `QueryCache`\nagain. This commit addresses that leak.\n\nFixes #48186","date":"2019-10-21 15:43:31","modifiedFileCount":"3","status":"M","submitter":"David Turner"},{"authorTime":"2020-02-13 01:06:04","codes":[{"authorDate":"2020-02-13 01:06:04","commitOrder":5,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2020-02-13 01:06:04","endLine":395,"groupId":"58373","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/78/07f58c7fd6eda41019fbca7a498868a0e2d09c.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":386,"status":"M"},{"authorDate":"2020-02-13 01:06:04","commitOrder":5,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2020-02-13 01:06:04","endLine":408,"groupId":"2362","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/78/07f58c7fd6eda41019fbca7a498868a0e2d09c.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = new IndexModule(indexSettings, emptyAnalysisRegistry, new InternalEngineFactory(), Collections.emptyMap());\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":397,"status":"M"}],"commitId":"a8b39ed842c7770bd9275958c9f747502fd9a3ea","commitMessage":"@@@Add a cluster setting to disallow expensive queries (#51385)\n\nAdd a new cluster setting `search.allow_expensive_queries` which by\ndefault is `true`. If set to `false`.  certain queries that have \nusually slow performance cannot be executed and an error message\nis returned.\n\n- Queries that need to do linear scans to identify matches:\n  - Script queries\n- Queries that have a high up-front cost:\n  - Fuzzy queries\n  - Regexp queries\n  - Prefix queries (without index_prefixes enabled\n  - Wildcard queries\n  - Range queries on text and keyword fields\n- Joining queries\n  - HasParent queries\n  - HasChild queries\n  - ParentId queries\n  - Nested queries\n- Queries on deprecated 6.x geo shapes (using PrefixTree implementation)\n- Queries that may have a high per-document cost:\n  - Script score queries\n  - Percolate queries\n\nCloses: #29050","date":"2020-02-13 01:06:04","modifiedFileCount":"66","status":"M","submitter":"Marios Trivyzas"},{"authorTime":"2020-04-01 03:52:01","codes":[{"authorDate":"2020-04-01 03:52:01","commitOrder":6,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetadata.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2020-04-01 03:52:01","endLine":396,"groupId":"58373","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/58/d3802cdec6aa2154251a1becf6f36cc76eb180.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":387,"status":"M"},{"authorDate":"2020-04-01 03:52:01","commitOrder":6,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetadata.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2020-04-01 03:52:01","endLine":409,"groupId":"2362","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/58/d3802cdec6aa2154251a1becf6f36cc76eb180.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetaData.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":398,"status":"M"}],"commitId":"95a7eed9aa35f47b228e402508709b5bd6703cf4","commitMessage":"@@@Rename MetaData to Metadata in all of the places (#54519)\n\nThis is a simple naming change PR.  to fix the fact that \"metadata\" is a\nsingle English word.  and for too long we have not followed general\nnaming conventions for it. We are also not consistent about it.  for\nexample.  METADATA instead of META_DATA if we were trying to be\nconsistent with MetaData (although METADATA is correct when considered\nin the context of \"metadata\"). This was a simple find and replace across\nthe code base.  only taking a few minutes to fix this naming issue\nforever.","date":"2020-04-01 03:52:01","modifiedFileCount":"1712","status":"M","submitter":"Jason Tedor"},{"authorTime":"2021-03-02 01:38:53","codes":[{"authorDate":"2021-03-02 01:38:53","commitOrder":7,"curCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetadata.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry, indexNameExpressionResolver);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2021-03-02 01:38:53","endLine":410,"groupId":"102518","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"testDefaultQueryCacheImplIsSelected","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/d6/76dfc86552592c6680d662434b5065868c0709.src","preCode":"    public void testDefaultQueryCacheImplIsSelected() throws IOException {\n        Settings settings = Settings.builder()\n                .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n                .put(IndexMetadata.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof IndexQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":401,"status":"M"},{"authorDate":"2021-03-02 01:38:53","commitOrder":7,"curCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetadata.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry, indexNameExpressionResolver);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","date":"2021-03-02 01:38:53","endLine":423,"groupId":"102518","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"testDisableQueryCacheHasPrecedenceOverForceQueryCache","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/d6/76dfc86552592c6680d662434b5065868c0709.src","preCode":"    public void testDisableQueryCacheHasPrecedenceOverForceQueryCache() throws IOException {\n        Settings settings = Settings.builder()\n            .put(IndexModule.INDEX_QUERY_CACHE_ENABLED_SETTING.getKey(), false)\n            .put(Environment.PATH_HOME_SETTING.getKey(), createTempDir().toString())\n            .put(IndexMetadata.SETTING_VERSION_CREATED, Version.CURRENT).build();\n        final IndexSettings indexSettings = IndexSettingsModule.newIndexSettings(\"foo\", settings);\n        IndexModule module = createIndexModule(indexSettings, emptyAnalysisRegistry);\n        module.forceQueryCacheProvider((a, b) -> new CustomQueryCache(null));\n        IndexService indexService = newIndexService(module);\n        assertTrue(indexService.cache().query() instanceof DisabledQueryCache);\n        indexService.close(\"simon says\", false);\n    }\n","realPath":"server/src/test/java/org/elasticsearch/index/IndexModuleTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":412,"status":"M"}],"commitId":"1487a5a991e78dc17eebb349b105409b51b63b36","commitMessage":"@@@Introduce system index types including external (#68919)\n\nThis commit introduces system index types that will be used to\ndifferentiate behavior. Previously system indices were all treated the\nsame regardless of whether they belonged to Elasticsearch.  a stack\ncomponent.  or one of our solutions. Upon further discussion and\nanalysis this decision was not in the best interest of the various\nteams and instead a new type of system index was needed. These system\nindices will be referred to as external system indices. Within external\nsystem indices.  an option exists for these indices to be managed by\nElasticsearch or to be managed by the external product.\n\nIn order to represent this within Elasticsearch.  each system index will\nhave a type and this type will be used to control behavior.\n\nCloses #67383","date":"2021-03-02 01:38:53","modifiedFileCount":"87","status":"M","submitter":"Jay Modi"}]
