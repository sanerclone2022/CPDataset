[{"authorTime":"2018-09-03 17:01:16","codes":[{"authorDate":"2018-08-24 01:52:59","commitOrder":3,"curCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2018-08-24 01:52:59","endLine":380,"groupId":"33199","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/b5/ba5f18b395c43cb12cb6e28441b54f8207c1ab.src","preCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":364,"status":"NB"},{"authorDate":"2018-09-03 17:01:16","commitOrder":3,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        followingEngine.recoverFromTranslog(Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2018-09-03 17:01:16","endLine":285,"groupId":"4077","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/67/7b8955490da5625092c3203727de59652c258b.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        followingEngine.recoverFromTranslog(Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":277,"status":"B"}],"commitId":"e2c1beb1be5b47d124903883bc31be8a648c8c03","commitMessage":"@@@Merge branch 'master' into index-lifecycle\n","date":"2018-09-03 17:01:16","modifiedFileCount":"71","status":"M","submitter":"Colin Goodheart-Smithe"},{"authorTime":"2018-09-07 17:59:10","codes":[{"authorDate":"2018-09-07 17:59:10","commitOrder":4,"curCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2018-09-07 17:59:10","endLine":489,"groupId":"33199","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/0e/22d0a7eda2af5f34281ff8a912f3531305e075.src","preCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":473,"status":"M"},{"authorDate":"2018-09-07 17:59:10","commitOrder":4,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2018-09-07 17:59:10","endLine":283,"groupId":"4077","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/68/97e3bf3f73e2c2b534aef36428c807ff56cc0e.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        followingEngine.recoverFromTranslog(Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":274,"status":"M"}],"commitId":"017ffe5d127ce0fb33feb8fc4e5fededb8cbfda1","commitMessage":"@@@Merge branch 'master' into index-lifecycle\n","date":"2018-09-07 17:59:10","modifiedFileCount":"370","status":"M","submitter":"Colin Goodheart-Smithe"},{"authorTime":"2018-09-25 00:33:51","codes":[{"authorDate":"2018-09-25 00:33:51","commitOrder":5,"curCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2018-09-25 00:33:51","endLine":483,"groupId":"33199","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/69/a9f51ab698eb143428a84463b6800797c7f923.src","preCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":466,"status":"M"},{"authorDate":"2018-09-25 00:33:51","commitOrder":5,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2018-09-25 00:33:51","endLine":277,"groupId":"4077","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/c9/a4de8f03cd409836cc2bac1cfa4a70451245b9.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":267,"status":"M"}],"commitId":"243e863f6e862074b564f909e90a8fd83ae8ad01","commitMessage":"@@@Merge remote-tracking branch 'origin/master' into index-lifecycle\n","date":"2018-09-25 00:33:51","modifiedFileCount":"253","status":"M","submitter":"Lee Hinman"},{"authorTime":"2018-12-05 00:53:20","codes":[{"authorDate":"2018-12-05 00:53:20","commitOrder":6,"curCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2018-12-05 00:53:20","endLine":513,"groupId":"29854","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/51/3d76e2a31e06954472c3a462eae2f5fd0ce435.src","preCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":496,"status":"M"},{"authorDate":"2018-12-05 00:53:20","commitOrder":6,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2018-12-05 00:53:20","endLine":292,"groupId":"4077","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/07/19329ece4859ae381c8bb5c51ac7f83191584a.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":282,"status":"M"}],"commitId":"0df08dd4587c8f9774dad348f7795c677d24fb4b","commitMessage":"@@@Set Lucene version upon index creation. (#36038)\n\nIt is important that all shards of a given index have the same\n`indexCreatedVersionMajor` to Lucene.  or eg. merging those shards is going to\nbe considered illegal. At the moment.  we use the latest Lucene version when\ncreating a shard.  which could cause shards to have different created versions\neg. in case of forced allocation. This commit makes sure to reuse the\nappropriate Lucene version in order to avoid such issues.\n\nCloses #33826\n","date":"2018-12-05 00:53:20","modifiedFileCount":"11","status":"M","submitter":"Adrien Grand"},{"authorTime":"2018-12-05 00:53:20","codes":[{"authorDate":"2019-03-19 21:13:27","commitOrder":7,"curCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2019-03-19 21:13:27","endLine":520,"groupId":"29854","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/a4/83e79467b98e668a2f860e0e74e417fe6ec0fe.src","preCode":"    private InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                        @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                        @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                        EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":503,"status":"M"},{"authorDate":"2018-12-05 00:53:20","commitOrder":7,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2018-12-05 00:53:20","endLine":292,"groupId":"4077","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/07/19329ece4859ae381c8bb5c51ac7f83191584a.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":282,"status":"N"}],"commitId":"a520cc53dc2be904794299c9b00270d9ac9e80d9","commitMessage":"@@@Always fail engine if delete operation fails (#40117)\n\nUnlike index operations which can fail at the document level to\nanalyzing errors.  delete operations should never fail at the document\nlevel whether soft-deletes is enabled or not. With this change.  we will\nalways fail the engine if we fail to apply a delete operation to Lucene.\n\nCloses #33256","date":"2019-03-19 21:13:27","modifiedFileCount":"4","status":"M","submitter":"Nhat Nguyen"},{"authorTime":"2019-03-20 20:56:38","codes":[{"authorDate":"2019-03-20 20:56:38","commitOrder":8,"curCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.reinitializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2019-03-20 20:56:38","endLine":520,"groupId":"29854","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/2c/620a585aa7142a47224da476f75bd3da1be339.src","preCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":503,"status":"M"},{"authorDate":"2019-03-20 20:56:38","commitOrder":8,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.reinitializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2019-03-20 20:56:38","endLine":295,"groupId":"4077","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/df/ac5ef2654b8b57d2383cb24bf66c81b09764f5.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.initializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":285,"status":"M"}],"commitId":"df9f0f729fd47ad9585f7c80f863a5779ce2c5bf","commitMessage":"@@@Cascading primary failure lead to MSU too low (#40249)\n\nIf a replica were first reset due to one primary failover and then\npromoted (before resync completes).  its MSU would not include changes\nsince global checkpoint.  leading to errors during translog replay.\n\nFixed by re-initializing MSU before restoring local history.","date":"2019-03-20 20:56:38","modifiedFileCount":"10","status":"M","submitter":"Henning Andersen"},{"authorTime":"2019-04-30 08:57:31","codes":[{"authorDate":"2019-04-30 08:57:31","commitOrder":9,"curCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2019-04-30 08:57:31","endLine":520,"groupId":"29854","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/af/a319af7e1cf7f7880d75de9197cd6b1db25a1c.src","preCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.reinitializeMaxSeqNoOfUpdatesOrDeletes();\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":504,"status":"M"},{"authorDate":"2019-04-30 08:57:31","commitOrder":9,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2019-04-30 08:57:31","endLine":294,"groupId":"4077","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/4a/56d6370eb916912adf4b5d4a103cca466c4f14.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.reinitializeMaxSeqNoOfUpdatesOrDeletes();\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":285,"status":"M"}],"commitId":"73bfdc4066be080dc4cad1f0521bf6ea14cded93","commitMessage":"@@@Simplify initialization of max_seq_no of updates (#41161)\n\nToday we choose to initialize max_seq_no_of_updates on primaries only so\nwe can deal with a situation where a primary is on an old node (before\n6.5) which does not have MUS while replicas on new nodes (6.5+).\nHowever.  this strategy is quite complex and can lead to bugs (for\nexample #40249) since we have to assign a correct value (not too low) to\nMSU in all possible situations (before recovering from translog. \nrestoring history on promotion.  and handing off relocation).\n\nFortunately.  we don't have to deal with this BWC in 7.0+ since all nodes\nin the cluster should have MSU. This change simplifies the\ninitialization of MSU by always assigning it a correct value in the\nconstructor of Engine regardless of whether it's a replica or primary.\n\nRelates #33842","date":"2019-04-30 08:57:31","modifiedFileCount":"11","status":"M","submitter":"Nhat Nguyen"},{"authorTime":"2020-12-04 06:02:42","codes":[{"authorDate":"2020-12-04 06:02:42","commitOrder":10,"curCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty();\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","date":"2020-12-04 06:02:42","endLine":542,"groupId":"102507","id":15,"instanceNumber":1,"isCurCommit":0,"methodName":"createEngine","params":"(@NullableIndexWriterFactoryindexWriterFactory@@NullableBiFunction<Long@Long@LocalCheckpointTracker>localCheckpointTrackerSupplier@@NullableToLongBiFunction<Engine@Engine.Operation>seqNoForOperation@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/65/3acc74397926e04e3056085c3de8c5691f8ec5.src","preCode":"    protected InternalEngine createEngine(@Nullable IndexWriterFactory indexWriterFactory,\n                                          @Nullable BiFunction<Long, Long, LocalCheckpointTracker> localCheckpointTrackerSupplier,\n                                          @Nullable ToLongBiFunction<Engine, Engine.Operation> seqNoForOperation,\n                                          EngineConfig config) throws IOException {\n        final Store store = config.getStore();\n        final Directory directory = store.directory();\n        if (Lucene.indexExists(directory) == false) {\n            store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n            final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, primaryTerm.get());\n            store.associateIndexWithNewTranslog(translogUuid);\n\n        }\n        InternalEngine internalEngine = createInternalEngine(indexWriterFactory, localCheckpointTrackerSupplier, seqNoForOperation, config);\n        internalEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return internalEngine;\n    }\n","realPath":"test/framework/src/main/java/org/elasticsearch/index/engine/EngineTestCase.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":526,"status":"M"},{"authorDate":"2020-12-04 06:02:42","commitOrder":10,"curCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty();\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","date":"2020-12-04 06:02:42","endLine":290,"groupId":"102507","id":16,"instanceNumber":2,"isCurCommit":0,"methodName":"createEngine","params":"(Storestore@EngineConfigconfig)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-elasticsearch-10-0.7/blobInfo/CC_OUT/blobs/7b/7b89e2400631d0510062353c4b35c2d10e7a4b.src","preCode":"    private FollowingEngine createEngine(Store store, EngineConfig config) throws IOException {\n        store.createEmpty(config.getIndexSettings().getIndexVersionCreated().luceneVersion);\n        final String translogUuid = Translog.createEmptyTranslog(config.getTranslogConfig().getTranslogPath(),\n                SequenceNumbers.NO_OPS_PERFORMED, shardId, 1L);\n        store.associateIndexWithNewTranslog(translogUuid);\n        FollowingEngine followingEngine = new FollowingEngine(config);\n        TranslogHandler translogHandler = new TranslogHandler(xContentRegistry(), config.getIndexSettings());\n        followingEngine.recoverFromTranslog(translogHandler, Long.MAX_VALUE);\n        return followingEngine;\n    }\n","realPath":"x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/index/engine/FollowingEngineTests.java","repoName":"elasticsearch","snippetEndLine":0,"snippetStartLine":0,"startLine":281,"status":"M"}],"commitId":"ac18f24124bba3e3536d73ab81a06c3fb389c361","commitMessage":"@@@Avoid passing Lucene version to Store#createEmpty. (#65783)\n\nStore already holds onto index settings.  so it can look up the version directly.\nThis helps consolidate version checks in a smaller number of places.","date":"2020-12-04 06:02:42","modifiedFileCount":"9","status":"M","submitter":"Julie Tibshirani"}]
