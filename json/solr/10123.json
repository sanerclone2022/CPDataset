[{"authorTime":"2015-05-11 20:37:18","codes":[{"authorDate":"2015-05-11 20:37:18","commitOrder":1,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, ExpressibleStream.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2015-05-11 20:37:18","endLine":146,"groupId":"48571","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/d6/07a6a68dc70cf7fc2441157eb8ce907f2b74fd.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, ExpressibleStream.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":83,"status":"B"},{"authorDate":"2015-05-11 20:37:18","commitOrder":1,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, ExpressibleStream.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2015-05-11 20:37:18","endLine":93,"groupId":"48571","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/e6/13492b86593ba3cae91c75b444b7b921f5ed34.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, ExpressibleStream.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":57,"status":"B"}],"commitId":"e50f4d94c74560d863df197f21bc87d21c212f8c","commitMessage":"@@@SOLR-7377: Streaming Expressions\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1678743 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2015-05-11 20:37:18","modifiedFileCount":"3","status":"B","submitter":"Joel Bernstein"},{"authorTime":"2015-06-20 02:53:57","codes":[{"authorDate":"2015-06-20 02:53:57","commitOrder":2,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), StreamComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2015-06-20 02:53:57","endLine":146,"groupId":"48571","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/2d/b6b3ece2690c08a2ae97b3b27d5e6d947f7576.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, ExpressibleStream.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":83,"status":"M"},{"authorDate":"2015-06-20 02:53:57","commitOrder":2,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), StreamComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2015-06-20 02:53:57","endLine":93,"groupId":"48571","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/11/4525027bf79d6617e14ec22cd9742a04c468ae.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, ExpressibleStream.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":57,"status":"M"}],"commitId":"1ff66e90f1a5c209130bc39095f2f57107ee30d4","commitMessage":"@@@SOLR-7513.  SOLR-7528: Add Equalitors to Streaming Expressions\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1686481 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2015-06-20 02:53:57","modifiedFileCount":"16","status":"M","submitter":"Joel Bernstein"},{"authorTime":"2015-06-24 21:07:09","codes":[{"authorDate":"2015-06-24 21:07:09","commitOrder":3,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2015-06-24 21:07:09","endLine":146,"groupId":"48571","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/4a/25de263930fee99f4c6d09c1304e39a61776a1.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), StreamComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":83,"status":"M"},{"authorDate":"2015-06-24 21:07:09","commitOrder":3,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2015-06-24 21:07:09","endLine":94,"groupId":"48571","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/d5/a25cf05020c58d037d0216f50e283deed992cc.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    Comparator<Tuple> comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), StreamComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":58,"status":"M"}],"commitId":"33a4099b9850b4f5ee8f6fe237d07060a4272704","commitMessage":"@@@SOLR-7554: Add checks in Streams for incoming stream order\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1687258 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2015-06-24 21:07:09","modifiedFileCount":"18","status":"M","submitter":"Joel Bernstein"},{"authorTime":"2015-06-24 21:07:09","codes":[{"authorDate":"2015-12-10 03:52:28","commitOrder":4,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2015-12-10 03:52:28","endLine":147,"groupId":"48571","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/6c/43a14aea5cdbd38a47533d1fe1db482505e510.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    objectSerialize = false;\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":85,"status":"M"},{"authorDate":"2015-06-24 21:07:09","commitOrder":4,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2015-06-24 21:07:09","endLine":94,"groupId":"48571","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/d5/a25cf05020c58d037d0216f50e283deed992cc.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":58,"status":"N"}],"commitId":"e04981edc7995280b488197611847f9a7b201e2e","commitMessage":"@@@SOLR-8266: Remove Java Serialization from the Streaming API\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1718947 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2015-12-10 03:52:28","modifiedFileCount":"4","status":"M","submitter":"Joel Bernstein"},{"authorTime":"2015-06-24 21:07:09","codes":[{"authorDate":"2016-01-05 08:32:29","commitOrder":5,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n      if(zkHost == null) {\n        zkHost = factory.getDefaultZkHost();\n      }\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2016-01-05 08:32:29","endLine":150,"groupId":"48571","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/d2/e684910e5648498ad5c3a44963b9e484de02ab.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":85,"status":"M"},{"authorDate":"2015-06-24 21:07:09","commitOrder":5,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2015-06-24 21:07:09","endLine":94,"groupId":"48571","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/d5/a25cf05020c58d037d0216f50e283deed992cc.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":58,"status":"N"}],"commitId":"26a1d1ea34a14025048bb020377dcc82bed005da","commitMessage":"@@@SOLR-7535: Add UpdateStream to Streaming API and Streaming Expression\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1722990 13f79535-47bb-0310-9956-ffa450edef68\n","date":"2016-01-05 08:32:29","modifiedFileCount":"10","status":"M","submitter":"Joel Bernstein"},{"authorTime":"2015-06-24 21:07:09","codes":[{"authorDate":"2016-07-12 08:10:27","commitOrder":6,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workers' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n      if(zkHost == null) {\n        zkHost = factory.getDefaultZkHost();\n      }\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2016-07-17 10:36:30","endLine":148,"groupId":"48571","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/31/25ff0cc7deb045a8231cb39fc941220588a7a2.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workersParam' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n      if(zkHost == null) {\n        zkHost = factory.getDefaultZkHost();\n      }\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":83,"status":"M"},{"authorDate":"2015-06-24 21:07:09","commitOrder":6,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2015-06-24 21:07:09","endLine":94,"groupId":"48571","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/d5/a25cf05020c58d037d0216f50e283deed992cc.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":58,"status":"N"}],"commitId":"fc3894e837701b78a4704cf27529c34c15666586","commitMessage":"@@@SOLR-9240:Support running the topic() Streaming Expression in parallel mode.\n","date":"2016-07-17 10:36:30","modifiedFileCount":"5","status":"M","submitter":"jbernste"},{"authorTime":"2017-03-23 15:42:20","codes":[{"authorDate":"2017-03-23 15:42:20","commitOrder":7,"curCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, SORT);\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workers' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n      if(zkHost == null) {\n        zkHost = factory.getDefaultZkHost();\n      }\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","date":"2017-03-23 15:42:20","endLine":151,"groupId":"10123","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"ParallelStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/87/e13549d05cb65a309dd0e26925d0275be7a902.src","preCode":"  public ParallelStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    String collectionName = factory.getValueOperand(expression, 0);\n    StreamExpressionNamedParameter workersParam = factory.getNamedOperand(expression, \"workers\");\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    StreamExpressionNamedParameter zkHostExpression = factory.getNamedOperand(expression, \"zkHost\");\n    \n    \r\n\n    if(expression.getParameters().size() != streamExpressions.size() + 3 + (null != zkHostExpression ? 1 : 0)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    \r\n    if(null == collectionName){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - collectionName expected as first operand\",expression));\n    }\n\n    \r\n    if(null == workersParam || null == workersParam.getParameter() || !(workersParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'workers' parameter of type positive integer but didn't find one\",expression));\n    }\n    String workersStr = ((StreamExpressionValue)workersParam.getParameter()).getValue();\n    int workersInt = 0;\n    try{\n      workersInt = Integer.parseInt(workersStr);\n      if(workersInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' must be greater than 0.\",expression, workersStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - workers '%s' is not a valid integer.\",expression, workersStr));\n    }    \n\n    \r\n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }\n    \n    \r\n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'sort' parameter telling us how to join the parallel streams but didn't find one\",expression));\n    }\n    \n    \r\n    String zkHost = null;\n    if(null == zkHostExpression){\n      zkHost = factory.getCollectionZkHost(collectionName);\n      if(zkHost == null) {\n        zkHost = factory.getDefaultZkHost();\n      }\n    }\n    else if(zkHostExpression.getParameter() instanceof StreamExpressionValue){\n      zkHost = ((StreamExpressionValue)zkHostExpression.getParameter()).getValue();\n    }\n    if(null == zkHost){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - zkHost not found for collection '%s'\",expression,collectionName));\n    }\n    \n    \r\n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    streamFactory = factory;\n    init(zkHost,collectionName,stream,workersInt,comp);\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/ParallelStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":86,"status":"M"},{"authorDate":"2017-03-23 15:42:20","commitOrder":7,"curCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, SORT);\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","date":"2017-03-23 15:42:20","endLine":98,"groupId":"10123","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"RankStream","params":"(StreamExpressionexpression@StreamFactoryfactory)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/a9/fb1afd2c8a52c5f724a1a9e6e43d7a064a30fe.src","preCode":"  public RankStream(StreamExpression expression, StreamFactory factory) throws IOException {\n    \r\n    List<StreamExpression> streamExpressions = factory.getExpressionOperandsRepresentingTypes(expression, Expressible.class, TupleStream.class);\n    StreamExpressionNamedParameter nParam = factory.getNamedOperand(expression, \"n\");\n    StreamExpressionNamedParameter sortExpression = factory.getNamedOperand(expression, \"sort\");\n    \n    \r\n    if(expression.getParameters().size() != streamExpressions.size() + 2){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - unknown operands found\", expression));\n    }\n    \n    if(null == nParam || null == nParam.getParameter() || !(nParam.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single 'n' parameter of type positive integer but didn't find one\",expression));\n    }\n    String nStr = ((StreamExpressionValue)nParam.getParameter()).getValue();\n    int nInt = 0;\n    try{\n      nInt = Integer.parseInt(nStr);\n      if(nInt <= 0){\n        throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' must be greater than 0.\",expression, nStr));\n      }\n    }\n    catch(NumberFormatException e){\n      throw new IOException(String.format(Locale.ROOT,\"invalid expression %s - topN '%s' is not a valid integer.\",expression, nStr));\n    }    \n    if(1 != streamExpressions.size()){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting a single stream but found %d\",expression, streamExpressions.size()));\n    }    \n    if(null == sortExpression || !(sortExpression.getParameter() instanceof StreamExpressionValue)){\n      throw new IOException(String.format(Locale.ROOT,\"Invalid expression %s - expecting single 'over' parameter listing fields to unique over but didn't find one\",expression));\n    }\n    \n    TupleStream stream = factory.constructStream(streamExpressions.get(0));\n    StreamComparator comp = factory.constructComparator(((StreamExpressionValue)sortExpression.getParameter()).getValue(), FieldComparator.class);\n    \n    init(stream,nInt,comp);    \n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/RankStream.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"M"}],"commitId":"4edfc1a9c7b877a23cffbf5f73a2728173fa663d","commitMessage":"@@@SOLR-6615: use constants for 'sort'.  'distrib'\n","date":"2017-03-23 15:42:20","modifiedFileCount":"37","status":"M","submitter":"Noble Paul"}]
