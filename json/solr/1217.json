[{"authorTime":"2016-05-23 14:35:53","codes":[{"authorDate":"2016-08-20 19:36:01","commitOrder":2,"curCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","date":"2016-08-20 19:36:01","endLine":1284,"groupId":"25142","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"getStateWatchers","params":"(Stringcollection)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/a3/de324e0a7bf782e811fadec5b1c10246ea3445.src","preCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1275,"status":"B"},{"authorDate":"2016-05-23 14:35:53","commitOrder":2,"curCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        if (watcher.onStateChanged(liveNodes, collectionState)) {\n          removeCollectionStateWatcher(collection, watcher);\n        }\n      }\n    }\n","date":"2016-05-23 14:35:53","endLine":1336,"groupId":"25142","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/af/f5bba04a70649c2c9598ac1e673084b7aa21b2.src","preCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        if (watcher.onStateChanged(liveNodes, collectionState)) {\n          removeCollectionStateWatcher(collection, watcher);\n        }\n      }\n    }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1323,"status":"NB"}],"commitId":"e325973119eae1fe8b7a81d505680952ec08964f","commitMessage":"@@@Merge branch 'master' of https://git-wip-us.apache.org/repos/asf/lucene-solr\n","date":"2016-08-20 19:36:01","modifiedFileCount":"105","status":"M","submitter":"Karl Wright"},{"authorTime":"2018-04-17 21:16:31","codes":[{"authorDate":"2016-08-20 19:36:01","commitOrder":3,"curCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","date":"2016-08-20 19:36:01","endLine":1284,"groupId":"25142","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"getStateWatchers","params":"(Stringcollection)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/a3/de324e0a7bf782e811fadec5b1c10246ea3445.src","preCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1275,"status":"N"},{"authorDate":"2018-04-17 21:16:31","commitOrder":3,"curCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(liveNodes, collectionState)) {\n            removeCollectionStateWatcher(collection, watcher);\n          }\n        } catch (Throwable throwable) {\n          LOG.warn(\"Error on calling watcher\", throwable);\n        }\n      }\n    }\n","date":"2018-04-17 21:16:31","endLine":1583,"groupId":"25142","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/7d/5401dad5b49f0811eaa0577af9754e01973e79.src","preCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        if (watcher.onStateChanged(liveNodes, collectionState)) {\n          removeCollectionStateWatcher(collection, watcher);\n        }\n      }\n    }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1566,"status":"M"}],"commitId":"09db13f4f459a391896db2a90b2830f9b1fd898d","commitMessage":"@@@SOLR-12187: Replica should watch clusterstate and unload itself if its entry is removed\n","date":"2018-04-17 21:16:31","modifiedFileCount":"7","status":"M","submitter":"Cao Manh Dat"},{"authorTime":"2018-04-18 09:40:06","codes":[{"authorDate":"2016-08-20 19:36:01","commitOrder":4,"curCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","date":"2016-08-20 19:36:01","endLine":1284,"groupId":"25142","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"getStateWatchers","params":"(Stringcollection)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/a3/de324e0a7bf782e811fadec5b1c10246ea3445.src","preCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1275,"status":"N"},{"authorDate":"2018-04-18 09:40:06","commitOrder":4,"curCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(liveNodes, collectionState)) {\n            removeCollectionStateWatcher(collection, watcher);\n          }\n        } catch (Exception exception) {\n          LOG.warn(\"Error on calling watcher\", exception);\n        }\n      }\n    }\n","date":"2018-04-18 09:40:06","endLine":1633,"groupId":"25142","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/cf/ae84975dae01219a96959ac9c956c8980a7082.src","preCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(liveNodes, collectionState)) {\n            removeCollectionStateWatcher(collection, watcher);\n          }\n        } catch (Throwable throwable) {\n          LOG.warn(\"Error on calling watcher\", throwable);\n        }\n      }\n    }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1616,"status":"M"}],"commitId":"1d2441441be5f5d87103ceeec6d852f8f2f6ba85","commitMessage":"@@@SOLR-12187: ZkStateReader.Notification thread should only catch Exception\n","date":"2018-04-18 09:40:06","modifiedFileCount":"2","status":"M","submitter":"Cao Manh Dat"},{"authorTime":"2018-08-23 06:26:37","codes":[{"authorDate":"2016-08-20 19:36:01","commitOrder":5,"curCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","date":"2016-08-20 19:36:01","endLine":1284,"groupId":"25142","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"getStateWatchers","params":"(Stringcollection)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/a3/de324e0a7bf782e811fadec5b1c10246ea3445.src","preCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1275,"status":"N"},{"authorDate":"2018-08-23 06:26:37","commitOrder":5,"curCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(liveNodes, collectionState)) {\n            removeCollectionStateWatcher(collection, watcher);\n          }\n        } catch (Exception exception) {\n          log.warn(\"Error on calling watcher\", exception);\n        }\n      }\n    }\n","date":"2018-08-23 06:26:37","endLine":1649,"groupId":"25142","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/6a/bfba8858353f2c829fb713ed672ab52c69a89f.src","preCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(liveNodes, collectionState)) {\n            removeCollectionStateWatcher(collection, watcher);\n          }\n        } catch (Exception exception) {\n          LOG.warn(\"Error on calling watcher\", exception);\n        }\n      }\n    }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1632,"status":"M"}],"commitId":"8cde1277ec7151bd6ab62950ac93cbdd6ff04d9f","commitMessage":"@@@SOLR-12690: Regularize LoggerFactory declarations\n","date":"2018-08-23 06:26:37","modifiedFileCount":"93","status":"M","submitter":"Erick Erickson"},{"authorTime":"2019-06-18 00:59:43","codes":[{"authorDate":"2019-06-18 00:59:43","commitOrder":6,"curCode":"  Set<DocCollectionWatcher> getStateWatchers(String collection) {\n    final Set<DocCollectionWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","date":"2019-06-18 00:59:43","endLine":1870,"groupId":"1217","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"getStateWatchers","params":"(Stringcollection)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/cd/72203eacb801fba6859d03a0f8ad500243ef36.src","preCode":"  Set<CollectionStateWatcher> getStateWatchers(String collection) {\n    final Set<CollectionStateWatcher> watchers = new HashSet<>();\n    collectionWatches.compute(collection, (k, v) -> {\n      if (v != null) {\n        watchers.addAll(v.stateWatchers);\n      }\n      return v;\n    });\n    return watchers;\n  }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1861,"status":"M"},{"authorDate":"2019-06-18 00:59:43","commitOrder":6,"curCode":"    public void run() {\n      List<DocCollectionWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (DocCollectionWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(collectionState)) {\n            removeDocCollectionWatcher(collection, watcher);\n          }\n        } catch (Exception exception) {\n          log.warn(\"Error on calling watcher\", exception);\n        }\n      }\n    }\n","date":"2019-06-18 00:59:43","endLine":2006,"groupId":"1217","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"run","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-solr-10-0.7/blobInfo/CC_OUT/blobs/cd/72203eacb801fba6859d03a0f8ad500243ef36.src","preCode":"    public void run() {\n      List<CollectionStateWatcher> watchers = new ArrayList<>();\n      collectionWatches.compute(collection, (k, v) -> {\n        if (v == null)\n          return null;\n        watchers.addAll(v.stateWatchers);\n        return v;\n      });\n      for (CollectionStateWatcher watcher : watchers) {\n        try {\n          if (watcher.onStateChanged(liveNodes, collectionState)) {\n            removeCollectionStateWatcher(collection, watcher);\n          }\n        } catch (Exception exception) {\n          log.warn(\"Error on calling watcher\", exception);\n        }\n      }\n    }\n","realPath":"solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java","repoName":"solr","snippetEndLine":0,"snippetStartLine":0,"startLine":1989,"status":"M"}],"commitId":"5a974860fa83408a86ca64b417f3111b037da7eb","commitMessage":"@@@SOLR-13490: Fix CollectionStateWatcher/CollectionStatePredicate based APIs in ZkStateReader and CloudSolrClient to be triggered on liveNode changes.\n\nAlso add Predicate<DocCollection> equivilents for callers that don't care about liveNodes.\n","date":"2019-06-18 00:59:43","modifiedFileCount":"15","status":"M","submitter":"Chris Hostetter"}]
