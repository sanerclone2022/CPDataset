[{"authorTime":"2018-04-20 07:13:13","codes":[{"authorDate":"2018-04-20 07:13:13","commitOrder":1,"curCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L, TaskState.TIMED_OUT);\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, notStartedJobName), 10000L,\n        TaskState.NOT_STARTED);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","date":"2018-04-21 00:56:34","endLine":128,"groupId":"6865","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testWorkflowRunningTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/71/d494b6b1381e88054976837de6bfbe1084a263.src","preCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L, TaskState.TIMED_OUT);\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, notStartedJobName), 10000L,\n        TaskState.NOT_STARTED);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"B"},{"authorDate":"2018-04-20 07:13:13","commitOrder":1,"curCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 2000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 100);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(40);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, notStartedJobName), 10000L,\n        TaskState.NOT_STARTED);\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","date":"2018-04-21 00:56:34","endLine":174,"groupId":"5337","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testWorkflowPausedTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/71/d494b6b1381e88054976837de6bfbe1084a263.src","preCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 2000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 100);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(40);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, notStartedJobName), 10000L,\n        TaskState.NOT_STARTED);\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":131,"status":"B"}],"commitId":"317c300c8f951c7e8308cb0b24e48f97a1ef32ef","commitMessage":"@@@[HELIX-696] fix workflow state flip-flop issue\n","date":"2018-04-21 00:56:34","modifiedFileCount":"5","status":"B","submitter":"Harry Zhang"},{"authorTime":"2018-04-25 03:47:28","codes":[{"authorDate":"2018-04-25 03:47:28","commitOrder":2,"curCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L, TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","date":"2018-04-25 03:52:59","endLine":127,"groupId":"6865","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testWorkflowRunningTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/2d/a3e2f38fee171c233c0b3225e8ed50336b61b9.src","preCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L, TaskState.TIMED_OUT);\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, notStartedJobName), 10000L,\n        TaskState.NOT_STARTED);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"M"},{"authorDate":"2018-04-25 03:47:28","commitOrder":2,"curCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 2000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 100);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(40);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","date":"2018-04-25 03:52:59","endLine":173,"groupId":"5337","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testWorkflowPausedTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/2d/a3e2f38fee171c233c0b3225e8ed50336b61b9.src","preCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 2000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 100);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(40);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, notStartedJobName), 10000L,\n        TaskState.NOT_STARTED);\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":130,"status":"M"}],"commitId":"5c49de3c8532f53a126189d8e7d3d89f85ae3b2b","commitMessage":"@@@Fix broken TestWorkflowTermination\n","date":"2018-04-25 03:52:59","modifiedFileCount":"1","status":"M","submitter":"Harry Zhang"},{"authorTime":"2018-07-18 08:56:36","codes":[{"authorDate":"2018-04-25 03:47:28","commitOrder":3,"curCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L, TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","date":"2018-04-25 03:52:59","endLine":127,"groupId":"6865","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testWorkflowRunningTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/2d/a3e2f38fee171c233c0b3225e8ed50336b61b9.src","preCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L, TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"N"},{"authorDate":"2018-07-18 08:56:36","commitOrder":3,"curCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 5000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(100);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","date":"2018-09-18 06:45:45","endLine":173,"groupId":"5337","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testWorkflowPausedTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/1a/0846876b94b98ad5c9499b97e1340818892145.src","preCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 2000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 100);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(\n            new WorkflowConfig.Builder(workflowName)\n                .setTimeout(timeout)\n                .setWorkFlowType(WORKFLOW_TYPE)\n                .build()\n        )\n        .addJob(JOB_NAME, jobBuilder)\n        .addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName)\n        .setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(40);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":130,"status":"M"}],"commitId":"50c9aa3a2eaf82e75743c693b7e40ad741e51198","commitMessage":"@@@Replace BestPossibleStage with TaskSchedulingStage\n\nFor new task framework.  we dont have to loop through all the idealstates. For the first step.  we can have a simple version of BestPossibleStage.\n","date":"2018-09-18 06:45:45","modifiedFileCount":"3","status":"M","submitter":"Junkai Xue"},{"authorTime":"2020-06-19 07:34:43","codes":[{"authorDate":"2020-06-19 07:34:43","commitOrder":4,"curCode":"  public void testWorkflowRunningTimeout() throws Exception {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(new WorkflowConfig.Builder(workflowName).setTimeout(timeout)\n            .setWorkFlowType(WORKFLOW_TYPE).build())\n        .addJob(JOB_NAME, jobBuilder).addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName).setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n    long finishTime = _driver.getWorkflowContext(workflowName).getFinishTime();\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n    long cleanUpTime = System.currentTimeMillis();\n    Assert.assertTrue(cleanUpTime - finishTime >= workflowExpiry);\n  }\n","date":"2020-06-19 07:34:43","endLine":137,"groupId":"10521","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testWorkflowRunningTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/21/b28cf7eed566bb2e8155602b6e84625764b17f.src","preCode":"  public void testWorkflowRunningTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n    long workflowExpiry = 2000; \r\n    long timeout = 50;\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n\n    \r\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(new WorkflowConfig.Builder(workflowName).setTimeout(timeout)\n            .setWorkFlowType(WORKFLOW_TYPE).build())\n        .addJob(JOB_NAME, jobBuilder).addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName).setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    \r\n    \r\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.TIMED_OUT);\n\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":104,"status":"M"},{"authorDate":"2020-06-19 07:34:43","commitOrder":4,"curCode":"  public void testWorkflowPausedTimeout() throws Exception {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 5000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(new WorkflowConfig.Builder(workflowName).setTimeout(timeout)\n            .setWorkFlowType(WORKFLOW_TYPE).build())\n        .addJob(JOB_NAME, jobBuilder).addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName).setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(100);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n    long finishTime = _driver.getWorkflowContext(workflowName).getFinishTime();\n\n    context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n    long cleanUpTime = System.currentTimeMillis();\n    Assert.assertTrue(cleanUpTime - finishTime >= workflowExpiry);\n\n  }\n","date":"2020-06-19 07:34:43","endLine":179,"groupId":"10521","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testWorkflowPausedTimeout","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/21/b28cf7eed566bb2e8155602b6e84625764b17f.src","preCode":"  public void testWorkflowPausedTimeout() throws InterruptedException {\n    String workflowName = TestHelper.getTestMethodName();\n    long workflowExpiry = 2000; \r\n    long timeout = 5000;\n    String notStartedJobName = JOB_NAME + \"-NotStarted\";\n\n    JobConfig.Builder jobBuilder = createJobConfigBuilder(workflowName, false, 5000);\n    jobBuilder.setWorkflow(workflowName);\n    Workflow.Builder workflowBuilder = new Workflow.Builder(workflowName)\n        .setWorkflowConfig(new WorkflowConfig.Builder(workflowName).setTimeout(timeout)\n            .setWorkFlowType(WORKFLOW_TYPE).build())\n        .addJob(JOB_NAME, jobBuilder).addJob(notStartedJobName, jobBuilder)\n        .addParentChildDependency(JOB_NAME, notStartedJobName).setExpiry(workflowExpiry);\n\n    _driver.start(workflowBuilder.build());\n\n    \r\n    \r\n    Thread.sleep(100);\n\n    \r\n    _driver.waitToStop(workflowName, 10000L);\n\n    _driver.pollForJobState(workflowName, getJobNameToPoll(workflowName, JOB_NAME), 10000L,\n        TaskState.STOPPED);\n    WorkflowContext context = _driver.getWorkflowContext(workflowName);\n    Assert.assertNull(context.getJobState(notStartedJobName));\n\n    _driver.pollForWorkflowState(workflowName, 10000L, TaskState.TIMED_OUT);\n\n    context = _driver.getWorkflowContext(workflowName);\n    Assert.assertTrue(context.getFinishTime() - context.getStartTime() >= timeout);\n\n    Thread.sleep(workflowExpiry + 200);\n    verifyWorkflowCleanup(workflowName, getJobNameToPoll(workflowName, JOB_NAME),\n        getJobNameToPoll(workflowName, notStartedJobName));\n\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestWorkflowTermination.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":140,"status":"M"}],"commitId":"3c1731bd97442804663488a42e73e4c5f765a4e8","commitMessage":"@@@Stabilize TestWorkflowTermination (#1096)\n\nStabilize TestWorkflowTermination\n\nIn this PR.  TestWorkflowTermination has been stabilized.\nAlso.  testGetStateModelDef which has not been adjusted\nin previous commits is fixed.","date":"2020-06-19 07:34:43","modifiedFileCount":"2","status":"M","submitter":"Ali Reza Zamani Zadeh Najari"}]
