[{"authorTime":"2016-05-07 03:05:30","codes":[{"authorDate":"2016-05-07 03:05:30","commitOrder":2,"curCode":"  public void testTaskAssignment() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    \r\n    Thread.sleep(1000L);\n\n    \r\n    Assert.assertNull(\n        _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource)).getPartitionState(0));\n\n  }\n","date":"2016-07-06 07:19:11","endLine":61,"groupId":"27","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testTaskAssignment","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/df/976b123e38c638afe1f6002eb1638052439e38.src","preCode":"  public void testTaskAssignment() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    \r\n    Thread.sleep(1000L);\n\n    \r\n    Assert.assertNull(\n        _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource)).getPartitionState(0));\n\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestTaskAssignment.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":43,"status":"B"},{"authorDate":"2016-05-07 03:05:30","commitOrder":2,"curCode":"  public void testTaskWithInstanceDisabled() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    TaskTestUtil.pollForWorkflowState(_driver, jobResource, TaskState.COMPLETED);\n    JobContext ctx = _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource));\n    Assert.assertEquals(ctx.getAssignedParticipant(0), PARTICIPANT_PREFIX + \"_\" + (_startPort + 1));\n  }\n","date":"2016-07-06 07:19:11","endLine":57,"groupId":"27","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testTaskWithInstanceDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/84/e516803033228b85e08019dc73cb61806ee66b.src","preCode":"  public void testTaskWithInstanceDisabled() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    TaskTestUtil.pollForWorkflowState(_driver, jobResource, TaskState.COMPLETED);\n    JobContext ctx = _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource));\n    Assert.assertEquals(ctx.getAssignedParticipant(0), PARTICIPANT_PREFIX + \"_\" + (_startPort + 1));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestTaskWithInstanceDisabled.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":44,"status":"MB"}],"commitId":"9a30df46bc054514a708b5070f166ee5aa2e7cd1","commitMessage":"@@@Fix task assignment in instance group tag check\n\n1. Fixed task assignment with instacnce group. When target state is not set.  it ont check the state of instance.\n2. Add a new test to assign task. The instance will be assign to has been disabled. So the task should be hanging there.\n","date":"2016-07-06 07:19:11","modifiedFileCount":"2","status":"M","submitter":"Junkai Xue"},{"authorTime":"2016-05-11 02:44:25","codes":[{"authorDate":"2016-05-07 03:05:30","commitOrder":3,"curCode":"  public void testTaskAssignment() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    \r\n    Thread.sleep(1000L);\n\n    \r\n    Assert.assertNull(\n        _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource)).getPartitionState(0));\n\n  }\n","date":"2016-07-06 07:19:11","endLine":61,"groupId":"27","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testTaskAssignment","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/df/976b123e38c638afe1f6002eb1638052439e38.src","preCode":"  public void testTaskAssignment() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    \r\n    Thread.sleep(1000L);\n\n    \r\n    Assert.assertNull(\n        _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource)).getPartitionState(0));\n\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestTaskAssignment.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":43,"status":"N"},{"authorDate":"2016-05-11 02:44:25","commitOrder":3,"curCode":"  public void testTaskWithInstanceDisabled() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    _driver.pollForWorkflowState(jobResource, TaskState.COMPLETED);\n    JobContext ctx = _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource));\n    Assert.assertEquals(ctx.getAssignedParticipant(0), PARTICIPANT_PREFIX + \"_\" + (_startPort + 1));\n  }\n","date":"2016-07-06 07:21:13","endLine":57,"groupId":"27","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testTaskWithInstanceDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/91/9dc996dda125522686752e9caba73b0b04a836.src","preCode":"  public void testTaskWithInstanceDisabled() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    TaskTestUtil.pollForWorkflowState(_driver, jobResource, TaskState.COMPLETED);\n    JobContext ctx = _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource));\n    Assert.assertEquals(ctx.getAssignedParticipant(0), PARTICIPANT_PREFIX + \"_\" + (_startPort + 1));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestTaskWithInstanceDisabled.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":44,"status":"M"}],"commitId":"183a26ae7857a7c35985b14df9742ba3f4a06566","commitMessage":"@@@Add pollForJobState and pollForWorkflowState function in TaskDriver\n\n1. Add pollForJobState and pollForWorkflowState functions in TaskDriver\n2. Add unit tests for poll completed states for those tasks.\n3. Refactor all tests using new functions.\n","date":"2016-07-06 07:21:13","modifiedFileCount":"20","status":"M","submitter":"Junkai Xue"},{"authorTime":"2018-06-08 08:15:54","codes":[{"authorDate":"2018-06-08 08:15:54","commitOrder":4,"curCode":"  public void testTaskAssignment() throws InterruptedException {\n    _gSetupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    \r\n    Thread.sleep(1000L);\n\n    \r\n    Assert.assertNull(\n        _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource)).getPartitionState(0));\n  }\n","date":"2018-07-14 02:20:49","endLine":64,"groupId":"10514","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testTaskAssignment","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/60/45812569a5d8e3ce0a492c96bfa16c08876184.src","preCode":"  public void testTaskAssignment() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    \r\n    Thread.sleep(1000L);\n\n    \r\n    Assert.assertNull(\n        _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource)).getPartitionState(0));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestTaskAssignment.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"},{"authorDate":"2018-06-08 08:15:54","commitOrder":4,"curCode":"  public void testTaskWithInstanceDisabled() throws InterruptedException {\n    _gSetupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    _driver.pollForWorkflowState(jobResource, TaskState.COMPLETED);\n    JobContext ctx = _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource));\n    Assert.assertEquals(ctx.getAssignedParticipant(0), PARTICIPANT_PREFIX + \"_\" + (_startPort + 1));\n  }\n","date":"2018-07-14 02:20:49","endLine":56,"groupId":"10514","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testTaskWithInstanceDisabled","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/6b/ea3e7e5f2f9a52677c6f13b10c51f8ed9a52fe.src","preCode":"  public void testTaskWithInstanceDisabled() throws InterruptedException {\n    _setupTool.getClusterManagementTool()\n        .enableInstance(CLUSTER_NAME, PARTICIPANT_PREFIX + \"_\" + (_startPort + 0), false);\n    String jobResource = TestHelper.getTestMethodName();\n    JobConfig.Builder jobBuilder = new JobConfig.Builder().setCommand(MockTask.TASK_COMMAND)\n        .setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB);\n    Workflow flow =\n        WorkflowGenerator.generateSingleJobWorkflowBuilder(jobResource, jobBuilder).build();\n    _driver.start(flow);\n\n    _driver.pollForWorkflowState(jobResource, TaskState.COMPLETED);\n    JobContext ctx = _driver.getJobContext(TaskUtil.getNamespacedJobName(jobResource));\n    Assert.assertEquals(ctx.getAssignedParticipant(0), PARTICIPANT_PREFIX + \"_\" + (_startPort + 1));\n  }\n","realPath":"helix-core/src/test/java/org/apache/helix/integration/task/TestTaskWithInstanceDisabled.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":43,"status":"M"}],"commitId":"c0d5792b745c67b6fee56ba79df02be89d1f049e","commitMessage":"@@@Properly remove clusters after each test.  and clean up duplicated codes in tests and move them into base test classes.\n","date":"2018-07-14 02:20:49","modifiedFileCount":"139","status":"M","submitter":"Lei Xia"}]
