[{"authorTime":"2014-03-27 08:33:13","codes":[{"authorDate":"2014-03-27 08:33:13","commitOrder":1,"curCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n  }\n","date":"2014-03-27 08:33:13","endLine":75,"groupId":"1130","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"onBecomeCompletedFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/69/a3a4e6f094b401a61d9c6a6609415aa56b0e45.src","preCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"B"},{"authorDate":"2014-03-27 08:33:13","commitOrder":1,"curCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    return r.getInfo();\n  }\n","date":"2014-03-27 08:33:13","endLine":111,"groupId":"5846","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"onBecomeTaskErrorFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/69/a3a4e6f094b401a61d9c6a6609415aa56b0e45.src","preCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    return r.getInfo();\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":96,"status":"B"}],"commitId":"1e017f16a8a694c819edb0c3eddeecee3245f6b8","commitMessage":"@@@[HELIX-336] Add support for task framework.  0.6.x merge\n","date":"2014-03-27 08:33:13","modifiedFileCount":"19","status":"B","submitter":"Kanak Biscuitwala"},{"authorTime":"2015-11-08 14:43:04","codes":[{"authorDate":"2015-11-08 14:43:04","commitOrder":2,"curCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n  }\n","date":"2015-11-08 14:43:04","endLine":105,"groupId":"1130","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"onBecomeCompletedFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/30/939fc3d42f76bfae8f69db497b0065dbaf11b3.src","preCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"M"},{"authorDate":"2015-11-08 14:43:04","commitOrder":2,"curCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n\n    return r.getInfo();\n  }\n","date":"2015-11-08 14:43:04","endLine":145,"groupId":"5846","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"onBecomeTaskErrorFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/30/939fc3d42f76bfae8f69db497b0065dbaf11b3.src","preCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    return r.getInfo();\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":128,"status":"M"}],"commitId":"456ddb0c4a900ee7cdf081777eff9445378df513","commitMessage":"@@@[HELIX-613] Fix thread leaking problems in TaskStateModel by sharing one thread pool among all tasks and timeout tasks from TaskStateModels created from the same TaskStateModelFactory.\n","date":"2015-11-08 14:43:04","modifiedFileCount":"2","status":"M","submitter":"Lei Xia"},{"authorTime":"2016-07-06 06:58:51","codes":[{"authorDate":"2015-11-08 14:43:04","commitOrder":3,"curCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n  }\n","date":"2015-11-08 14:43:04","endLine":105,"groupId":"1130","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"onBecomeCompletedFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/30/939fc3d42f76bfae8f69db497b0065dbaf11b3.src","preCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"N"},{"authorDate":"2016-07-06 06:58:51","commitOrder":3,"curCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR && r.getStatus() != TaskResult.Status.FAILED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n\n    return r.getInfo();\n  }\n","date":"2016-07-06 07:14:30","endLine":145,"groupId":"5246","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"onBecomeTaskErrorFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/ba/68a7851d1282744b0d08d3121e1534bb73dbbe.src","preCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n\n    return r.getInfo();\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":128,"status":"M"}],"commitId":"7f184839aebcb817e3c9b0626bcc2a9b44c6926c","commitMessage":"@@@Add a new task state (TASK_ABORTED) to TaskResult. This allows client to abort a task and let Helix not retry it even Task.RetryCount is bigger than 1.\n","date":"2016-07-06 07:14:30","modifiedFileCount":"10","status":"M","submitter":"Lei Xia"},{"authorTime":"2016-07-06 06:58:51","codes":[{"authorDate":"2016-05-06 02:25:22","commitOrder":4,"curCode":"  public String onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n\n    return r.getInfo();\n  }\n","date":"2016-07-06 07:18:34","endLine":107,"groupId":"10732","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"onBecomeCompletedFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/fd/071763e93b566fcdd3ff389f7da857da1e1468.src","preCode":"  public void onBecomeCompletedFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.COMPLETED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":90,"status":"M"},{"authorDate":"2016-07-06 06:58:51","commitOrder":4,"curCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR && r.getStatus() != TaskResult.Status.FAILED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n\n    return r.getInfo();\n  }\n","date":"2016-07-06 07:14:30","endLine":145,"groupId":"10732","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"onBecomeTaskErrorFromRunning","params":"(Messagemsg@NotificationContextcontext)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-helix-10-0.7/blobInfo/CC_OUT/blobs/ba/68a7851d1282744b0d08d3121e1534bb73dbbe.src","preCode":"  public String onBecomeTaskErrorFromRunning(Message msg, NotificationContext context) {\n    String taskPartition = msg.getPartitionName();\n    if (_taskRunner == null) {\n      throw new IllegalStateException(String.format(\n          \"Invalid state transition. There is no running task for partition %s.\", taskPartition));\n    }\n\n    TaskResult r = _taskRunner.waitTillDone();\n    if (r.getStatus() != TaskResult.Status.ERROR && r.getStatus() != TaskResult.Status.FAILED) {\n      throw new IllegalStateException(String.format(\n          \"Partition %s received a state transition to %s but the result status code is %s.\",\n          msg.getPartitionName(), msg.getToState(), r.getStatus()));\n    }\n\n    timeout_task.cancel(false);\n\n    return r.getInfo();\n  }\n","realPath":"helix-core/src/main/java/org/apache/helix/task/TaskStateModel.java","repoName":"helix","snippetEndLine":0,"snippetStartLine":0,"startLine":128,"status":"N"}],"commitId":"9508a1acfae1d915148138daccb2abd5f9dce430","commitMessage":"@@@Populate Error message from running client's task and persist it into JobContext for better error reporting.\n","date":"2016-07-06 07:18:34","modifiedFileCount":"5","status":"M","submitter":"Lei Xia"}]
