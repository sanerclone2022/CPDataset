[{"authorTime":"2019-08-21 05:18:27","codes":[{"authorDate":"2019-08-21 05:18:27","commitOrder":1,"curCode":"\tvoid runCreatesHealthEndpointWebExtension() {\n\t\tthis.contextRunner.run((context) -> {\n\t\t\tHealthEndpointWebExtension webExtension = context.getBean(HealthEndpointWebExtension.class);\n\t\t\tWebEndpointResponse<HealthComponent> response = webExtension.health(SecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) response.getBody();\n\t\t\tassertThat(response.getStatus()).isEqualTo(200);\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","date":"2019-08-22 09:43:25","endLine":234,"groupId":"15442","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"runCreatesHealthEndpointWebExtension","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-springboot-10-0.7/blobInfo/CC_OUT/blobs/6c/e4abd7b5b392f3ae2ff23d0b7b9ce696d499d1.src","preCode":"\tvoid runCreatesHealthEndpointWebExtension() {\n\t\tthis.contextRunner.run((context) -> {\n\t\t\tHealthEndpointWebExtension webExtension = context.getBean(HealthEndpointWebExtension.class);\n\t\t\tWebEndpointResponse<HealthComponent> response = webExtension.health(SecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) response.getBody();\n\t\t\tassertThat(response.getStatus()).isEqualTo(200);\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","realPath":"spring-boot-project/spring-boot-actuator-autoconfigure/src/test/java/org/springframework/boot/actuate/autoconfigure/health/HealthEndpointAutoConfigurationTests.java","repoName":"springboot","snippetEndLine":0,"snippetStartLine":0,"startLine":226,"status":"B"},{"authorDate":"2019-08-21 05:18:27","commitOrder":1,"curCode":"\tvoid runCreatesReactiveHealthEndpointWebExtension() {\n\t\tthis.reactiveContextRunner.run((context) -> {\n\t\t\tReactiveHealthEndpointWebExtension webExtension = context.getBean(ReactiveHealthEndpointWebExtension.class);\n\t\t\tMono<WebEndpointResponse<? extends HealthComponent>> response = webExtension.health(SecurityContext.NONE,\n\t\t\t\t\ttrue, \"simple\");\n\t\t\tHealth health = (Health) (response.block().getBody());\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","date":"2019-08-22 09:43:25","endLine":254,"groupId":"6264","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"runCreatesReactiveHealthEndpointWebExtension","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-springboot-10-0.7/blobInfo/CC_OUT/blobs/6c/e4abd7b5b392f3ae2ff23d0b7b9ce696d499d1.src","preCode":"\tvoid runCreatesReactiveHealthEndpointWebExtension() {\n\t\tthis.reactiveContextRunner.run((context) -> {\n\t\t\tReactiveHealthEndpointWebExtension webExtension = context.getBean(ReactiveHealthEndpointWebExtension.class);\n\t\t\tMono<WebEndpointResponse<? extends HealthComponent>> response = webExtension.health(SecurityContext.NONE,\n\t\t\t\t\ttrue, \"simple\");\n\t\t\tHealth health = (Health) (response.block().getBody());\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","realPath":"spring-boot-project/spring-boot-actuator-autoconfigure/src/test/java/org/springframework/boot/actuate/autoconfigure/health/HealthEndpointAutoConfigurationTests.java","repoName":"springboot","snippetEndLine":0,"snippetStartLine":0,"startLine":246,"status":"B"}],"commitId":"3c535e0de340a718d6cf0d863a6529b314a38f42","commitMessage":"@@@Add HealthContributor and refactor HealthEndpoint\n\nOverhaul `HealthEndpoint` support to make it easier to support health\ngroups. Prior to this commit the `HealthIndicator` interface was used\nfor both regular indicators and composite indicators. In addition the\n`Health` result was used to both represent individual.  system and\ncomposite health. This design unfortunately means that all health\ncontributors need to be aware of the `HealthAggregator` and could not\neasily support heath groups if per-group aggregation is required.\n\nThis commit reworks many aspects of the health support in order to\nprovide a cleaner separation between a `HealthIndicator`and a\ncomposite. The following changes have been made:\n\n- A `HealthContributor` interface has been introduced to represent\n  the general concept of something that contributes health information.\n  A contributor can either be a `HealthIndicator` or a\n  `CompositeHealthContributor`.\n\n- A `HealthComponent` class has been introduced to mirror the\n  contributor arrangement. The component can be either\n  `CompositeHealth` or `Health`.\n\n- The `HealthAggregator` interface has been replaced with a more\n  focused `StatusAggregator` interface which only deals with `Status`\n  results.\n\n- `CompositeHealthIndicator` has been replaced with\n  `CompositeHealthContributor` which only provides access to other\n  contributors. A composite can no longer directly return `Health`.\n\n- `HealthIndicatorRegistry` has been replaced with\n  `HealthContributorRegistry` and the default implementation now\n  uses a copy-on-write strategy.\n\n- `HealthEndpoint`.  `HealthEndpointWebExtension` and\n  `ReactiveHealthEndpointWebExtension` now extend a common\n  `HealthEndpointSupport` class. They are now driven by a\n  health contributor registry and `HealthEndpointSettings`.\n\n- The `HealthStatusHttpMapper` class has been replaced by a\n  `HttpCodeStatusMapper` interface.\n\n- The `HealthWebEndpointResponseMapper` class has been replaced\n  by a `HealthEndpointSettings` strategy. This allows us to move\n  role related logic and `ShowDetails` to the auto-configure module.\n\n- `SimpleHttpCodeStatusMapper` and `SimpleStatusAggregator`\n  implementations have been added which are configured via constructor\n  arguments rather than setters.\n\n- Endpoint auto-configuration has been reworked and the\n  `CompositeHealthIndicatorConfiguration` class has been replaced\n  by `CompositeHealthContributorConfiguration`.\n\n- The endpoint JSON has been changed make `details` distinct from\n  `components`.\n\nSee gh-17926\n","date":"2019-08-22 09:43:25","modifiedFileCount":"75","status":"B","submitter":"Phillip Webb"},{"authorTime":"2019-09-26 13:46:37","codes":[{"authorDate":"2019-09-26 13:46:37","commitOrder":2,"curCode":"\tvoid runCreatesHealthEndpointWebExtension() {\n\t\tthis.contextRunner.run((context) -> {\n\t\t\tHealthEndpointWebExtension webExtension = context.getBean(HealthEndpointWebExtension.class);\n\t\t\tWebEndpointResponse<HealthComponent> response = webExtension.health(ApiVersion.V3, SecurityContext.NONE,\n\t\t\t\t\ttrue, \"simple\");\n\t\t\tHealth health = (Health) response.getBody();\n\t\t\tassertThat(response.getStatus()).isEqualTo(200);\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","date":"2019-09-27 07:16:23","endLine":239,"groupId":"15442","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"runCreatesHealthEndpointWebExtension","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-springboot-10-0.7/blobInfo/CC_OUT/blobs/a8/2e79331b40469e6b3c8eb8fe1bb025c572c271.src","preCode":"\tvoid runCreatesHealthEndpointWebExtension() {\n\t\tthis.contextRunner.run((context) -> {\n\t\t\tHealthEndpointWebExtension webExtension = context.getBean(HealthEndpointWebExtension.class);\n\t\t\tWebEndpointResponse<HealthComponent> response = webExtension.health(SecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) response.getBody();\n\t\t\tassertThat(response.getStatus()).isEqualTo(200);\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","realPath":"spring-boot-project/spring-boot-actuator-autoconfigure/src/test/java/org/springframework/boot/actuate/autoconfigure/health/HealthEndpointAutoConfigurationTests.java","repoName":"springboot","snippetEndLine":0,"snippetStartLine":0,"startLine":230,"status":"M"},{"authorDate":"2019-09-26 13:46:37","commitOrder":2,"curCode":"\tvoid runCreatesReactiveHealthEndpointWebExtension() {\n\t\tthis.reactiveContextRunner.run((context) -> {\n\t\t\tReactiveHealthEndpointWebExtension webExtension = context.getBean(ReactiveHealthEndpointWebExtension.class);\n\t\t\tMono<WebEndpointResponse<? extends HealthComponent>> response = webExtension.health(ApiVersion.V3,\n\t\t\t\t\tSecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) (response.block().getBody());\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","date":"2019-09-27 07:16:23","endLine":260,"groupId":"6264","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"runCreatesReactiveHealthEndpointWebExtension","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-springboot-10-0.7/blobInfo/CC_OUT/blobs/a8/2e79331b40469e6b3c8eb8fe1bb025c572c271.src","preCode":"\tvoid runCreatesReactiveHealthEndpointWebExtension() {\n\t\tthis.reactiveContextRunner.run((context) -> {\n\t\t\tReactiveHealthEndpointWebExtension webExtension = context.getBean(ReactiveHealthEndpointWebExtension.class);\n\t\t\tMono<WebEndpointResponse<? extends HealthComponent>> response = webExtension.health(SecurityContext.NONE,\n\t\t\t\t\ttrue, \"simple\");\n\t\t\tHealth health = (Health) (response.block().getBody());\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","realPath":"spring-boot-project/spring-boot-actuator-autoconfigure/src/test/java/org/springframework/boot/actuate/autoconfigure/health/HealthEndpointAutoConfigurationTests.java","repoName":"springboot","snippetEndLine":0,"snippetStartLine":0,"startLine":252,"status":"M"}],"commitId":"69c561a69a54a32ba31f4bc66e7954ee21e6445f","commitMessage":"@@@Rename health JSON 'details' to 'components' in v3\n\nUpdate the health endpoint so the nested components are now exposed\nunder `components` rather than `details` when v3 of the actuator\nREST API is being used.\n\nThis distinction helps to clarify the difference between composite\nhealth (health composed of other health components) and health\ndetails (technology specific information gathered by the indicator).\n\nSince this is a breaking change for the REST API.  it is only returned\nfor v3 payloads. Requests made accepting only a v2 response will have\nJSON provided in the original form.\n\nCloses gh-17929\n","date":"2019-09-27 07:16:23","modifiedFileCount":"21","status":"M","submitter":"Phillip Webb"},{"authorTime":"2021-07-14 06:13:04","codes":[{"authorDate":"2021-07-14 06:13:04","commitOrder":3,"curCode":"\tvoid runCreatesHealthEndpointWebExtension() {\n\t\tthis.contextRunner.run((context) -> {\n\t\t\tHealthEndpointWebExtension webExtension = context.getBean(HealthEndpointWebExtension.class);\n\t\t\tWebEndpointResponse<HealthComponent> response = webExtension.health(ApiVersion.V3,\n\t\t\t\t\tWebServerNamespace.SERVER, SecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) response.getBody();\n\t\t\tassertThat(response.getStatus()).isEqualTo(200);\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","date":"2021-08-12 10:25:25","endLine":222,"groupId":"10674","id":5,"instanceNumber":1,"isCurCommit":1,"methodName":"runCreatesHealthEndpointWebExtension","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-springboot-10-0.7/blobInfo/CC_OUT/blobs/4f/43c0b95f0d67b2d8d3bf17715b5092dde366b6.src","preCode":"\tvoid runCreatesHealthEndpointWebExtension() {\n\t\tthis.contextRunner.run((context) -> {\n\t\t\tHealthEndpointWebExtension webExtension = context.getBean(HealthEndpointWebExtension.class);\n\t\t\tWebEndpointResponse<HealthComponent> response = webExtension.health(ApiVersion.V3, SecurityContext.NONE,\n\t\t\t\t\ttrue, \"simple\");\n\t\t\tHealth health = (Health) response.getBody();\n\t\t\tassertThat(response.getStatus()).isEqualTo(200);\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","realPath":"spring-boot-project/spring-boot-actuator-autoconfigure/src/test/java/org/springframework/boot/actuate/autoconfigure/health/HealthEndpointAutoConfigurationTests.java","repoName":"springboot","snippetEndLine":0,"snippetStartLine":0,"startLine":213,"status":"M"},{"authorDate":"2021-07-14 06:13:04","commitOrder":3,"curCode":"\tvoid runCreatesReactiveHealthEndpointWebExtension() {\n\t\tthis.reactiveContextRunner.run((context) -> {\n\t\t\tReactiveHealthEndpointWebExtension webExtension = context.getBean(ReactiveHealthEndpointWebExtension.class);\n\t\t\tMono<WebEndpointResponse<? extends HealthComponent>> response = webExtension.health(ApiVersion.V3,\n\t\t\t\t\tWebServerNamespace.SERVER, SecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) (response.block().getBody());\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","date":"2021-08-12 10:25:25","endLine":243,"groupId":"10674","id":6,"instanceNumber":2,"isCurCommit":1,"methodName":"runCreatesReactiveHealthEndpointWebExtension","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-springboot-10-0.7/blobInfo/CC_OUT/blobs/4f/43c0b95f0d67b2d8d3bf17715b5092dde366b6.src","preCode":"\tvoid runCreatesReactiveHealthEndpointWebExtension() {\n\t\tthis.reactiveContextRunner.run((context) -> {\n\t\t\tReactiveHealthEndpointWebExtension webExtension = context.getBean(ReactiveHealthEndpointWebExtension.class);\n\t\t\tMono<WebEndpointResponse<? extends HealthComponent>> response = webExtension.health(ApiVersion.V3,\n\t\t\t\t\tSecurityContext.NONE, true, \"simple\");\n\t\t\tHealth health = (Health) (response.block().getBody());\n\t\t\tassertThat(health.getDetails()).containsEntry(\"counter\", 42);\n\t\t});\n\t}\n","realPath":"spring-boot-project/spring-boot-actuator-autoconfigure/src/test/java/org/springframework/boot/actuate/autoconfigure/health/HealthEndpointAutoConfigurationTests.java","repoName":"springboot","snippetEndLine":0,"snippetStartLine":0,"startLine":235,"status":"M"}],"commitId":"49c86e6e1bef32e21bd2979aabddfcbacbe8ee89","commitMessage":"@@@Allow health groups to be configured at an additional path\n\nCloses gh-25471\n\nCo-authored-by: Phillip Webb <pwebb@vmware.com>\n","date":"2021-08-12 10:25:25","modifiedFileCount":"35","status":"M","submitter":"Madhura Bhave"}]
