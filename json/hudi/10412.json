[{"authorTime":"2021-03-15 16:02:05","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":1,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"B"},{"authorDate":"2021-03-15 16:02:05","commitOrder":1,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, 1, false);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","date":"2021-03-15 16:02:05","endLine":90,"groupId":"4665","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/ee/7774d5617ea73022e17c2c6776f29386929dd5.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, 1, false);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":76,"status":"B"}],"commitId":"fc6c5f4285098d18cd7f6e81785f59e68a3b6862","commitMessage":"@@@[HUDI-1684] Tweak hudi-flink-bundle module pom and reorganize the pacakges for hudi-flink module (#2669)\n\n* Add required dependencies for hudi-flink-bundle module\n* Some packages reorganization of hudi-flink module","date":"2021-03-15 16:02:05","modifiedFileCount":"12","status":"B","submitter":"Danny Chan"},{"authorTime":"2021-03-15 19:42:36","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":2,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-03-15 19:42:36","commitOrder":2,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, 1);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","date":"2021-03-15 19:42:36","endLine":90,"groupId":"4665","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/b8/0ac72b5c4a28e90f7b5744d921762c3743064d.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, 1, false);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":76,"status":"M"}],"commitId":"76bf2cc790edc0be10dfa2454c42687c38e7e5fc","commitMessage":"@@@[HUDI-1692] Bounded source for stream writer (#2674)\n\nSupports bounded source such as VALUES for stream mode writer.","date":"2021-03-15 19:42:36","modifiedFileCount":"9","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-04-06 19:06:41","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":3,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-04-06 19:06:41","commitOrder":3,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","date":"2021-04-06 19:06:41","endLine":94,"groupId":"3507","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/a4/b6c16a30e867a068c82410f65fefead7fc5691.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, 1);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":79,"status":"M"}],"commitId":"9c369c607df2816ea2cd1221fb6d879e3fb8f74c","commitMessage":"@@@[HUDI-1757] Assigns the buckets by record key for Flink writer (#2757)\n\nCurrently we assign the buckets by record partition path which could\ncause hotspot if the partition field is datetime type. Changes to assign\nbuckets by grouping the record whth their key first.  the assignment is\nvalid if only there is no conflict(two task write to the same bucket).\n\nThis patch also changes the coordinator execution to be asynchronous.","date":"2021-04-06 19:06:41","modifiedFileCount":"23","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-06-06 10:40:15","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":4,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-06-06 10:40:15","commitOrder":4,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","date":"2021-06-06 10:40:15","endLine":100,"groupId":"3507","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/74/e43bad05624c2851e02abe45cbc50e1573abac.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":84,"status":"M"}],"commitId":"08464a6a5b11ad2afa98eed7bc4e7777c4121b6b","commitMessage":"@@@[HUDI-1931] BucketAssignFunction use ValueState instead of MapState (#3026)\n\nCo-authored-by: 854194341@qq.com <loukey_7821>","date":"2021-06-06 10:40:15","modifiedFileCount":"6","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-06-08 13:55:25","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":5,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-06-08 13:55:25","commitOrder":5,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","date":"2021-06-08 13:55:25","endLine":107,"groupId":"3507","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/70/5780cdc0d15e539ea9c1da160a34a9997206b9.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":89,"status":"M"}],"commitId":"cf83f10f5b369e1f16e63b4b68750d3ad2dc0240","commitMessage":"@@@add BootstrapFunction to support index bootstrap (#3024)\n\nCo-authored-by: ??? <yuzhaojing@bilibili.com>","date":"2021-06-08 13:55:25","modifiedFileCount":"7","status":"M","submitter":"yuzhaojing"},{"authorTime":"2021-06-18 09:35:09","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":6,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-06-18 09:35:09","commitOrder":6,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","date":"2021-06-18 09:35:09","endLine":112,"groupId":"3507","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e0/a0f4b6e6ba1526fae51ec6fd93bfc4f22d518b.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":93,"status":"M"}],"commitId":"aa6342c3c9af53e7064546becf987e26534d0764","commitMessage":"@@@[HUDI-2036] Move the compaction plan scheduling out of flink writer coordinator (#3101)\n\nSince HUDI-1955 was fixed.  we can move the scheduling out if the\ncoordinator to make the coordinator more lightweight.","date":"2021-06-18 09:35:09","modifiedFileCount":"15","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-07-21 10:13:05","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":7,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-07-21 10:13:05","commitOrder":7,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1, false);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","date":"2021-07-21 10:13:05","endLine":121,"groupId":"4665","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/d1/475bb3d8590a328d8ad760284d9dd3d9fb730a.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"M"}],"commitId":"858e84b5b2f1c5fbd4266922b494ad0d16f5b92a","commitMessage":"@@@[HUDI-2198] Clean and reset the bootstrap events for coordinator when task failover (#3304)\n\n","date":"2021-07-21 10:13:05","modifiedFileCount":"6","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-08-16 18:14:05","codes":[{"authorDate":"2021-03-15 16:02:05","commitOrder":8,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","date":"2021-03-15 16:02:05","endLine":72,"groupId":"3507","id":15,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/e8/796ec7243839f832a6ae72ef02b1c51d6e5e01.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"N"},{"authorDate":"2021-08-16 18:14:05","commitOrder":8,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","date":"2021-08-16 18:14:05","endLine":121,"groupId":"3507","id":16,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/6f/87ef73cee4f3449869d7855f17802f48cf2a01.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1, false);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"M"}],"commitId":"66f951322a3872073b86896fa5c10b51a0f6e4ab","commitMessage":"@@@[HUDI-2191] Bump flink version to 1.13.1 (#3291)\n\n","date":"2021-08-16 18:14:05","modifiedFileCount":"17","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-08-21 20:03:03","codes":[{"authorDate":"2021-08-21 20:03:03","commitOrder":9,"curCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n  }\n","date":"2021-08-21 20:03:03","endLine":72,"groupId":"10412","id":17,"instanceNumber":1,"isCurCommit":0,"methodName":"CompactFunctionWrapper","params":"(Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/d5/3d58ebb1fb3a3029082627fae5898d3bef7c1e.src","preCode":"  public CompactFunctionWrapper(Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.conf = conf;\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/CompactFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":63,"status":"M"},{"authorDate":"2021-08-21 20:03:03","commitOrder":9,"curCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.stateInitializationContext = new MockStateInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.output = new CollectorOutput<>(new ArrayList<>());\n    this.streamConfig = new StreamConfig(conf);\n    streamConfig.setOperatorID(new OperatorID());\n    this.streamTask = new MockStreamTaskBuilder(environment)\n        .setConfig(new StreamConfig(conf))\n        .setExecutionConfig(new ExecutionConfig().enableObjectReuse())\n        .build();\n  }\n","date":"2021-08-21 20:03:03","endLine":140,"groupId":"10412","id":18,"instanceNumber":2,"isCurCommit":0,"methodName":"StreamWriteFunctionWrapper","params":"(StringtablePath@Configurationconf)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/4a/da5172b0a754d4d885255d07d5e753236a09be.src","preCode":"  public StreamWriteFunctionWrapper(String tablePath, Configuration conf) throws Exception {\n    this.ioManager = new IOManagerAsync();\n    MockEnvironment environment = new MockEnvironmentBuilder()\n        .setTaskName(\"mockTask\")\n        .setManagedMemorySize(4 * MemoryManager.DEFAULT_PAGE_SIZE)\n        .setIOManager(ioManager)\n        .build();\n    this.runtimeContext = new MockStreamingRuntimeContext(false, 1, 0, environment);\n    this.gateway = new MockOperatorEventGateway();\n    this.conf = conf;\n    \r\n    this.coordinatorContext = new MockOperatorCoordinatorContext(new OperatorID(), 1);\n    this.coordinator = new StreamWriteOperatorCoordinator(conf, this.coordinatorContext);\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n    this.functionInitializationContext = new MockFunctionInitializationContext();\n    this.compactFunctionWrapper = new CompactFunctionWrapper(this.conf);\n    this.asyncCompaction = StreamerUtil.needsAsyncCompaction(conf);\n    this.bucketAssignOperatorContext = new MockBucketAssignOperatorContext();\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/sink/utils/StreamWriteFunctionWrapper.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":114,"status":"M"}],"commitId":"ab3fbb88950ca351723f2f46da9f40ba325a03b5","commitMessage":"@@@[HUDI-2342] Optimize Bootstrap operator (#3516)\n\nCo-authored-by: ??? <yuzhaojing@bilibili.com>","date":"2021-08-21 20:03:03","modifiedFileCount":"6","status":"M","submitter":"yuzhaojing"}]
