[{"authorTime":"2021-06-08 06:38:59","codes":[{"authorDate":"2021-06-08 06:38:59","commitOrder":1,"curCode":"  public void testUnlock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.unlock();\n    \r\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.close();\n  }\n","date":"2021-06-08 06:38:59","endLine":112,"groupId":"368","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testUnlock","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/8f/5596a4af3f7868f5ac244c921e6e3cc3b70561.src","preCode":"  public void testUnlock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.unlock();\n    \r\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.close();\n  }\n","realPath":"hudi-sync/hudi-hive-sync/src/test/java/org/apache/hudi/hive/functional/TestHiveMetastoreBasedLockProvider.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"B"},{"authorDate":"2021-06-08 06:38:59","commitOrder":1,"curCode":"  public void testReentrantLock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    try {\n      lockProvider.acquireLock(lockConfiguration.getConfig()\n          .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent);\n      Assertions.fail();\n    } catch (IllegalArgumentException e) {\n      \r\n    }\n    lockProvider.unlock();\n  }\n","date":"2021-06-08 06:38:59","endLine":128,"groupId":"3858","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testReentrantLock","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/8f/5596a4af3f7868f5ac244c921e6e3cc3b70561.src","preCode":"  public void testReentrantLock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    try {\n      lockProvider.acquireLock(lockConfiguration.getConfig()\n          .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent);\n      Assertions.fail();\n    } catch (IllegalArgumentException e) {\n      \r\n    }\n    lockProvider.unlock();\n  }\n","realPath":"hudi-sync/hudi-hive-sync/src/test/java/org/apache/hudi/hive/functional/TestHiveMetastoreBasedLockProvider.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":115,"status":"B"}],"commitId":"441076b2ccf66949310030fc6680bb68c259d8da","commitMessage":"@@@[HUDI-1950] Move TestHiveMetastoreBasedLockProvider to functional (#3043)\n\nHiveTestUtil static setup mini servers caused connection refused issue in Azure CI environment.  as TestHiveSyncTool and TestHiveMetastoreBasedLockProvider share the same test facilities. Moving TestHiveMetastoreBasedLockProvider (the easier one) to functional test with a separate and improved mini server setup resolved the issue.\n\nAlso cleaned up dfs cluster from HiveTestUtil.\n\nThe next step is to move TestHiveSyncTool to functional as well.","date":"2021-06-08 06:38:59","modifiedFileCount":"3","status":"B","submitter":"Raymond Xu"},{"authorTime":"2021-07-01 05:26:30","codes":[{"authorDate":"2021-07-01 05:26:30","commitOrder":2,"curCode":"  public void testUnlock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP_KEY), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.unlock();\n    \r\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP_KEY), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.close();\n  }\n","date":"2021-07-01 05:26:30","endLine":112,"groupId":"10368","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testUnlock","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/c8/33b36208a5deab8bb5d34b7c902035e51b85bb.src","preCode":"  public void testUnlock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.unlock();\n    \r\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    lockProvider.close();\n  }\n","realPath":"hudi-sync/hudi-hive-sync/src/test/java/org/apache/hudi/hive/functional/TestHiveMetastoreBasedLockProvider.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":102,"status":"M"},{"authorDate":"2021-07-01 05:26:30","commitOrder":2,"curCode":"  public void testReentrantLock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP_KEY), TimeUnit.MILLISECONDS, lockComponent));\n    try {\n      lockProvider.acquireLock(lockConfiguration.getConfig()\n          .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP_KEY), TimeUnit.MILLISECONDS, lockComponent);\n      Assertions.fail();\n    } catch (IllegalArgumentException e) {\n      \r\n    }\n    lockProvider.unlock();\n  }\n","date":"2021-07-01 05:26:30","endLine":128,"groupId":"10368","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testReentrantLock","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/c8/33b36208a5deab8bb5d34b7c902035e51b85bb.src","preCode":"  public void testReentrantLock() throws Exception {\n    HiveMetastoreBasedLockProvider lockProvider = new HiveMetastoreBasedLockProvider(lockConfiguration, hiveConf());\n    lockComponent.setOperationType(DataOperationType.NO_TXN);\n    Assertions.assertTrue(lockProvider.acquireLock(lockConfiguration.getConfig()\n        .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent));\n    try {\n      lockProvider.acquireLock(lockConfiguration.getConfig()\n          .getLong(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP), TimeUnit.MILLISECONDS, lockComponent);\n      Assertions.fail();\n    } catch (IllegalArgumentException e) {\n      \r\n    }\n    lockProvider.unlock();\n  }\n","realPath":"hudi-sync/hudi-hive-sync/src/test/java/org/apache/hudi/hive/functional/TestHiveMetastoreBasedLockProvider.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":115,"status":"M"}],"commitId":"d412fb2fe642417460532044cac162bb68f4bec4","commitMessage":"@@@[HUDI-89] Add configOption & refactor all configs based on that (#2833)\n\nCo-authored-by: Wenning Ding <wenningd@amazon.com>","date":"2021-07-01 05:26:30","modifiedFileCount":"138","status":"M","submitter":"wenningd"}]
