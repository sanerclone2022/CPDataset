[{"authorTime":"2019-08-12 08:48:17","codes":[{"authorDate":"2019-08-12 08:48:17","commitOrder":1,"curCode":"  public static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String dbName, String user, String pass)\n      throws SQLException {\n    Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n    ResultSet rs = null;\n    Statement stmt = conn.createStatement();\n    try {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + dbName + \".\"\n              + source.getTableConfig().getTableName());\n      long count = -1;\n      if (rs.next()) {\n        count = rs.getLong(\"cnt\");\n      }\n      System.out.println(\"Total records in \" + source.getTableConfig().getTableName() + \" is \" + count);\n      return count;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n      if (stmt != null) {\n        stmt.close();\n      }\n    }\n  }\n","date":"2019-08-12 08:48:17","endLine":84,"groupId":"5721","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"countRecords","params":"(StringjdbcUrl@HoodieTableMetaClientsource@StringdbName@Stringuser@Stringpass)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/97/fd85e9d68470b9e27cffd3a8aaf3d21314a08d.src","preCode":"  public static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String dbName, String user, String pass)\n      throws SQLException {\n    Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n    ResultSet rs = null;\n    Statement stmt = conn.createStatement();\n    try {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + dbName + \".\"\n              + source.getTableConfig().getTableName());\n      long count = -1;\n      if (rs.next()) {\n        count = rs.getLong(\"cnt\");\n      }\n      System.out.println(\"Total records in \" + source.getTableConfig().getTableName() + \" is \" + count);\n      return count;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n      if (stmt != null) {\n        stmt.close();\n      }\n    }\n  }\n","realPath":"hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":58,"status":"B"},{"authorDate":"2019-08-12 08:48:17","commitOrder":1,"curCode":"  private static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String srcDb, String startDateStr,\n      String endDateStr, String user, String pass) throws SQLException {\n    Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n    ResultSet rs = null;\n    Statement stmt = conn.createStatement();\n    try {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + srcDb + \".\" + source.getTableConfig().getTableName()\n              + \" where datestr>'\" + startDateStr + \"' and datestr<='\" + endDateStr + \"'\");\n      if (rs.next()) {\n        return rs.getLong(\"cnt\");\n      }\n      return -1;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n      if (stmt != null) {\n        stmt.close();\n      }\n    }\n  }\n","date":"2019-08-12 08:48:17","endLine":122,"groupId":"5722","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"countRecords","params":"(StringjdbcUrl@HoodieTableMetaClientsource@StringsrcDb@StringstartDateStr@StringendDateStr@Stringuser@Stringpass)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/97/fd85e9d68470b9e27cffd3a8aaf3d21314a08d.src","preCode":"  private static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String srcDb, String startDateStr,\n      String endDateStr, String user, String pass) throws SQLException {\n    Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n    ResultSet rs = null;\n    Statement stmt = conn.createStatement();\n    try {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + srcDb + \".\" + source.getTableConfig().getTableName()\n              + \" where datestr>'\" + startDateStr + \"' and datestr<='\" + endDateStr + \"'\");\n      if (rs.next()) {\n        return rs.getLong(\"cnt\");\n      }\n      return -1;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n      if (stmt != null) {\n        stmt.close();\n      }\n    }\n  }\n","realPath":"hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":98,"status":"B"}],"commitId":"a4f9d7575f39bb79089714049ffea12ba5f25ec8","commitMessage":"@@@HUDI-123 Rename code packages/constants to org.apache.hudi (#830)\n\n- Rename com.uber.hoodie to org.apache.hudi\n- Flag to pass com.uber.hoodie Input formats for hoodie-sync\n- Works with HUDI demo. \n- Also tested for backwards compatibility with datasets built by com.uber.hoodie packages\n- Migration guide : https://cwiki.apache.org/confluence/display/HUDI/Migration+Guide+From+com.uber.hoodie+to+org.apache.hudi","date":"2019-08-12 08:48:17","modifiedFileCount":"0","status":"B","submitter":"Balaji Varadarajan"},{"authorTime":"2020-03-31 21:19:32","codes":[{"authorDate":"2020-03-31 21:19:32","commitOrder":2,"curCode":"  public static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String dbName, String user, String pass)\n      throws SQLException {\n    ResultSet rs = null;\n    try (Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n         Statement stmt = conn.createStatement()) {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + dbName + \".\" + source.getTableConfig().getTableName());\n      long count = -1;\n      if (rs.next()) {\n        count = rs.getLong(\"cnt\");\n      }\n      System.out.println(\"Total records in \" + source.getTableConfig().getTableName() + \" is \" + count);\n      return count;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n    }\n  }\n","date":"2020-03-31 21:19:32","endLine":71,"groupId":"11105","id":3,"instanceNumber":1,"isCurCommit":1,"methodName":"countRecords","params":"(StringjdbcUrl@HoodieTableMetaClientsource@StringdbName@Stringuser@Stringpass)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/37/f705ebbe7bc95c54f8c04763880d87e326a7db.src","preCode":"  public static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String dbName, String user, String pass)\n      throws SQLException {\n    Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n    ResultSet rs = null;\n    Statement stmt = conn.createStatement();\n    try {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + dbName + \".\" + source.getTableConfig().getTableName());\n      long count = -1;\n      if (rs.next()) {\n        count = rs.getLong(\"cnt\");\n      }\n      System.out.println(\"Total records in \" + source.getTableConfig().getTableName() + \" is \" + count);\n      return count;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n      if (stmt != null) {\n        stmt.close();\n      }\n    }\n  }\n","realPath":"hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":50,"status":"M"},{"authorDate":"2020-03-31 21:19:32","commitOrder":2,"curCode":"  private static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String srcDb, String startDateStr,\n      String endDateStr, String user, String pass) throws SQLException {\n    ResultSet rs = null;\n    try (Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n         Statement stmt = conn.createStatement()) {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + srcDb + \".\" + source.getTableConfig().getTableName()\n              + \" where datestr>'\" + startDateStr + \"' and datestr<='\" + endDateStr + \"'\");\n      if (rs.next()) {\n        return rs.getLong(\"cnt\");\n      }\n      return -1;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n    }\n  }\n","date":"2020-03-31 21:19:32","endLine":105,"groupId":"11105","id":4,"instanceNumber":2,"isCurCommit":1,"methodName":"countRecords","params":"(StringjdbcUrl@HoodieTableMetaClientsource@StringsrcDb@StringstartDateStr@StringendDateStr@Stringuser@Stringpass)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/37/f705ebbe7bc95c54f8c04763880d87e326a7db.src","preCode":"  private static long countRecords(String jdbcUrl, HoodieTableMetaClient source, String srcDb, String startDateStr,\n      String endDateStr, String user, String pass) throws SQLException {\n    Connection conn = HiveUtil.getConnection(jdbcUrl, user, pass);\n    ResultSet rs = null;\n    Statement stmt = conn.createStatement();\n    try {\n      \r\n      stmt.execute(\"set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat\");\n      stmt.execute(\"set hive.stats.autogather=false\");\n      rs = stmt.executeQuery(\n          \"select count(`_hoodie_commit_time`) as cnt from \" + srcDb + \".\" + source.getTableConfig().getTableName()\n              + \" where datestr>'\" + startDateStr + \"' and datestr<='\" + endDateStr + \"'\");\n      if (rs.next()) {\n        return rs.getLong(\"cnt\");\n      }\n      return -1;\n    } finally {\n      if (rs != null) {\n        rs.close();\n      }\n      if (stmt != null) {\n        stmt.close();\n      }\n    }\n  }\n","realPath":"hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":85,"status":"M"}],"commitId":"78b3194e8241c519a85310997f31b2b55df487e1","commitMessage":"@@@[HUDI-751] Fix some coding issues reported by FindBugs (#1470)\n\n","date":"2020-03-31 21:19:32","modifiedFileCount":"31","status":"M","submitter":"Shaofeng Shi"}]
