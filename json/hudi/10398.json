[{"authorTime":"2021-08-10 20:23:23","codes":[{"authorDate":"2021-08-10 20:23:23","commitOrder":1,"curCode":"  void testReadWithDeletesCOW() throws Exception {\n    beforeEach(HoodieTableType.COPY_ON_WRITE);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(CopyOnWriteInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result, true);\n    final String expected = \"[\"\n        + \"+I(id1,Danny,24,1970-01-01T00:00:00.001,par1), \"\n        + \"+I(id2,Stephen,34,1970-01-01T00:00:00.002,par1)]\";\n    assertThat(actual, is(expected));\n  }\n","date":"2021-08-10 20:23:23","endLine":265,"groupId":"1004","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testReadWithDeletesCOW","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/55/359451e3b391d4550fcd4745f3cc2f81809671.src","preCode":"  void testReadWithDeletesCOW() throws Exception {\n    beforeEach(HoodieTableType.COPY_ON_WRITE);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(CopyOnWriteInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result, true);\n    final String expected = \"[\"\n        + \"+I(id1,Danny,24,1970-01-01T00:00:00.001,par1), \"\n        + \"+I(id2,Stephen,34,1970-01-01T00:00:00.002,par1)]\";\n    assertThat(actual, is(expected));\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/table/format/TestInputFormat.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":249,"status":"B"},{"authorDate":"2021-08-10 20:23:23","commitOrder":1,"curCode":"  void testReadChangesUnMergedMOR() throws Exception {\n    Map<String, String> options = new HashMap<>();\n    options.put(FlinkOptions.CHANGELOG_ENABLED.key(), \"true\");\n    beforeEach(HoodieTableType.MERGE_ON_READ, options);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_INSERT_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(MergeOnReadInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result, true);\n    final String expected = \"[\"\n        + \"+I(id1,Danny,19,1970-01-01T00:00:00.001,par1), \"\n        + \"-U(id1,Danny,19,1970-01-01T00:00:00.001,par1), \"\n        + \"+U(id1,Danny,20,1970-01-01T00:00:00.002,par1), \"\n        + \"-U(id1,Danny,20,1970-01-01T00:00:00.002,par1), \"\n        + \"+U(id1,Danny,21,1970-01-01T00:00:00.003,par1), \"\n        + \"-U(id1,Danny,21,1970-01-01T00:00:00.003,par1), \"\n        + \"+U(id1,Danny,22,1970-01-01T00:00:00.004,par1), \"\n        + \"-D(id1,Danny,22,1970-01-01T00:00:00.005,par1)]\";\n    assertThat(actual, is(expected));\n  }\n","date":"2021-08-10 20:23:23","endLine":312,"groupId":"1004","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testReadChangesUnMergedMOR","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/55/359451e3b391d4550fcd4745f3cc2f81809671.src","preCode":"  void testReadChangesUnMergedMOR() throws Exception {\n    Map<String, String> options = new HashMap<>();\n    options.put(FlinkOptions.CHANGELOG_ENABLED.key(), \"true\");\n    beforeEach(HoodieTableType.MERGE_ON_READ, options);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_INSERT_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(MergeOnReadInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result, true);\n    final String expected = \"[\"\n        + \"+I(id1,Danny,19,1970-01-01T00:00:00.001,par1), \"\n        + \"-U(id1,Danny,19,1970-01-01T00:00:00.001,par1), \"\n        + \"+U(id1,Danny,20,1970-01-01T00:00:00.002,par1), \"\n        + \"-U(id1,Danny,20,1970-01-01T00:00:00.002,par1), \"\n        + \"+U(id1,Danny,21,1970-01-01T00:00:00.003,par1), \"\n        + \"-U(id1,Danny,21,1970-01-01T00:00:00.003,par1), \"\n        + \"+U(id1,Danny,22,1970-01-01T00:00:00.004,par1), \"\n        + \"-D(id1,Danny,22,1970-01-01T00:00:00.005,par1)]\";\n    assertThat(actual, is(expected));\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/table/format/TestInputFormat.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":288,"status":"B"}],"commitId":"21db6d7a84d4a83ec98c110e92ff9c92d05dd530","commitMessage":"@@@[HUDI-1771] Propagate CDC format for hoodie (#3285)\n\n","date":"2021-08-10 20:23:23","modifiedFileCount":"47","status":"B","submitter":"swuferhong"},{"authorTime":"2021-08-16 18:14:05","codes":[{"authorDate":"2021-08-16 18:14:05","commitOrder":2,"curCode":"  void testReadWithDeletesCOW() throws Exception {\n    beforeEach(HoodieTableType.COPY_ON_WRITE);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(CopyOnWriteInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result);\n    final String expected = \"[\"\n        + \"+I[id1, Danny, 24, 1970-01-01T00:00:00.001, par1], \"\n        + \"+I[id2, Stephen, 34, 1970-01-01T00:00:00.002, par1]]\";\n    assertThat(actual, is(expected));\n  }\n","date":"2021-08-16 18:14:05","endLine":304,"groupId":"1004","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testReadWithDeletesCOW","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/cc/0699fc521d684c4dbc8cb476168b4bdb8db0bc.src","preCode":"  void testReadWithDeletesCOW() throws Exception {\n    beforeEach(HoodieTableType.COPY_ON_WRITE);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(CopyOnWriteInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result, true);\n    final String expected = \"[\"\n        + \"+I(id1,Danny,24,1970-01-01T00:00:00.001,par1), \"\n        + \"+I(id2,Stephen,34,1970-01-01T00:00:00.002,par1)]\";\n    assertThat(actual, is(expected));\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/table/format/TestInputFormat.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":288,"status":"M"},{"authorDate":"2021-08-16 18:14:05","commitOrder":2,"curCode":"  void testReadChangesUnMergedMOR() throws Exception {\n    Map<String, String> options = new HashMap<>();\n    options.put(FlinkOptions.CHANGELOG_ENABLED.key(), \"true\");\n    beforeEach(HoodieTableType.MERGE_ON_READ, options);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_INSERT_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(MergeOnReadInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result);\n    final String expected = \"[\"\n        + \"+I[id1, Danny, 19, 1970-01-01T00:00:00.001, par1], \"\n        + \"-U[id1, Danny, 19, 1970-01-01T00:00:00.001, par1], \"\n        + \"+U[id1, Danny, 20, 1970-01-01T00:00:00.002, par1], \"\n        + \"-U[id1, Danny, 20, 1970-01-01T00:00:00.002, par1], \"\n        + \"+U[id1, Danny, 21, 1970-01-01T00:00:00.003, par1], \"\n        + \"-U[id1, Danny, 21, 1970-01-01T00:00:00.003, par1], \"\n        + \"+U[id1, Danny, 22, 1970-01-01T00:00:00.004, par1], \"\n        + \"-D[id1, Danny, 22, 1970-01-01T00:00:00.005, par1]]\";\n    assertThat(actual, is(expected));\n  }\n","date":"2021-08-16 18:14:05","endLine":353,"groupId":"1004","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testReadChangesUnMergedMOR","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/cc/0699fc521d684c4dbc8cb476168b4bdb8db0bc.src","preCode":"  void testReadChangesUnMergedMOR() throws Exception {\n    Map<String, String> options = new HashMap<>();\n    options.put(FlinkOptions.CHANGELOG_ENABLED.key(), \"true\");\n    beforeEach(HoodieTableType.MERGE_ON_READ, options);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_INSERT_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(MergeOnReadInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result, true);\n    final String expected = \"[\"\n        + \"+I(id1,Danny,19,1970-01-01T00:00:00.001,par1), \"\n        + \"-U(id1,Danny,19,1970-01-01T00:00:00.001,par1), \"\n        + \"+U(id1,Danny,20,1970-01-01T00:00:00.002,par1), \"\n        + \"-U(id1,Danny,20,1970-01-01T00:00:00.002,par1), \"\n        + \"+U(id1,Danny,21,1970-01-01T00:00:00.003,par1), \"\n        + \"-U(id1,Danny,21,1970-01-01T00:00:00.003,par1), \"\n        + \"+U(id1,Danny,22,1970-01-01T00:00:00.004,par1), \"\n        + \"-D(id1,Danny,22,1970-01-01T00:00:00.005,par1)]\";\n    assertThat(actual, is(expected));\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/table/format/TestInputFormat.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":329,"status":"M"}],"commitId":"66f951322a3872073b86896fa5c10b51a0f6e4ab","commitMessage":"@@@[HUDI-2191] Bump flink version to 1.13.1 (#3291)\n\n","date":"2021-08-16 18:14:05","modifiedFileCount":"17","status":"M","submitter":"Danny Chan"},{"authorTime":"2021-08-21 07:21:35","codes":[{"authorDate":"2021-08-16 18:14:05","commitOrder":3,"curCode":"  void testReadWithDeletesCOW() throws Exception {\n    beforeEach(HoodieTableType.COPY_ON_WRITE);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(CopyOnWriteInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result);\n    final String expected = \"[\"\n        + \"+I[id1, Danny, 24, 1970-01-01T00:00:00.001, par1], \"\n        + \"+I[id2, Stephen, 34, 1970-01-01T00:00:00.002, par1]]\";\n    assertThat(actual, is(expected));\n  }\n","date":"2021-08-16 18:14:05","endLine":304,"groupId":"10398","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testReadWithDeletesCOW","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/cc/0699fc521d684c4dbc8cb476168b4bdb8db0bc.src","preCode":"  void testReadWithDeletesCOW() throws Exception {\n    beforeEach(HoodieTableType.COPY_ON_WRITE);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(CopyOnWriteInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result);\n    final String expected = \"[\"\n        + \"+I[id1, Danny, 24, 1970-01-01T00:00:00.001, par1], \"\n        + \"+I[id2, Stephen, 34, 1970-01-01T00:00:00.002, par1]]\";\n    assertThat(actual, is(expected));\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/table/format/TestInputFormat.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":288,"status":"N"},{"authorDate":"2021-08-21 07:21:35","commitOrder":3,"curCode":"  void testReadChangesUnMergedMOR() throws Exception {\n    Map<String, String> options = new HashMap<>();\n    options.put(FlinkOptions.CHANGELOG_ENABLED.key(), \"true\");\n    options.put(FlinkOptions.READ_AS_STREAMING.key(), \"true\");\n    beforeEach(HoodieTableType.MERGE_ON_READ, options);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_INSERT_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(MergeOnReadInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result);\n    \r\n    final String expected = \"[\"\n        + \"+I[id1, Danny, 19, 1970-01-01T00:00:00.001, par1], \"\n        + \"-U[id1, Danny, 19, 1970-01-01T00:00:00.001, par1], \"\n        + \"+U[id1, Danny, 20, 1970-01-01T00:00:00.002, par1], \"\n        + \"-U[id1, Danny, 20, 1970-01-01T00:00:00.002, par1], \"\n        + \"+U[id1, Danny, 21, 1970-01-01T00:00:00.003, par1], \"\n        + \"-U[id1, Danny, 21, 1970-01-01T00:00:00.003, par1], \"\n        + \"+U[id1, Danny, 22, 1970-01-01T00:00:00.004, par1], \"\n        + \"-D[id1, Danny, 22, 1970-01-01T00:00:00.005, par1]]\";\n    assertThat(actual, is(expected));\n  }\n","date":"2021-08-21 07:21:35","endLine":386,"groupId":"10398","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testReadChangesUnMergedMOR","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-hudi-10-0.7/blobInfo/CC_OUT/blobs/f8/3b2d991c1eadb6df005daef0d7d7500c188bf2.src","preCode":"  void testReadChangesUnMergedMOR() throws Exception {\n    Map<String, String> options = new HashMap<>();\n    options.put(FlinkOptions.CHANGELOG_ENABLED.key(), \"true\");\n    beforeEach(HoodieTableType.MERGE_ON_READ, options);\n\n    \r\n    TestData.writeData(TestData.DATA_SET_INSERT_UPDATE_DELETE, conf);\n\n    InputFormat<RowData, ?> inputFormat = this.tableSource.getInputFormat();\n    assertThat(inputFormat, instanceOf(MergeOnReadInputFormat.class));\n\n    List<RowData> result = readData(inputFormat);\n\n    final String actual = TestData.rowDataToString(result);\n    final String expected = \"[\"\n        + \"+I[id1, Danny, 19, 1970-01-01T00:00:00.001, par1], \"\n        + \"-U[id1, Danny, 19, 1970-01-01T00:00:00.001, par1], \"\n        + \"+U[id1, Danny, 20, 1970-01-01T00:00:00.002, par1], \"\n        + \"-U[id1, Danny, 20, 1970-01-01T00:00:00.002, par1], \"\n        + \"+U[id1, Danny, 21, 1970-01-01T00:00:00.003, par1], \"\n        + \"-U[id1, Danny, 21, 1970-01-01T00:00:00.003, par1], \"\n        + \"+U[id1, Danny, 22, 1970-01-01T00:00:00.004, par1], \"\n        + \"-D[id1, Danny, 22, 1970-01-01T00:00:00.005, par1]]\";\n    assertThat(actual, is(expected));\n  }\n","realPath":"hudi-flink/src/test/java/org/apache/hudi/table/format/TestInputFormat.java","repoName":"hudi","snippetEndLine":0,"snippetStartLine":0,"startLine":360,"status":"M"}],"commitId":"c7c517f14c3fb5260fa7f3abca5d50a299870b38","commitMessage":"@@@[HUDI-2340] Merge the data set for flink bounded source when changelog mode turns off (#3513)\n\n","date":"2021-08-21 07:21:35","modifiedFileCount":"4","status":"M","submitter":"Danny Chan"}]
