[{"authorTime":"2018-08-31 00:56:26","codes":[{"authorDate":"2018-08-31 00:56:26","commitOrder":1,"curCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(Column.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2018-08-31 00:56:26","endLine":72,"groupId":"15976","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/15/40ce88d8efe99e414f235ed116f7c68dd21eaa.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(Column.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":60,"status":"B"},{"authorDate":"2018-08-31 00:56:26","commitOrder":1,"curCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(Column.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2018-08-31 00:56:26","endLine":72,"groupId":"15976","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/99/d7e0de2b38bd6e4002c7b28b9302c8e7b562fd.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(Column.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":60,"status":"B"}],"commitId":"431d3d8497f9079857c3baa7ae7ab4cb44a22355","commitMessage":"@@@Rename io.druid to org.apache.druid. (#6266)\n\n* Rename io.druid to org.apache.druid.\n\n* Fix META-INF files and remove some benchmark results.\n\n* MonitorsConfig update for metrics package migration.\n\n* Reorder some dimensions in inner queries for some reason.\n\n* Fix protobuf tests.\n","date":"2018-08-31 00:56:26","modifiedFileCount":"5","status":"B","submitter":"Gian Merlino"},{"authorTime":"2018-10-03 01:50:22","codes":[{"authorDate":"2018-10-03 01:50:22","commitOrder":2,"curCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2018-10-03 01:50:22","endLine":72,"groupId":"19448","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/c4/ae2671bd84255a798afc54af2f3ab73e43b43d.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(Column.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":60,"status":"M"},{"authorDate":"2018-10-03 01:50:22","commitOrder":2,"curCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2018-10-03 01:50:22","endLine":72,"groupId":"19448","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/2e/22f9cfcf7ca7ce91e49c10d7195d69c0680827.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(Column.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":60,"status":"M"}],"commitId":"3ae563263a23000560749071d262727d47296856","commitMessage":"@@@Renamed 'Generic Column' -> 'Numeric Column'; Fixed a few resource leaks in processing; misc refinements (#5957)\n\nThis PR accumulates many refactorings and small improvements that I did while preparing the next change set of https://github.com/druid-io/druid/projects/2. I finally decided to make them a separate PR to minimize the volume of the main PR.\n\nSome of the changes:\n - Renamed confusing \"Generic Column\" term to \"Numeric Column\" (what it actually implies) in many class names.\n - Generified `ComplexMetricExtractor`","date":"2018-10-03 01:50:22","modifiedFileCount":"776","status":"M","submitter":"Roman Leventov"},{"authorTime":"2018-10-03 01:50:22","codes":[{"authorDate":"2019-11-08 09:46:59","commitOrder":3,"curCode":"  public void setup()\n  {\n    stringFirstAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringFirstAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2019-11-08 09:46:59","endLine":72,"groupId":"19448","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/19/0c3435885b7d8321dca5633045d5474cc332fb.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":60,"status":"M"},{"authorDate":"2018-10-03 01:50:22","commitOrder":3,"curCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2018-10-03 01:50:22","endLine":72,"groupId":"19448","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/2e/22f9cfcf7ca7ce91e49c10d7195d69c0680827.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":60,"status":"N"}],"commitId":"c204d6837613ef2a36eb093707e66db78407311b","commitMessage":"@@@Fixes.  adjustments to numeric null handling and string first/last aggregators. (#8834)\n\nThere is a class of bugs due to the fact that BaseObjectColumnValueSelector\nhas both \"getObject\" and \"isNull\" methods.  but in most selector implementations\nand most call sites.  it is clear that the intent of \"isNull\" is only to apply\nto the primitive getters.  not the object getter. This makes sense.  because the\npurpose of isNull is to enable detection of nulls in otherwise-primitive columns.\nImagine a string column with a numeric selector built on top of it. You would\nwant it to return isNull = true.  so numeric aggregators don't treat it as\nall zeroes.\n\nSometimes this design leads people to accidentally guard non-primitive get\nmethods with \"selector.isNull\" checks.  which is improper.\n\nThis patch has three goals:\n\n1) Fix null-handling bugs that already exist in this class.\n2) Make interface and doc changes that reduce the probability of future bugs.\n3) Fix other.  unrelated bugs I noticed in the stringFirst and stringLast\n   aggregators while fixing null-handling bugs. I thought about splitting this\n   into its own patch.  but it ended up being tough to split from the\n   null-handling fixes.\n\nFor (1) the fixes are. \n\n- Fix StringFirst and StringLastAggregatorFactory to stop guarding getObject\n  calls on isNull.  by no longer extending NullableAggregatorFactory. Now uses\n  -1 as a sigil value for null.  to differentiate nulls and empty strings.\n- Fix ExpressionFilter to stop guarding getObject calls on isNull. Also.  use\n  eval.asBoolean() to avoid calling getLong on the selector after already\n  calling getObject.\n- Fix ObjectBloomFilterAggregator to stop guarding DimensionSelector calls\n  on isNull. Also.  refactored slightly to avoid the overhead of calling\n  getObject followed by another getter (see BloomFilterAggregatorFactory for\n  part of this).\n\nFor (2) the main changes are. \n\n- Remove the \"isNull\" method from BaseObjectColumnValueSelector.\n- Clarify \"isNull\" doc on BaseNullableColumnValueSelector.\n- Rename NullableAggregatorFactory -> NullbleNumericAggregatorFactory to emphasize\n  that it only works on aggregators that take numbers as input.\n- Similar naming changes to the Aggregator.  BufferAggregator.  and AggregateCombiner.\n- Similar naming changes to helper methods for groupBy.  ValueMatchers.  etc.\n\nFor (3) the other fixes for StringFirst and StringLastAggregatorFactory are. \n\n- Fixed buffer overrun in the buffer aggregators when some characters in the string\n  code into more than one byte (the old code used \"substring\" to apply a byte limit. \n  which is bad). I did this by introducing a new StringUtils.toUtf8WithLimit method.\n- Fixed weird IncrementalIndex logic that led to reading nulls for the timestamp.\n- Adjusted weird StringFirst/Last logic that worked around the weird IncrementalIndex\n  behavior.\n- Refactored to share code between the four aggregators.\n- Improved test coverage.\n- Made the base stringFirst.  stringLast aggregators adaptive.  and streamlined the\n  xFold versions into aliases. The adaptiveness is similar to how other aggregators\n  like hyperUnique work.","date":"2019-11-08 09:46:59","modifiedFileCount":"45","status":"M","submitter":"Gian Merlino"},{"authorTime":"2020-01-17 13:02:02","codes":[{"authorDate":"2020-01-17 13:02:02","commitOrder":4,"curCode":"  public void setup()\n  {\n    stringFirstAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringFirstAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"nilly\"))\n            .andReturn(new ColumnCapabilitiesImpl().setType(ValueType.STRING));\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"billy\")).andReturn(null);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2020-01-17 13:02:02","endLine":77,"groupId":"19448","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/0e/450d32c37d8c3f4b93a3be0a09b26ea3b6efdd.src","preCode":"  public void setup()\n  {\n    stringFirstAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringFirstAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"M"},{"authorDate":"2020-01-17 13:02:02","commitOrder":4,"curCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"nilly\"))\n            .andReturn(new ColumnCapabilitiesImpl().setType(ValueType.STRING));\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"billy\")).andReturn(null);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2020-01-17 13:02:02","endLine":77,"groupId":"19448","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/39/f9925606ed5a8c8918d4be077ace2b3d1b55c7.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":62,"status":"M"}],"commitId":"448da787654ef6ebcab7bb5cba340b931c454320","commitMessage":"@@@Speed up String first/last aggregators when folding isn't needed. (#9181)\n\n* Speed up String first/last aggregators when folding isn't needed.\n\nExamines the value column.  and disables fold checking via a needsFoldCheck\nflag if that column can't possibly contain SerializableLongStringPairs. This\nis helpful because it avoids calling getObject on the value selector when\nunnecessary; say.  because the time selector didn't yield an earlier or later\nvalue.\n\n* PR comments.\n\n* Move fastLooseChop to StringUtils.\n","date":"2020-01-17 13:02:02","modifiedFileCount":"13","status":"M","submitter":"Gian Merlino"},{"authorTime":"2020-09-09 08:36:04","codes":[{"authorDate":"2020-09-09 08:36:04","commitOrder":5,"curCode":"  public void setup()\n  {\n    NullHandling.initializeForTests();\n    stringFirstAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringFirstAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"nilly\"))\n            .andReturn(new ColumnCapabilitiesImpl().setType(ValueType.STRING));\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"billy\")).andReturn(null);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2020-09-09 08:36:04","endLine":80,"groupId":"107058","id":9,"instanceNumber":1,"isCurCommit":1,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/85/4cdbf9b1fd5bf3cbd11744b8f54993cc7528d1.src","preCode":"  public void setup()\n  {\n    stringFirstAggFactory = new StringFirstAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringFirstAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"nilly\"))\n            .andReturn(new ColumnCapabilitiesImpl().setType(ValueType.STRING));\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"billy\")).andReturn(null);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":64,"status":"M"},{"authorDate":"2020-09-09 08:36:04","commitOrder":5,"curCode":"  public void setup()\n  {\n    NullHandling.initializeForTests();\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"nilly\"))\n            .andReturn(new ColumnCapabilitiesImpl().setType(ValueType.STRING));\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"billy\")).andReturn(null);\n    EasyMock.replay(colSelectorFactory);\n  }\n","date":"2020-09-09 08:36:04","endLine":79,"groupId":"107058","id":10,"instanceNumber":2,"isCurCommit":1,"methodName":"setup","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/db/d2522634e9849c40b6e8674a10bba20bf5f259.src","preCode":"  public void setup()\n  {\n    stringLastAggFactory = new StringLastAggregatorFactory(\"billy\", \"nilly\", MAX_STRING_SIZE);\n    combiningAggFactory = stringLastAggFactory.getCombiningFactory();\n    timeSelector = new TestLongColumnSelector(times);\n    valueSelector = new TestObjectColumnSelector<>(strings);\n    objectSelector = new TestObjectColumnSelector<>(pairs);\n    colSelectorFactory = EasyMock.createMock(ColumnSelectorFactory.class);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(ColumnHolder.TIME_COLUMN_NAME)).andReturn(timeSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"nilly\")).andReturn(valueSelector);\n    EasyMock.expect(colSelectorFactory.makeColumnValueSelector(\"billy\")).andReturn(objectSelector);\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"nilly\"))\n            .andReturn(new ColumnCapabilitiesImpl().setType(ValueType.STRING));\n    EasyMock.expect(colSelectorFactory.getColumnCapabilities(\"billy\")).andReturn(null);\n    EasyMock.replay(colSelectorFactory);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastAggregationTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":63,"status":"M"}],"commitId":"e5f0da30ae15369f66c7e9ecc05a41c3d49eb2e6","commitMessage":"@@@Fix stringFirst/stringLast rollup during ingestion (#10332)\n\n* Add IndexMergerRollupTest\n\nThis changelist adds a test to merge indexes with StringFirst/StringLast aggregator.\n\n* Fix StringFirstAggregateCombiner/StringLastAggregateCombiner\n\nThe segment-level type for stringFirst/stringLast is SerializablePairLongString. \nnot String. This changelist fixes it.\n\n* Fix EarliestLatestAnySqlAggregator to handle COMPLEX type\n\nThis changelist allows EarliestLatestAnySqlAggregator to accept COMPLEX\ntype as an operand. For its return type.  we set it to VARCHAR.  since\nCOMPLEX column is only generated by stringFirst/stringLast during ingestion\nrollup.\n\n* Return value with smaller timestamp in StringFirstAggregatorFactory.combine function\n\n* Add integration tests for stringFirst/stringLast during ingestion\n\n* Use one EarliestLatestReturnTypeInference instance\n\nCo-authored-by: Joy Kent <joy@automonic.ai>","date":"2020-09-09 08:36:04","modifiedFileCount":"6","status":"M","submitter":"Joy Kent"}]
