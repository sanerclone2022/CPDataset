[{"authorTime":"2020-02-08 08:23:37","codes":[{"authorDate":"2020-02-08 08:23:37","commitOrder":1,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        originalFilter\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","date":"2020-02-08 08:23:37","endLine":922,"groupId":"17100","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/16/ee7173c4a42306526783d9c9f9b64b1401e274.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        originalFilter\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":872,"status":"B"},{"authorDate":"2020-02-08 08:23:37","commitOrder":1,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        filter\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","date":"2020-02-08 08:23:37","endLine":1135,"groupId":"17103","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/16/ee7173c4a42306526783d9c9f9b64b1401e274.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        filter\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1085,"status":"B"}],"commitId":"ad8afc565c631c826bb1db0ebac611398a7ec9f3","commitMessage":"@@@Join filter pushdown initial implementation (#9301)\n\n* Join filter pushdown initial implementation\n\n* Fix test and spotbugs check\n\n* Address PR comments\n\n* More PR comments\n\n* Address some PR comments\n\n* Address more PR comments\n\n* Fix TC failures and address PR comments\n","date":"2020-02-08 08:23:37","modifiedFileCount":"18","status":"B","submitter":"Jonathan Wei"},{"authorTime":"2020-02-12 07:31:34","codes":[{"authorDate":"2020-02-12 07:31:34","commitOrder":2,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        originalFilter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","date":"2020-02-12 07:31:34","endLine":933,"groupId":"17100","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/78/c057fcbd0ec20954ed0e52321f0d0511ffc669.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        originalFilter\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":882,"status":"M"},{"authorDate":"2020-02-12 07:31:34","commitOrder":2,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        filter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","date":"2020-02-12 07:31:34","endLine":1150,"groupId":"17103","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/78/c057fcbd0ec20954ed0e52321f0d0511ffc669.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        filter\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1099,"status":"M"}],"commitId":"b2c00b3a791555e35d2ac92d35e02aafe5c09721","commitMessage":"@@@Add query context option to disable join filter push down (#9335)\n\n","date":"2020-02-12 07:31:34","modifiedFileCount":"12","status":"M","submitter":"Jonathan Wei"},{"authorTime":"2020-02-20 07:51:05","codes":[{"authorDate":"2020-02-20 07:51:05","commitOrder":3,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        originalFilter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","date":"2020-02-20 07:51:05","endLine":999,"groupId":"17100","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/05/b93de68929ee0591ef0aee2b43359781aaa864.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        originalFilter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":947,"status":"M"},{"authorDate":"2020-02-20 07:51:05","commitOrder":3,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        filter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","date":"2020-02-20 07:51:05","endLine":1220,"groupId":"17103","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/05/b93de68929ee0591ef0aee2b43359781aaa864.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        filter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1168,"status":"M"}],"commitId":"cab08f941d28266a65a39bd62e7e9487067573b1","commitMessage":"@@@Fix join filter push down post-join virtual column handling (#9373)\n\n* Fix join filter push down post-join virtual column handling\n\n* Remove unused adapter param.  update javadocs\n\n* Fix TC\n\n* Update processing/src/main/java/org/apache/druid/segment/join/filter/JoinFilterAnalyzer.java\n\nCo-Authored-By: Suneet Saldanha <44787917+suneet-s@users.noreply.github.com>\n\n* Address PR comments\n\nCo-authored-by: Suneet Saldanha <44787917+suneet-s@users.noreply.github.com>\n","date":"2020-02-20 07:51:05","modifiedFileCount":"3","status":"M","submitter":"Jonathan Wei"},{"authorTime":"2020-03-10 08:36:07","codes":[{"authorDate":"2020-03-10 08:36:07","commitOrder":4,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        originalFilter,\n        true,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","date":"2020-03-10 08:36:07","endLine":1011,"groupId":"17100","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/22/41452f8c9fe4adfc64ba3f9e3a025c417d5679.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        originalFilter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":958,"status":"M"},{"authorDate":"2020-03-10 08:36:07","commitOrder":4,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        filter,\n        true,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","date":"2020-03-10 08:36:07","endLine":1236,"groupId":"17103","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/22/41452f8c9fe4adfc64ba3f9e3a025c417d5679.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        filter,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1183,"status":"M"}],"commitId":"0136dba95d5271027b2ee0d0266a8a66fe88d4ca","commitMessage":"@@@Add option to control join filter rewrites (#9472)\n\n* Add option to control join filter rewrites\n\n* Fix inspections","date":"2020-03-10 08:36:07","modifiedFileCount":"12","status":"M","submitter":"Jonathan Wei"},{"authorTime":"2020-03-17 13:16:14","codes":[{"authorDate":"2020-03-17 13:16:14","commitOrder":5,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        originalFilter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","date":"2020-03-17 13:16:14","endLine":1058,"groupId":"9945","id":9,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/eb/3b6fc64a8d7143ea5e7b6827a43d9f20fdbd80.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT))\n    );\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        originalFilter,\n        true,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1005,"status":"M"},{"authorDate":"2020-03-17 13:16:14","commitOrder":5,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        filter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","date":"2020-03-17 13:16:14","endLine":1283,"groupId":"14363","id":10,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/eb/3b6fc64a8d7143ea5e7b6827a43d9f20fdbd80.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL))\n    );\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(\n        adapter,\n        adapter.determineBaseColumnsWithPreAndPostJoinVirtualColumns(VirtualColumns.EMPTY, null, null),\n        filter,\n        true,\n        true\n    );\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1230,"status":"M"}],"commitId":"b1847364b0816cfc3c2ac376cd888033a06fb93f","commitMessage":"@@@More efficient join filter rewrites (#9516)\n\n* More efficient join filter rewrites\n\n* Rebase\n\n* Remove unused functions\n\n* PR comments.  fix compile\n\n* Adjust comment\n\n* Allow filter rewrite when join condition has LHS expression\n\n* Fix inspections\n\n* Fix tests","date":"2020-03-17 13:16:14","modifiedFileCount":"24","status":"M","submitter":"Jonathan Wei"},{"authorTime":"2020-05-09 14:45:35","codes":[{"authorDate":"2020-05-09 14:45:35","commitOrder":6,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        originalFilter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableSet.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","date":"2020-05-09 14:45:35","endLine":1153,"groupId":"9945","id":11,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/75/3b35937891c8ecc8e93ccba7c7ac9803bcb8dd.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        originalFilter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1100,"status":"M"},{"authorDate":"2020-05-09 14:45:35","commitOrder":6,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        filter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableSet.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","date":"2020-05-09 14:45:35","endLine":1599,"groupId":"14363","id":12,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/75/3b35937891c8ecc8e93ccba7c7ac9803bcb8dd.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        filter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableList.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1546,"status":"M"}],"commitId":"16d293d6e0d81963af3b3d468efd658317d91052","commitMessage":"@@@Directly rewrite filters on RHS join columns into LHS equivalents (#9818)\n\n* Directly rewrite filters on RHS join columns into LHS equivalents\n\n* PR comments\n\n* Fix inspection\n\n* Revert unnecessary ExprMacroTable change\n\n* Fix build after merge\n\n* Address PR comments","date":"2020-05-09 14:45:35","modifiedFileCount":"30","status":"M","submitter":"Jonathan Wei"},{"authorTime":"2020-06-19 12:32:29","codes":[{"authorDate":"2020-06-19 12:32:29","commitOrder":7,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysisGroup joinFilterPreAnalysisGroup = makeDefaultConfigPreAnalysisGroup(\n        originalFilter,\n        joinableClauses,\n        VirtualColumns.EMPTY\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysisGroup\n    );\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableSet.of()\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = joinFilterPreAnalysisGroup.getPreAnalysisForSingleLevelMode();\n\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n  }\n","date":"2020-06-19 12:32:29","endLine":1187,"groupId":"0","id":13,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/89/3e0542b8ceeadecc91f82ca360b687e72b148e.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        originalFilter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableSet.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1131,"status":"M"},{"authorDate":"2020-06-19 12:32:29","commitOrder":7,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysisGroup joinFilterPreAnalysisGroup = makeDefaultConfigPreAnalysisGroup(\n        filter,\n        joinableClauses,\n        VirtualColumns.EMPTY\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysisGroup\n    );\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableSet.of()\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = joinFilterPreAnalysisGroup.getPreAnalysisForSingleLevelMode();\n\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n  }\n","date":"2020-06-19 12:32:29","endLine":1715,"groupId":"0","id":14,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/89/3e0542b8ceeadecc91f82ca360b687e72b148e.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysis joinFilterPreAnalysis = simplePreAnalysis(\n        joinableClauses,\n        filter\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableSet.of()\n    );\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1659,"status":"M"}],"commitId":"37e150c0755c0efba609601b1122cd6bc8a271fb","commitMessage":"@@@Fix join filter rewrites with nested queries (#10015)\n\n* Fix join filter rewrites with nested queries\n\n* Fix test.  inspection.  coverage\n\n* Remove clauses from group key\n\n* Fix import order\n\nCo-authored-by: Gian Merlino <gianmerlino@gmail.com>","date":"2020-06-19 12:32:29","modifiedFileCount":"20","status":"M","submitter":"Jonathan Wei"},{"authorTime":"2020-07-01 10:14:22","codes":[{"authorDate":"2020-07-01 10:14:22","commitOrder":8,"curCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = makeDefaultConfigPreAnalysis(\n        originalFilter,\n        joinableClauses,\n        VirtualColumns.EMPTY\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableSet.of()\n    );\n\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n  }\n","date":"2020-07-01 10:14:22","endLine":1174,"groupId":"106039","id":15,"instanceNumber":1,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/ed/7e7c7759887a1bbaadcc28b4d41944a1e6078b.src","preCode":"  public void test_filterPushDown_factToCountryRightWithFilterOnChannelAndJoinable()\n  {\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.RIGHT));\n    Filter originalFilter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\")\n        )\n    );\n    JoinFilterPreAnalysisGroup joinFilterPreAnalysisGroup = makeDefaultConfigPreAnalysisGroup(\n        originalFilter,\n        joinableClauses,\n        VirtualColumns.EMPTY\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysisGroup\n    );\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            originalFilter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Diskussion:Sebastian Schulz\", \"DE\", 3L, \"DE\", \"Germany\", 3L}\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#de.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"DE\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"Germany\"),\n        ImmutableSet.of()\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = joinFilterPreAnalysisGroup.getPreAnalysisForSingleLevelMode();\n\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1119,"status":"M"},{"authorDate":"2020-07-01 10:14:22","commitOrder":8,"curCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysis joinFilterPreAnalysis = makeDefaultConfigPreAnalysis(\n        filter,\n        joinableClauses,\n        VirtualColumns.EMPTY\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysis\n    );\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableSet.of()\n    );\n\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n  }\n","date":"2020-07-01 10:14:22","endLine":1693,"groupId":"106039","id":16,"instanceNumber":2,"isCurCommit":0,"methodName":"test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/ed/7e7c7759887a1bbaadcc28b4d41944a1e6078b.src","preCode":"  public void test_filterPushDown_factToCountryFullWithFilterOnChannelAndCountryName()\n  {\n    Filter filter = new AndFilter(\n        ImmutableList.of(\n            new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n            new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\")\n        )\n    );\n    List<JoinableClause> joinableClauses = ImmutableList.of(factToCountryOnIsoCode(JoinType.FULL));\n    JoinFilterPreAnalysisGroup joinFilterPreAnalysisGroup = makeDefaultConfigPreAnalysisGroup(\n        filter,\n        joinableClauses,\n        VirtualColumns.EMPTY\n    );\n    HashJoinSegmentStorageAdapter adapter = new HashJoinSegmentStorageAdapter(\n        factSegment.asStorageAdapter(),\n        joinableClauses,\n        joinFilterPreAnalysisGroup\n    );\n\n    JoinTestHelper.verifyCursors(\n        adapter.makeCursors(\n            filter,\n            Intervals.ETERNITY,\n            VirtualColumns.EMPTY,\n            Granularities.ALL,\n            false,\n            null\n        ),\n        ImmutableList.of(\n            \"page\",\n            \"countryIsoCode\",\n            \"countryNumber\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryIsoCode\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\",\n            FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryNumber\"\n        ),\n        ImmutableList.of(\n            new Object[]{\"Wendigo\", \"SV\", 12L, \"SV\", \"El Salvador\", 12L}\n        )\n    );\n\n    JoinFilterSplit expectedFilterSplit = new JoinFilterSplit(\n        new AndFilter(\n            ImmutableList.of(\n                new SelectorFilter(\"channel\", \"#es.wikipedia\"),\n                new InDimFilter(\"countryIsoCode\", ImmutableSet.of(\"SV\"), null, null).toFilter()\n            )\n        ),\n        new SelectorFilter(FACT_TO_COUNTRY_ON_ISO_CODE_PREFIX + \"countryName\", \"El Salvador\"),\n        ImmutableSet.of()\n    );\n    JoinFilterPreAnalysis joinFilterPreAnalysis = joinFilterPreAnalysisGroup.getPreAnalysisForSingleLevelMode();\n\n    JoinFilterSplit actualFilterSplit = JoinFilterAnalyzer.splitFilter(joinFilterPreAnalysis);\n    Assert.assertEquals(expectedFilterSplit, actualFilterSplit);\n  }\n","realPath":"processing/src/test/java/org/apache/druid/segment/join/JoinFilterAnalyzerTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":1638,"status":"M"}],"commitId":"5faa897a342096b2ac88587ad62e6e15022b01dd","commitMessage":"@@@Join filter pre-analysis simplifications and sanity checks. (#10104)\n\n* Join filter pre-analysis simplifications and sanity checks.\n\n- At pre-analysis time.  only compute pre-analysis for the innermost\n  root query.  since this is the one that will run on the join that involves\n  the base datasource. Previously.  pre-analyses were computed for multiple\n  levels of the query.  some of which were unnecessary.\n- Remove JoinFilterPreAnalysisGroup and join query level gathering code. \n  since they existed to support precomputation of multiple pre-analyses.\n- Embed JoinFilterPreAnalysisKey into JoinFilterPreAnalysis and use it to\n  sanity check?at processing time that the correct pre-analysis was done.\n\nTangentially related changes:\n\n- Remove prioritizeAndLaneQuery functionality from LocalQuerySegmentWalker.\n  The computed priority and lanes were not being used.\n- Add \"getBaseQuery\" method to DataSourceAnalysis to support identification\n  of the proper subquery for filter pre-analysis.\n\n* Fix compilation errors.\n\n* Adjust tests.","date":"2020-07-01 10:14:22","modifiedFileCount":"20","status":"M","submitter":"Gian Merlino"}]
